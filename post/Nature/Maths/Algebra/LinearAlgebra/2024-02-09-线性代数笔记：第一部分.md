---
html:
  offline: true
export_on_save:
  html: true
---

<div class="cover">
  <img src="https://picbed.huaier-ashgrey.top/image/image-1.webp">
</div>

<br>

# 线性代数笔记：第一部分

<br>

<br>

<br>

## 1 向量空间与子空间

<br>

### 1.1 实数集与复数集

<br>

复数集由虚数 $\rm i=\sqrt{-1}$ 所引入，它服从基本的运算法则。定义复数如下：

<br>

> **定义 1.1-1 复数**
>
> 复数是一个有序二元实数对 $(a,b)$，其中 $a,b\in\mathbb{R}$，将其记作 $a+b\rm i$。而复数集的定义为：
> 
> $$
    \mathbb{C}=\{a+b\mathrm{i}:a,b\in\mathbb{R}\}
>    $$
>
> 复数的加法定义为：
> 
> $$
    z_1=a+b\mathrm{i},z_2=c+d\mathrm{i}\Rightarrow z_1+z_2=(a+c)+(b+d)\mathrm{i}
>    $$
> 
> 复数的乘法定义为：
> 
> $$
    z_1=a+b\mathrm{i},z_2=c+d\mathrm{i}\Rightarrow z_1z_2=(ac-bd)+(ad+bc)\mathrm{i}
>    $$
> 
> 以上的 $a,b,c,d\in\mathbb{R}$。复数集记为 $\mathbb{C}$，且有 $\mathbb{R}\subset\mathbb{C}$

<br>

复数集满足以下运算规律（$\alpha,\beta,\gamma\in\mathbb{C}$）
- 交换律：$\alpha+\beta=\beta+\alpha,\alpha\beta=\beta\alpha$
- 结合律：$(\alpha+\beta)+\gamma=\alpha+(\beta+\gamma),(\alpha\beta)\gamma=\alpha(\beta\gamma)$
- 分配律：$(\alpha+\beta)\lambda=\alpha\lambda+\beta\lambda$
- 恒等律：$\alpha+0=\alpha,\alpha\cdot1=\alpha$
- 加性恒等式：$\forall\alpha\in\mathbb{C}$，$\exists\beta\in\mathbb{C}$ 使得 $\alpha+\beta=0$，且 $\beta$ 唯一
- 积性恒等式：$\forall\alpha\in\mathbb{C},\alpha\neq 0$，$\exists\beta\in\mathbb{C}$ 使得 $\alpha\beta=1$，且 $\beta$ 唯一

<br>

> **定义 1.1-2 复数的减法、除法运算**
>
> - 定义一个复数 $\alpha$ 的**加法逆元** $-\alpha$，满足 $\alpha+(-\alpha)=0$
> - 定义复数的减法为 $\beta-\alpha=\beta+(-\alpha)$
> - 定义一个复数 $\alpha$ 的**乘法逆元** $1/\alpha$，满足 $\alpha(1/\alpha)=1$
> - 定义复数的除法为 $\beta/\alpha=\beta(1/\alpha)$

<br>

我们采用记号 $\mathbb{F}$ 表示实数集 $\mathbb{R}$ 或者复数集 $\mathbb{C}$。$\mathbb{F}$ 的元素称为**标量**。我们用 $n$ 元组表示一个包含 $n$ 个有序的对象的集合，则记号 $\mathbb{F}^n$ 表示元素为标量的 $n$ 元组：

$$
    \mathbb{F}^n=\{(x_1,x_2,\cdots,x_n):x_j\in\mathbb{F},1\leq j\leq n\}
$$

其中的 $x_j$ 被称为 $\mathbb{F}^n$ 的第 $j$ 个分量。

<br>

> **定义 1.1-3 $\mathbb{F}^n$ 上的运算**
>
> $\mathbb{F}^n$ 上的 $\boldsymbol{0}$ 被定义为分量全为 $0$ 的 $n$ 元组： $(\underbrace{0,\cdots,0}_{n})$
> 
> $\mathbb{F}^n$ 上的加法被定义为对应分量的相加：
> 
> $$
    (x_1,\cdots,x_n)+(y_1,\cdots,y_n)=(x_1+y_1,\cdots,x_n+y_n)
>   $$
>
> $\mathbb{F}^n$ 上的加法逆元：对于 $\boldsymbol{x}\in\mathbb{F}^n$，其加法逆元 $-\boldsymbol{x}$ 满足 $\boldsymbol{x}+(-\boldsymbol{x})=0$，则：
> 
> $$
    -\boldsymbol{x}=(-x_1,\cdots,-x_n)
>   $$
>
> $\mathbb{F}^n$ 上的标量乘法：对于 $\boldsymbol{x}\in\mathbb{F}^n,\lambda\in\mathbb{F}$，它们的乘积（标量乘法）定义为：
> 
> $$
    \lambda\boldsymbol{x}=(\lambda x_1,\cdots,\lambda x_n)
>   $$

<br>

### 1.2 向量空间的定义

<br>

> **定义 1.2-1 向量空间**
>
> 向量空间（Space）是一个带有加法和标量乘法的集合 $\mathcal{V}$ ，并且满足以下性质：
> - 交换律：$\forall \boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$，$\boldsymbol{u}+\boldsymbol{v}=\boldsymbol{v}+\boldsymbol{u}$
> - 结合律：$\forall \boldsymbol{u},\boldsymbol{v},\boldsymbol{w}\in\mathcal{V};\;a,b\in\mathbb{F}$，$(\boldsymbol{u}+\boldsymbol{v})+\boldsymbol{w}=\boldsymbol{u}+(\boldsymbol{v}+\boldsymbol{w})$，$(ab)\boldsymbol{v}=a(b\boldsymbol{v})$
> - 恒等律：$\forall\boldsymbol{v}\in\mathcal{V},\;\exists\boldsymbol{0}\in\mathcal{V}$，$\boldsymbol{v}+\boldsymbol{0}=\boldsymbol{v}$；$\forall\boldsymbol{v}\in\mathcal{V},1\in\mathbb{R}$，$1\cdot\boldsymbol{v}=\boldsymbol{v}$
> - 存在加法逆元：$\forall\boldsymbol{v}\in\mathcal{V},\;\exists\boldsymbol{w}\in\mathcal{V}$ 使得 $\boldsymbol{v}+\boldsymbol{w}=\boldsymbol{0}$
> - 分配律：$\forall\boldsymbol{v},\boldsymbol{w}\in\mathcal{V},\forall a,b\in\mathbb{R}$，$a(\boldsymbol{v}+\boldsymbol{w})=a\boldsymbol{v}+a\boldsymbol{w}$，$(a+b)\boldsymbol{v}=a\boldsymbol{v}+b\boldsymbol{v}$

<br>

向量空间中的元素称为**向量**，上述定义中的向量空间 $\mathcal{v}$ 称为 $\mathbb{F}$ 上的向量空间，因为标量乘法是定义在 $\mathbb{F}$ 上的。存在无数个向量空间，例如 $\mathbb{R}^n$ 就是定义在 $\mathbb{R}$ 上的向量空间，称为**实向量空间**，$\mathbb{C}^n$ 是定义在 $\mathbb{C}$ 上的向量空间，称为**复向量空间**。

考虑集合 $S$，用 $\mathbb{F}^S$ 表示从集合 $S$ 到集合 $\mathbb{F}$ 的函数的集合：

$$
    \mathbb{F}^S=\{f\;|\;f:S\rightarrow\mathbb{F}\}
$$

对于两个函数 $f,g\in\mathbb{F}^S$，定义它们的和 $f+g$为：

$$
    (f+g)(x)=f(x)+g(x),\;x\in S
$$

对于 $\lambda\in\mathbb{F},f\in\mathbb{F}^S$，定义标量乘积 $\lambda f$为：

$$
    (\lambda f)(x)=\lambda f(x),\;x\in S
$$

根据以上定义，如果 $S$ 不是一个空集，则可以说明函数集合 $\mathbb{F}^S$ 是一个定义在 $\mathbb{F}$ 上的向量空间。其中加性恒等律中的 $0$ 满足 $0(x)=\boldsymbol{0}$，加法逆元满足 $(-f)(x)=-f(x)$。由这个例子可以看出，向量空间是一种抽象的概念，其元素可以是 $n$ 元组、无穷元组、函数等其他抽象的概念，只要其元素可以进行加法和标量乘法运算，并且这些运算满足1.2-1中的性质。

我们没有证明向量空间中的加性恒等式的 $\boldsymbol{0}$ 以及加法逆元是唯一的，这里说明如下：
- 假设存在另一满足加性恒等式的 $\hat{\boldsymbol{0}}$，根据加性恒等式有 $\hat{\boldsymbol{0}}=\hat{\boldsymbol{0}}+\boldsymbol{0}$，根据加法交换律和加性恒等式有：

    $$
        \hat{\boldsymbol{0}}=\hat{\boldsymbol{0}}+\boldsymbol{0}=\boldsymbol{0}+\hat{\boldsymbol{0}}=\boldsymbol{0}
    $$

    于是满足加性恒等式的 $\boldsymbol{0}$ 是唯一的；

- 设 $\boldsymbol{v}$ 的加法逆元是 $\boldsymbol{w}$，假设存在另一加法逆元 $\hat{\boldsymbol{w}}$，则根据加法结合律与加性恒等式有：

    $$
        \hat{\boldsymbol{w}}=\boldsymbol{0}+\hat{\boldsymbol{w}}=(\boldsymbol{v}+\boldsymbol{w})+\hat{\boldsymbol{w}}=(\boldsymbol{v}+\hat{\boldsymbol{w}})+\boldsymbol{w}=\boldsymbol{0}+\boldsymbol{w}=\boldsymbol{w}
    $$

    于是加法逆元是唯一的。

另一个有意思的**非向量空间**例子是 $\mathbb{R}\cup\{+\infty\}\cup\{-\infty\}$，我们定义正无穷 $+\infty$ 与负无穷 $-\infty$ 并不是实数集 $\mathbb{R}$ 中的元素。定义正负无穷的运算如下（$t\in\mathbb{R}$）：
- 加法：
  - $t+(+\infty)=(+\infty)+t=+\infty$
  - $t+(-\infty)=(-\infty)+t=-\infty$
  - $(+\infty)+(+\infty)=+\infty$
  - $(-\infty)+(-\infty)=-\infty$
  - $(+\infty)+(-\infty)=0$

- 乘法：

    $$
        t(+\infty)=\begin{cases}+\infty,&t>0\\-\infty,&t<0\\0,&t=0\end{cases}\quad
        t(-\infty)=\begin{cases}-\infty,&t>0\\+\infty,&t<0\\0,&t=0\end{cases}
    $$

说明 $\mathbb{R}\cup\{+\infty\}\cup\{-\infty\}$ 不是向量空间只需要一个简单的例子：

$$
    (2+(-1))(+\infty)=2(+\infty)+(-1)(+\infty)=(+\infty)+(-\infty)=0
$$

这说明该集合不满足加法分配律，因此其不是向量空间。

<br>

### 1.3 子空间、和与直和

<br>

> **定义 1.3-1 子空间**
>
> 设向量空间 $\mathcal{V}$，若其子集 $\mathcal{U}$ 也具有与 $\mathcal{V}$ 相同的加法、标量乘法运算（即它也是向量空间），具有同样的向量空间性质，则称 $\mathcal{U}$ 是**子空间**（Subspace），或者**线性子空间**

<br>

一个向量空间的子集是子空间的**充分必要**条件：
- 包含满足加性恒等式的元素（实际上是集合非空）：$\boldsymbol{0}\in\mathcal{U}$
- 对加法封闭：$\boldsymbol{v},\boldsymbol{w}\in\mathcal{U}$，则 $\boldsymbol{v}+\boldsymbol{w}\in\mathcal{U}$
- 对标量乘法封闭：$a\in\mathbb{F},\boldsymbol{v}\in\mathcal{U}$，则 $a\boldsymbol{v}\in\mathcal{U}$

<br>

> **定义 1.3-2 向量空间子集的和**
>
>   向量空间 $\mathcal{V}$ 的子集 $\mathcal{U_1},\cdots\mathcal{U_m}$，将这些子集的**和**记作 $\mathcal{U_1}+\cdots+\mathcal{U_m}$，它的含义是所有可能的各子集元素的和，即
> 
> $$
    \mathcal{U_1}+\cdots+\mathcal{U_m}=\{u_1+\cdots+u_m:u_i\in\mathcal{U_i},1\leq i\leq m\}
    $$

<br>

> **命题 1.3-1 向量空间子空间的和是子空间**
>
> 考虑向量空间 $\mathcal{V}$ 的子空间 $\mathcal{U_1},\cdots,\mathcal{U_m}$ 的和 $\mathcal{U_1}+\cdots+\mathcal{U_m}$ ，它是最小的包含 $\mathcal{U_1},\cdots,\mathcal{U_m}$ 的子空间

<br>

证明：由于 $\mathcal{U_i}$ 都是子空间，因此令 $u_i=0,1\leq i\leq m$，则可以得到 $0\in\mathcal{U_1}+\cdots+\mathcal{U_m}$。设 $v,w\in\mathcal{U_1}+\cdots+\mathcal{U_m}$ 且 $v=v_1+\cdots+v_m,v_i\in\mathcal{U_i};\;u=u_1+\cdots+u_m,u_i\in\mathcal{U_i}$，则：
- 我们根据加法的交换律可以得到：

    $$
        v+w=\sum_{i=1}^mv_i+\sum_{i=1}^mw_i=\sum_{i=1}^m(v_i+w_i)
    $$

    由于每个 $\mathcal{U_i}$ 都是子空间，因此其对加法封闭：$v_i+w_i\in\mathcal{U_i}$，于是由子空间的和的定义可知**子空间的和对加法封闭**。

- 我们根据标量乘法的结合律可以得到：

    $$
        \lambda v=\lambda\sum_{i=1}^mv_i=\sum_{i=1}^m\lambda v_i
    $$

    由于每个 $\mathcal{U_i}$ 都是子空间，因此其对标量乘法封闭，于是由子空间的和的定义可知**子空间的和对标量乘法封闭**。

因此可以得到子空间的和也是子空间，下面说明其是最小的包含各子空间 $\mathcal{U_i}$ 的子空间。我们有 $\mathcal{U_i}\subseteq\mathcal{U_1}+\cdots+\mathcal{U_m}$，$1\leq i\leq m$，反过来，一个 $\mathcal{V}$ 的子空间若包含各子空间 $\mathcal{U_1}$，则其必须包含 $\mathcal{U_1}+\cdots+\mathcal{U_m}$，因为子空间对有限和封闭，故**子空间的和是最小的包含它们的子空间**。$\square$

<br>

> **定义 1.3-3 直和**
>
> 如果 $\mathcal{U_1},\cdots,\mathcal{U_m}$ 是向量空间 $\mathcal{V}$ 的子空间。当且仅当 $\mathcal{U_1}+\cdots+\mathcal{U_m}$ 中的任意元素只有一种和的形式：$u_1+\cdots+u_m$，$u_i\in\mathcal{U_i},1\leq i\leq m$，我们称 $\mathcal{U_1}+\cdots+\mathcal{U_m}$ 为这些子空间的**直和**（direct sum），并记作：
> 
> $$
    \mathcal{U_1}\oplus\cdots\oplus\mathcal{U_m}
>   $$

<br>

直和是一种特殊形式的和，通常来说判断子空间的和是否是直和只需要判断 $0$ 的书写形式是否只有一种：

<br>

> **命题 1.3-2 直和的判断条件**
>
> 考虑 $\mathcal{U_1}\cdots\mathcal{U_m}$ 是向量空间 $\mathcal{V}$ 的子空间，$\mathcal{U_1}+\cdots+\mathcal{U_m}$ 是直和当且仅当其中元素 $0$ 只有一种和的形式： $u_1+\cdots+u_m$，其中 $u_i\in\mathcal{U_i}$ 且 $u_i=0$

<br>

证明：
- 充分性：考虑 $\mathcal{U_1}\oplus\cdots\oplus\mathcal{U_m}$ 是直和，则根据直和的定义，其中元素 $0$ 只有一种和的形式： $u_1+\cdots+u_m$，其中 $u_i\in\mathcal{U_i}$ 且 $u_i=0$；
- 必要性：假设对于和 $\mathcal{U_1}+\cdots+\mathcal{U_m}$，其中元素 $0$ 只有一种和的形式：$u_1+\cdots+u_m$，其中 $u_i\in\mathcal{U_i}$ 且 $u_i=0$。我们说明该和是一个直和，对于该和中的一个元素 $u$，假设其具有以下和的形式：

    $$
        u=u_1+\cdots+u_m,\;u_i\in\mathcal{U_i},\;1\leq i\leq m
    $$

    我们假设 $u$ 还有一种和的形式：

    $$
        u=v_1+\cdots+v_m,\;u_i\in\mathcal{U_i},\;1\leq i\leq m
    $$

    两式相减可以得到 $\displaystyle 0=\sum_{i=1}^m(u_i-v_i)$，由于 $u_i-v_i\in\mathcal{U_i}$，于是我们得出 $u_i=v_i$，即对任意和中的元素它只有一种和的形式，因此和为直和。

证毕。$\square$

<br>

> **命题 1.3-3 两个子空间的直和**
>
> 假设 $\mathcal{U}$ 和 $\mathcal{W}$ 是向量空间 $\mathcal{V}$ 的子空间，$\mathcal{U}+\mathcal{W}$ 是直和当且仅当 $\mathcal{U}\cap\mathcal{W}=\{0\}$

<br>

证明：
- 充分性：$\mathcal{U}+\mathcal{W}$ 是直和，假设 $v\in\mathcal{U}\cap\mathcal{W}$，由于 $0=v+(-v)$，因此假设 $v\in\mathcal{U},-v\in\mathcal{W}$，由直和的定义可知 $0$ 的唯一和形式为 $0+0$，因此我们可以得到 $v=0$，则 $\mathcal{U}\cap\mathcal{W}=\{0\}$；
- 必要性：此时 $\mathcal{U}\cap\mathcal{W}=\{0\}$，设 $u\in\mathcal{U},w\in\mathcal{W}$，假设 $\mathcal{U}+\mathcal{W}$ 中的元素 $0$ 的一种和形式为：

    $$
        0=u+w
    $$

    由此可以得到 $u=-w$，由于子空间 $\mathcal{W}$ 对标量乘法封闭，因此有 $-w\in\mathcal{W}$，即有 $u\in\mathcal{W}$，于是有 $u\in\mathcal{U}\cap\mathcal{W}$，故 $u=w=0$。我们证明了 $0$ 的唯一和形式为 $0+0$，因此和为直和。

证毕。$\square$

<br>

<br>

<br>

## 2 有限维向量空间

<br>

### 2.1 线性扩张与线性无关

<br>

之后的讨论默认 $\mathcal{V}$ 表示定义在 $\mathbb{F}$ 上的向量空间。我们将用**向量**（Vector）表示 $\mathcal{V}$ 中的元素，向量的表示方法可以是 $\boldsymbol{v}=\begin{bmatrix}v_1\\v_2\\v_3\end{bmatrix}$，也可以是 $(v_1,v_2,v_3)$。$\mathcal{V}$ 中的元素将用粗体显示，以区别于非标量的向量。

<br>

> **定义 2.1-1 线性组合**
>
> 考虑一组 $\mathcal{V}$ 中的向量 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}$，将 $a_1\boldsymbol{v_1}+\cdots+a_m\boldsymbol{v_m}$ 称为**线性组合**（linear combination），其中 $a_1,\cdots,a_m\in\mathbb{F}$

<br>

> **定义 2.1-2 线性扩张**
>
> 所有 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}\in\mathcal{V}$ 的线性组合组成的集合称为这些向量的的**线性扩张**（linear span），记作 $\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})$，即：
> 
> $$
    \text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})=\{a_1\boldsymbol{v_1}+\cdots+a_m\boldsymbol{v_m}:a_1,\cdots,a_m\in\mathbb{F}\}
>   $$
> 
> 空的向量元组 $()$ 的线性扩张定义为 $\{0\}$

<br>

> **命题 2.1-1 线性扩张是最小的子空间**
>
> 设向量组 $(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})$，其中所有向量都是 $\mathcal{V}$ 的元素，则该向量元组的线性扩张 $\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})$ 是包含向量元组中的向量元素的最小子空间

<br>

证明：首先我们证明线性扩张是子空间。
- 我们有 $\boldsymbol{0}=0\boldsymbol{v_1}+\cdots+0\boldsymbol{v_m}$，于是 $\boldsymbol{0}\in\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})$；
- 我们有

    $$
        (a_1\boldsymbol{v_1}+\cdots+a_m\boldsymbol{v_m})+(b_1\boldsymbol{v_1}+\cdots+b_m\boldsymbol{v_m})
    $$

    $$
        =(a_1+b_1)\boldsymbol{v_1}+\cdots+(a_m+b_m)\boldsymbol{v_m}\in\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})
    $$

    于是线性扩张对加法封闭；
- 我们有

    $$
        \lambda(a_1\boldsymbol{v_1}+\cdots+a_m\boldsymbol{v_m})=\lambda a_1\boldsymbol{v_1}+\cdots+\lambda a_m\boldsymbol{v_m}\in\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})  
    $$

    于是线性扩张对标量乘法封闭。

根据以上三条性质可知线性扩张是 $\mathcal{V}$ 的子空间。由于子空间对加法封闭，因此任意包含 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}$ 的子空间必须同时包含它们的线性组合，因此任意满足条件的子空间都有一个子集，即 $\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})$，于是线性扩张是包含这些向量的最小子空间。$\square$

若 $\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})=\mathcal{V}$，则我们说 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}$ 线性扩张成向量空间 $\mathcal{V}$。

<br>

> **定义 2.1-3 有限维向量空间**
>
> 若一个向量空间能被其中某个向量元组线性扩张得到，则称该向量空间是**有限维向量空间**（finite-dimensional vector space）。反之则称为**无限维向量空间**。

<br>

根据以上定义可以知道 $\mathbb{F}^n$ 是定义在 $\mathbb{F}$ 上的有限维向量空间。

<br>

> **定义 2.1-4 多项式**
>
> 函数 $p:\mathbb{F}\rightarrow\mathbb{F}$ 定义如下，存在 $a_0,\cdots,a_m\in\mathbb{F}$ ，对所有 $z\in\mathbb{F}$ 使得
> 
> $$
    p(z)=a_0+a_1z+a_2z^2+\cdots+a_mz^m
>   $$
> 
> 则称函数 $p$ 是定义在 $\mathbb{F}$ 上的具有系数的**多项式**（polynomial）。$\mathcal{P}(\mathbb{F})$ 是定义在 $\mathbb{F}$ 上的所有具有系数的多项式的集合。

<br>

实际可以说明 $\mathcal{P}(\mathbb{F})$ 是向量空间 $\mathbb{F}^{\mathbb{F}}$（指的是所有函数 $\mathbb{F}\mapsto\mathbb{F}$ 构成的向量空间，这在1.2节提到过）的子空间（这里不作证明）。

<br>

> **定义 2.1-5 多项式的次数**
>
> 多项式 $p\in\mathcal{P}(\mathbb{F})$ 具有次数（degree） $m$，如果存在标量 $a_0,\cdots,a_m\in\mathbb{F}$，$a_m\neq 0$ 使得
> 
> $$
    p(z)=a_0+a_1z+a_2z^2+\cdots+a_mz^m
>   $$
> 
> 对所有 $z\in\mathbb{F}$ 成立，如果多项式 $p$ 具有次数 $m$，我们记作 $\deg{p}=m$。多项式 $0$ 的次数记作 $-\infty$。用 $\mathcal{P}_m(\mathbb{F})$ 作为所有定义在 $\mathbb{F}$ 上次数不超过 $m$ 的多项式的集合。

<br>

由定义可知：

$$
    \mathcal{P}_m(\mathbb{F})=\text{span}(1,z,\cdots,z^m)
$$

由此可知 $\mathcal{P}_m(\mathbb{F})$ 是一个有限维向量空间，而 $\mathcal{P}(\mathbb{F})$ 则是一个无限维向量空间（这里只是作为有限维和无限维向量空间的例子，之后还有一章专门讨论多项式）。

<br>

> **定义 2.1-6 线性无关**
>
> 一组向量 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}\in\mathcal{V}$，若满足使 $a_1\boldsymbol{v_1}+\cdots+a_m\boldsymbol{v_m}=\boldsymbol{0}$ 成立的标量 $a_1,\cdots,a_m\in\mathbb{F}$ 是 $a_1=\cdots=a_m=0$，则称这组向量**线性无关**（linear independent）。我们认为空的向量组也是线性无关的。**线性相关**（linear dependent）则是与线性无关相反的概念：一组向量是线性相关的当且仅当它不是线性无关的。

<br>

> **命题 2.1-2 线性相关的判断方法**
>
> 考虑一组线性相关的向量 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}\in\mathcal{V}$，那么存在 $1\leq j\leq m$ 使得以下两条成立：
> - $\boldsymbol{v_j}\in\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{j-1}})$；
> - 如果将 $\boldsymbol{v_j}$ 从这个向量组中移除，则剩余向量的线性扩张与 $\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{m}})$ 相同。

<br>

证明：因为向量组 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}\in\mathcal{V}$ 线性相关，所以存在一组不全为 $0$ 的标量 $a_1,\cdots,a_m\in\mathbb{F}$ 使得

$$
    a_1\boldsymbol{v_1}+\cdots+a_m\boldsymbol{v_m}=\boldsymbol{0}
$$

令 $a_1,\cdots,a_m$ 中最后一个不为 $0$ 的数，则 $a_j\neq 0$，则我们有：

$$
    \boldsymbol{v_j}=-\frac{a_1}{a_j}\boldsymbol{v_1}-\cdots-\frac{a_{j-1}}{a_j}\boldsymbol{v_{j-1}}
$$

考虑特殊情况：$j=1$，则 $\boldsymbol{v_j}=\text{span}()=\{0\}$，这也是符合上式的。因此我们可以得到 $v_j\in\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{j-1}})$。

考虑 $\boldsymbol{u}\in\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})$，则存在标量 $c_1,\cdots,c_m\in\mathbb{F}$ 使得

$$
    \boldsymbol{u}=c_1\boldsymbol{v_1}+\cdots+c_j\boldsymbol{v_j}+\cdots+c_m\boldsymbol{v_m}
$$

$$
    =c_1\boldsymbol{v_1}+\cdots+c_j\left(-\frac{a_1}{a_j}\boldsymbol{v_1}-\cdots-\frac{a_{j-1}}{a_j}\boldsymbol{v_{j-1}}\right)+\cdots+c_m\boldsymbol{v_m}
$$

因此剩余向量的线性扩张与 $\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_m})$ 相同。$\square$

<br>

> **命题 2.1-3 线性无关的向量组元素数量小于等于扩张向量空间的向量组元素数量**
>
> 考虑 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$ 是有限维向量空间 $\mathcal{V}$ 中线性无关的向量组，$(\boldsymbol{w_1},\cdots,\boldsymbol{w_n})$ 是能线性扩张 $\mathcal{V}$ 的向量组，则有 $m\leq n$ 成立

<br>

证明（有限维向量空间中的有限步简单操作的证明被视为严谨的）：
- **第 $1$ 步**：任意添加向量 $\boldsymbol{u_1}\in\mathcal{V}$ 进向量组 $\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$，则其将成为一个线性相关的向量组 $\boldsymbol{u_1},\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$，根据命题2.1-3可知可以去除 $\boldsymbol{w_{i_1}}$，$1\leq i_1\leq n$ 使得剩余向量依旧是向量空间 $\mathcal{V}$ 的线性扩张向量组，记为

    $$
        B_1=\{\boldsymbol{u_1},\boldsymbol{w_1},\cdots,\boldsymbol{w_n}\}\backslash\{\boldsymbol{w_{i_1}}\}
    $$

- **第 $j$ 步**：从第 $j-1$ 步的向量组 $B_{j-1}$ 可以线性扩张成向量空间 $\mathcal{V}$，添加向量空间中的元素可以得到一个线性相关的向量组，依旧可以去除一个 $\boldsymbol{w_{i_j}}$ 使得剩余向量仍然是向量空间 $\mathcal{V}$ 的线性扩张向量组，记为

    $$
        B_j=\{\boldsymbol{u_1},\cdots,\boldsymbol{u_j},\boldsymbol{w_1},\cdots,\boldsymbol{w_n}\}\backslash\{\boldsymbol{w_{i_j}},\cdots,w_{i_1}\}
    $$

- **第 $m$ 步**：这里有一点非常重要，为什么我们添加进 $\boldsymbol{u_m}$ 时还有某个 $\boldsymbol{w_{i_m}}$ 可供我们删除。理由是添加进 $\boldsymbol{u_m}$ 时尚未删除的向量组是线性相关的，而 $\boldsymbol{u_1},\cdots,\boldsymbol{u_m}$ 是线性无关的，根据命题2.1-3可知一定存在某个向量 $\boldsymbol{w_{i_m}}$ 满足

    $$
        \boldsymbol{w_{i_m}}=\text{span}(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})
    $$

于是我们可以得到 $m\leq n$，等号在 $\boldsymbol{w_{i_m}}$ 唯一时取得。$\square$

<br>

> **命题 2.1-4 有限维的子空间**
>
> 有限维向量空间的子空间也是有限维的

<br>

证明：

设向量空间 $\mathcal{V}$，其存在一个子空间 $\mathcal{U}$，我们进行以下有限步操作：
- **第 $1$ 步**：如果 $\mathcal{U}=\{0\}$，则其是有限维的；如果 $\mathcal{U}\neq \{0\}$，则选取 $\mathcal{U}$ 中的一个向量 $\boldsymbol{v_1}$；
- **第 $j$ 步**：如果 $\mathcal{U}=\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{j-1}})$，则其是有限维的；如果 $\mathcal{U}\neq\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{j-1}})$，则选取 $\mathcal{U}$ 中的一个向量 $\boldsymbol{v_j}$ 并满足

    $$
        \boldsymbol{v_j}\notin\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{j-1}})
    $$

根据证明过的命题2.1-3可知 $\boldsymbol{v_1},\cdots,\boldsymbol{v_{m}}$ 的长度不能超过向量空间 $\mathcal{V}$ 的线性扩张向量组的长度，因此该操作是有限步的，于是我们证明了 $\mathcal{U}$ 是有限维的。$\square$

<br>

### 2.2 基

<br>

> **定义 2.2-1 基**
>
> 一个向量空间的**基**（basis）是线性无关且能线性扩张成该向量空间的向量组

<br>

例如向量 $(1,0,\cdots,0),(0,1,\cdots,0),\cdots,(0,0,\cdots,1)$ 就是 $\mathbb{F}^n$ 的基，且称为**标准基**（standard basis）。除了标准基外，$\mathbb{F}^n$ 还有其他的基。

<br>

> **命题 2.2-1 基的判断标准**
>
> 向量组 $(\boldsymbol{v_1},\cdots,\boldsymbol{v_n})$ 是向量空间 $\mathcal{V}$ 的基当且仅当对于所有向量 $\boldsymbol{v}\in\mathcal{V}$ 只有一种线性组合的形式：
> 
> $$
    \boldsymbol{v}=a_1\boldsymbol{v_1}+\cdots+a_n\boldsymbol{v_n}
>   $$
> 
> 这里 $a_1,\cdots,a_n\in\mathbb{F}$

<br>

证明：
- 充分性：考虑 $(\boldsymbol{v_1},\cdots,\boldsymbol{v_n})$ 是向量空间 $\mathcal{V}$ 的一组基，则由于该向量组能够线性扩张成向量空间 $\mathcal{V}$，于是存在标量 $a_1,\cdots,a_n\in\mathbb{F}$ 使得

    $$
        \boldsymbol{v}=a_1\boldsymbol{v_1}+\cdots+a_n\boldsymbol{v_n}
    $$

    假设存在另外一组标量 $c_1,\cdots,c_n$ 使得 $\boldsymbol{v}=c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}$，两式相减得到：

    $$
        \boldsymbol{0}=(a_1-c_1)\boldsymbol{v_1}+\cdots+(a_n-c_n)\boldsymbol{v_n}
    $$

    由于基是线性无关的，因此有 $a_i-c_i=0$，可以得到所有 $\boldsymbol{v}\in\mathcal{V}$ 线性组合表示是唯一的。

- 必要性：考虑所有 $\boldsymbol{v}\in\mathcal{V}$ 的线性组合表示都是唯一的，则对于 $\boldsymbol{0}$ ：

    $$
        \boldsymbol{0}=a_1\boldsymbol{v_1}+\cdots+a_n\boldsymbol{v_n}
    $$

    由于其线性组合表示唯一且 $a_1=\cdots=a_n=0$ 是满足上述式子的，因此 $a_1=\cdots=a_n$，这就说明 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是线性无关的，也因此可以得出该向量组是 $\mathcal{V}$ 的基。

<br>

> **命题 2.2-2 线性扩张中包含基**
>
> 一个有限维向量空间的线性扩张中可以去除部分向量，得到向量空间的基

<br>

证明：考虑向量组 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 线性扩张成向量空间 $\mathcal{V}$，我们可以通过有限步的构造得到一个基（令 $B=(\boldsymbol{v_1,\cdots,\boldsymbol{v_n}})$）：
- **第 $1$ 步**：如果 $\boldsymbol{v_1}=\boldsymbol{0}$，将 $\boldsymbol{v_1}$ 从 $B$ 中删除；如果 $\boldsymbol{v_1}\neq\boldsymbol{0}$，则保留 $B$ 不变；
- **第 $j$ 步**：如果 $\boldsymbol{v_j}\in\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{j-1}})$，将 $\boldsymbol{v_j}$ 从 $B$ 中删除；如果 $\boldsymbol{v_j}\notin\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_{j-1}})$，则保留 $B$ 不变；

这些步骤将持续 $n$ 次，最终得到的向量组 $B$ 依然可以线性扩张出向量空间 $\mathcal{V}$（这是由命题2.1-2保证的），并且向量组 $B$ 是线性无关的，由此可知这是向量空间的基。$\square$

<br>

> **命题 2.2-3 有限维向量空间的基**
>
> 所有的有限维向量空间都有基

<br>

证明：根据有限维向量空间的定义可知其存在一个线性扩张，命题2.2-2说明了从线性扩张中可以得到基，于是所有的有限维向量空间都有基。

<br>

> **命题 2.2-4 线性无关向量组可扩充成基**
>
> 一个有限维向量空间的线性无关向量组可以添加元素得到该向量组的基

<br>

证明：设向量组 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$ 是向量空间 $\mathcal{V}$ 的线性无关向量组，设 $(\boldsymbol{w_1},\cdots,\boldsymbol{w_n})$ 是 $\mathcal{V}$ 的基，我们可以组合得到一个新的向量组：

$$
    B=(\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{w_1},\cdots,\boldsymbol{w_n})
$$

显然 $\text{span}\;B=\mathcal{V}$，根据命题2.2-1的证明方法，我们可以不删除 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$ 中的元素，而只删除 $(\boldsymbol{w_1},\cdots,\boldsymbol{w_n})$ 中的元素得到新的基，这个基包含之前的线性无关向量组。$\square$

<br>

> **命题 2.2-5 有限维向量空间的每个子空间都可以与某个子空间进行直和运算得到向量空间**
>
> 考虑有限维向量空间 $\mathcal{V}$，设 $\mathcal{U}$ 是 $\mathcal{V}$ 的一个子空间，则存在子空间 $\mathcal{W}$ 使得 $\mathcal{V}=\mathcal{U}\oplus\mathcal{W}$

<br>

证明：因为 $\mathcal{V}$ 是有限维向量空间，根据命题2.1-4，其子空间 $\mathcal{U}$ 也是有限维的，根据命题2.2-3，子空间 $\mathcal{U}$ 存在基 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$，根据命题2.2-4，线性无关向量组 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$ 可以扩充为 $\mathcal{V}$ 的基：

$$
    (\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{w_1},\cdots,\boldsymbol{w_n})
$$

令 $\mathcal{W}=\text{span}(\boldsymbol{w_1},\cdots,\boldsymbol{w_n})$，根据命题1.3-3，我们只需要证明以下式子成立即可：

$$
    \mathcal{V}=\mathcal{U}+\mathcal{W},\quad \mathcal{U}\cap\mathcal{W}=\{0\}
$$

对于任意向量 $\boldsymbol{v}\in\mathcal{V}$，都有：

$$
    \boldsymbol{v}=\underbrace{a_1\boldsymbol{u_1}+\cdots+a_m\boldsymbol{u_m}}_{u}+\underbrace{b_1\boldsymbol{w_1}+\cdots+b_n\boldsymbol{u_n}}_{w}
$$

即我们有 $\boldsymbol{v}=\boldsymbol{u}+\boldsymbol{w}$，其中 $\boldsymbol{u}\in\mathcal{U}$，$\boldsymbol{w}\in\mathcal{W}$，于是可以得到 $\mathcal{V}=\mathcal{U}+\mathcal{W}$。

考虑 $\boldsymbol{v}\in\mathcal{U}\cap\mathcal{W}$，则存在标量 $a_1,\cdots,a_m,b_1,\cdots,b_n\in\mathbb{F}$ 使得

$$
    \boldsymbol{v}=a_1\boldsymbol{u_1}+\cdots+a_m\boldsymbol{u_m}=b_1\boldsymbol{w_1}+\cdots+b_n\boldsymbol{w_n}
$$

因此有

$$
    a_1\boldsymbol{u_1}+\cdots+a_m\boldsymbol{u_m}-b_1\boldsymbol{w_1}-\cdots-b_n\boldsymbol{w_n}=\boldsymbol{0}
$$

由于 $\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$ 线性无关，因此可以得到 $a_1=\cdots=a_m=b_1=\cdots=b_n=0$，于是 $\mathcal{U}\cap\mathcal{W}=\{0\}$。

综上所述，$\mathcal{V}=\mathcal{U}\oplus\mathcal{W}$ 成立。$\square$

<br>

### 2.3 维数

<br>

> **命题 2.3-1 基的长度不取决于基本身**
>
> 对于一个有限维向量空间，它的任意两个基的长度都是相等的

<br>

证明：考虑有限维向量空间 $\mathcal{V}$ 的两个不同的基 $B_1$ 和 $B_2$。
- $B_1$ 是 $\mathcal{V}$ 的线性无关向量组，$B_2$ 是 $\mathcal{V}$ 的线性扩张，根据命题2.1-3可知 $\text{len}\;B_1\leq\text{len}\;B_2$；
- $B_2$ 是 $\mathcal{V}$ 的线性无关向量组，$B_1$ 是 $\mathcal{V}$ 的线性扩张，根据命题2.1-3可知 $\text{len}\;B_2\leq\text{len}\;B_1$。

于是可以得到 $\text{len}\;B_2=\text{len}\;B_1$，对于一个有限维向量空间，任意两个基的长度相同。

<br>

> **定义 2.3-1 维数**
>
> 一个有限维向量空间的**维数**（dimension）是它的任意一个基的长度，记作 $\dim\mathcal{V}=\text{len}\;B$

<br>

> **命题 2.3-2 子空间的维数**
>
> 如果 $\mathcal{U}$ 是有限维向量空间 $\mathcal{V}$ 的子空间，则有 $\dim\mathcal{U}\leq\dim\mathcal{V}$ 成立

<br>

证明：考虑 $\mathcal{U}$ 中的基是 $\mathcal{V}$ 中的一个线性无关向量组，再考虑 $\mathcal{V}$ 中的一个基是其自身的线性扩张，根据命题2.1-3可知 $\dim\mathcal{U}\leq\dim\mathcal{V}$。$\square$

<br>

> **命题 2.3-3 具有正确长度的线性无关向量组是基**
>
> 考虑有限维向量空间 $\mathcal{V}$，其上的每一个具有长度 $\dim\mathcal{V}$ 的线性无关向量组是 $\mathcal{V}$ 的基

<br>

证明：设 $\dim\mathcal{V}=n$，$\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是向量空间 $\mathcal{V}$ 的一个线性无关向量组，根据命题2.2-4，该线性无关向量组可以增添向量得到 $\mathcal{V}$ 的基，又根据命题2.1-3可知该线性无关向量组的长度已达到最大，因此不能有向量增添进该线性无关向量组，因此 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基。$\square$

<br>

> **命题 2.3-4 具有正确长度的线性扩张是基**
>
> 考虑有限维向量空间 $\mathcal{V}$，其上的每一个具有长度 $\dim\mathcal{V}$ 的线性扩张是 $\mathcal{V}$ 的基

<br>

证明：设 $\dim\mathcal{V}=n$，$\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是向量空间 $\mathcal{V}$ 的一个线性扩张，根据命题2.2-2，该线性扩张可以删除向量得到 $\mathcal{V}$ 的基，可知该线性扩张的长度已达到最小，因此不能有向量从线性扩张中删除，因此 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基。$\square$

<br>

> **命题 2.3-5 子空间和的维数**
>
> $\mathcal{U_1}$ 和 $\mathcal{U_2}$ 是有限维向量空间 $\mathcal{V}$ 的子空间，则有：
> 
> $$
    \dim(\mathcal{U_1}+\mathcal{U_2})=\dim\mathcal{U_1}+\dim\mathcal{U_2}-\dim(\mathcal{U_1}\cap\mathcal{U_2})
>   $$

<br>

证明：设 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$ 是子空间 $\mathcal{U_1}\cap\mathcal{U_2}$ 的基，则 $\dim(\mathcal{U_1}\cap\mathcal{U_2})=m$。因为 $\mathcal{U_1}\cap\mathcal{U_2}\subseteq\mathcal{U_1}$，则 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$ 是向量空间 $\mathcal{U_1}$ 的线性无关向量组，则根据命题2.2-4可知该向量组可以扩充为 $\mathcal{U_1}$ 的基：

$$
    (\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{v_1},\cdots,\boldsymbol{v_j})
$$

同理，也可以扩充为 $\mathcal{U_2}$ 的基：

$$
    (\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{w_1},\cdots,\boldsymbol{w_k})
$$

则有 $\dim\mathcal{U_1}=m+j$，$\dim\mathcal{U_2}=m+k$。

我们知道 $\text{span}(\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{v_1},\cdots,\boldsymbol{v_j},\boldsymbol{w_1},\cdots,\boldsymbol{w_k})$ 包含 $\mathcal{U_1}$ 和 $\mathcal{U_2}$，并且有：

$$
    \text{span}(\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{v_1},\cdots,\boldsymbol{v_j},\boldsymbol{w_1},\cdots,\boldsymbol{w_k})=\mathcal{U_1}+\mathcal{U_2}
$$

考虑该线性扩张是否是线性无关的：

$$
    \boldsymbol{0}=a_1\boldsymbol{u_1}+\cdots+a_m\boldsymbol{u_m}+b_1\boldsymbol{v_1}+\cdots+b_j\boldsymbol{v_j}+c_1\boldsymbol{w_1}+\cdots+c_k\boldsymbol{w_k}
$$

其中 $a_1,\cdots,a_m,b_1,\cdots,b_j,c_1,\cdots,c_k\in\mathbb{F}$，上式又可写作：

$$
    c_1\boldsymbol{w_1}+\cdots+c_k\boldsymbol{w_k}=-a_1\boldsymbol{u_1}-\cdots-a_m\boldsymbol{u_m}-b_1\boldsymbol{v_1}-\cdots-b_j\boldsymbol{v_j}
$$

这说明 $c_1\boldsymbol{w_1}+\cdots+c_k\boldsymbol{w_k}\in\mathcal{U_1}$，而 $\boldsymbol{w_i}\in\mathcal{U_2}$，因此可以得到 $c_1\boldsymbol{w_1}+\cdots+c_k\boldsymbol{w_k}\in\mathcal{U_1}\cap\mathcal{U_2}$，而根据假设 $(\boldsymbol{u_1},\cdots,\boldsymbol{u_m})$ 是子空间 $\mathcal{U_1}\cap\mathcal{U_2}$ 的基，可以重新写出线性组合：

$$
    c_1\boldsymbol{w_1}+\cdots+c_k\boldsymbol{w_k}=d_1\boldsymbol{u_1}+\cdots+d_m\boldsymbol{u_m}
$$

由于 $\boldsymbol{w_1},\cdots,\boldsymbol{w_k},\boldsymbol{u_1},\cdots,\boldsymbol{u_m}$ 线性无关，因此可以得到 $c_1=\cdots=c_k=d_1=\cdots=d_m=0$，于是原方程可以写作：

$$
    \boldsymbol{0}=a_1\boldsymbol{u_1}+\cdots+a_m\boldsymbol{u_m}+b_1\boldsymbol{v_1}+\cdots+b_j\boldsymbol{v_j}
$$

又由于 $\boldsymbol{v_1},\cdots,\boldsymbol{v_j},\boldsymbol{u_1},\cdots,\boldsymbol{u_m}$ 线性无关，因此可以得到 $a_1=\cdots=a_m=b_1=\cdots=b_k=0$，于是我们得到线性扩张 $\text{span}(\boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{v_1},\cdots,\boldsymbol{v_j},\boldsymbol{w_1},\cdots,\boldsymbol{w_k})$ 是线性无关的，是 $\mathcal{U_1}+\mathcal{U_2}$ 的基，故 $\dim(\mathcal{U_1}+\mathcal{U_2})=m+j+k$，可得

$$
    \begin{aligned}
    \dim(\mathcal{U_1}+\mathcal{U_2})&=m+j+k\\
    &=(m+j)+(m+k)-m\\
    &=\dim\mathcal{U_1}+\dim\mathcal{U_2}-\dim(\mathcal{U_1}\cap\mathcal{U_2})
    \end{aligned}
$$

证毕。$\square$

<br>

<br>

<br>

## 3 线性映射

<br>

### 3.1 线性映射的向量空间

<br>

> **定义 3.1-1 线性映射**
>
> 一个从向量空间 $\mathcal{V}$ 到 $\mathcal{W}$ 的线性映射（linear maps）或者线性变换（linear transformation）是一个函数 $\mathscr{T}:\mathcal{V}\mapsto\mathcal{W}$，其满足以下性质：
> - 可加性（additivity）：对于任意 $\boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$ 都有 $\mathscr{T}(\boldsymbol{u}+\boldsymbol{v})=\mathscr{T}(\boldsymbol{u})+\mathscr{T}(\boldsymbol{v})$；
> - 齐次性（homogeneity）：对于任意 $\lambda\in\mathbb{F},\boldsymbol{v}\in\mathcal{V}$ 都有 $\mathscr{T}(\lambda \boldsymbol{v})=\lambda\mathscr{T}(\boldsymbol{v})$

<br>

所有从 $\mathcal{V}$ 到 $\mathcal{W}$ 的线性映射 $\mathscr{T}$ 构成的集合记作 $\mathcal{L}(\mathcal{V},\mathcal{W})$。注意将向量空间中的所有元素映射到 $0$ 的函数 $0$ 也是 $\mathcal{L}(\mathcal{V},\mathcal{W})$ 的元素；恒等线性映射（identity）$\mathscr{I}$ 将向量空间 $\mathcal{V}$ 映射回向量空间 $\mathcal{V}$，记作 $\mathscr{I}\in\mathcal{L}(\mathcal{V},\mathcal{V})$：

$$
    \mathscr{I}(\boldsymbol{v})=\boldsymbol{v},\;\boldsymbol{v}\in\mathcal{V}
$$

有很多经典的映射属于线性映射，它们都满足以上两个性质，且定义域和值域都是向量空间。例如导数运算 $\mathscr{D}\in\mathcal{L}(\mathcal{P}(\mathbb{R}),\mathcal{P}(\mathbb{R}))$ 定义如下：

$$
    \mathscr{D}(p)=p'(x),\;p\in\mathcal{P}(\mathbb{R})
$$

定积分运算 $\mathscr{T}\in\mathcal{L}(\mathcal{P}(\mathbb{R}),\mathbb{R})$ 定义如下：

$$
    \mathscr{T}(p)=\int_m^np(x)\mathrm{d}x,\;p\in\mathcal{P}(\mathbb{R})
$$

<br>

> **命题 3.1-1 线性映射和定义域的基**
>
> 考虑 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是向量空间 $\mathcal{V}$ 的基与 $\boldsymbol{w_1},\cdots,\boldsymbol{w_n}\in\mathcal{W}$，则存在唯一的线性映射 $\mathscr{T}$ 使得对于 $j=1,\cdots,n$ 都有
>
> $$
    \mathscr{T}(\boldsymbol{v_j})=\boldsymbol{w_j}
>   $$

<br>

证明：我们定义函数 $\mathscr{T}:\mathcal{V}\mapsto\mathcal{W}$ 如下：

$$
    \mathscr{T}(c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n})=c_1\boldsymbol{w_1}+\cdots+c_n\boldsymbol{w_n}
$$

其中 $c_1,\cdots,c_n\in\mathbb{F}$，$\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是向量空间 $\mathcal{V}$ 的基，由于向量空间 $\mathcal{V}$ 中的元素都可以写作 $c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}$，因此上式确实定义了一个函数 $\mathscr{T}$。对于 $j$，取 $c_j=1$，其余的标量为 $0$，则可以得到 $\mathscr{T}(\boldsymbol{v_j})=\boldsymbol{w_j}$。现在说明这个函数是一个线性映射：

设 $\boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$，其中 $\boldsymbol{u}=a_1\boldsymbol{v_1}+\cdots+a_n\boldsymbol{v_n}$，$\boldsymbol{v}=c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}$，则

$$
    \begin{aligned}
        \mathscr{T}(\boldsymbol{u}+\boldsymbol{v})&=\mathscr{T}((a_1+c_1)\boldsymbol{v_1}+\cdots+(a_n+c_n)\boldsymbol{v_n})\\
        &=(a_1+c_1)\boldsymbol{w_1}+\cdots+(a_n+c_n)\boldsymbol{w_n}\\
        &=(a_1\boldsymbol{w_1}+\cdots+a_n\boldsymbol{w_n})+(c_1\boldsymbol{w_1}+\cdots+c_n\boldsymbol{w_n})\\
        &=\mathscr{T}(\boldsymbol{u})+\mathscr{T}(\boldsymbol{v})
    \end{aligned}
$$

相似的，说明齐次性也是简单的，设 $\lambda\in\mathbb{F}$ 和 $\boldsymbol{v}=c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}$，则

$$
    \begin{aligned}
        \mathscr{T}(\lambda\boldsymbol{v})&=\mathscr{T}(\lambda c_1\boldsymbol{v_1}+\cdots+\lambda c_n\boldsymbol{v_n})\\
        &=\lambda c_1\boldsymbol{w_1}+\cdots+\lambda c_n\boldsymbol{w_n}\\
        &=\lambda(c_1\boldsymbol{w_1}+\cdots+c_n\boldsymbol{w_n})\\
        &=\lambda\mathscr{T}(\boldsymbol{v})
    \end{aligned}
$$

于是 $\mathscr{T}$ 是一个线性映射。接下去还要说明这个线性映射的唯一性。考虑另一个线性映射 $\mathscr{T}'\in\mathcal{L}(\mathcal{V},\mathcal{W})$ 且 $\mathscr{T}'(\boldsymbol{v_j})=\boldsymbol{w_j}$ 对于任意 $j=1,\cdots,n$ 成立。令 $c_1,\cdots,c_n\in\mathbb{F}$，根据线性映射的齐次性有

$$
    \mathscr{T}'(c_j\boldsymbol{v}_j)=c_j\boldsymbol{w_j}
$$

根据线性映射的可加性可以得到

$$
    \mathscr{T}'(c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n})=c_1\boldsymbol{w_1}+\cdots+c_n\boldsymbol{w_n}
$$

因此可以得到 $\mathscr{T}'=\mathscr{T}$，即这样的线性映射是唯一的。$\square$

<br>

> **定义 3.1-2 线性映射构成的集合上的加法和标量乘法**
>
> 考虑线性映射 $\mathscr{S},\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$ 和标量 $\lambda\in\mathbb{F}$。映射之间的和 $\mathscr{S}+\mathscr{T}$ 定义为
>
> $$
    (\mathscr{S}+\mathscr{T})(\boldsymbol{v})=\mathscr{S}(\boldsymbol{v})+\mathscr{T}(\boldsymbol{v}),\;\boldsymbol{v}\in\mathcal{V}
>   $$
>
> 映射与标量之间的积可以定义为
>
> $$
    (\lambda\mathscr{T})(\boldsymbol{v})=\lambda(\mathscr{T}(\boldsymbol{v})),\;\boldsymbol{v}\in\mathcal{V}
>   $$

<br>

> **命题 3.1-2 线性映射构成的集合是向量空间**
>
> 集合 $\mathcal{L}(\mathcal{V},\mathcal{W})$ 是向量空间

<br>

证明：设线性映射 $\mathscr{T},\mathscr{S}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，根据线性映射加法的定义，对于任意 $\boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$ 都有：

$$
    \begin{aligned}
        (\mathscr{T}+\mathscr{S})(\boldsymbol{u}+\boldsymbol{v})&=\mathscr{T}(\boldsymbol{u}+\boldsymbol{v})+\mathscr{S}(\boldsymbol{u}+\boldsymbol{v})\\
        &=\mathscr{T}(\boldsymbol{u})+\mathscr{T}(\boldsymbol{v})+\mathscr{S}(\boldsymbol{u})+\mathscr{S}(\boldsymbol{v})\\
        &=(\mathscr{T}+\mathscr{S})(\boldsymbol{u})+(\mathscr{T}+\mathscr{S})(\boldsymbol{v})
    \end{aligned}
$$

两个线性映射的和满足了线性映射的可加性。同样的，设 $\eta\in\mathbb{F}$ 和 $\boldsymbol{v}\in\mathcal{V}$，都有：

$$
    \begin{aligned}
        (\mathscr{T}+\mathscr{S})(\eta\boldsymbol{v})&=\mathscr{T}(\eta\boldsymbol{v})+\mathscr{S}(\eta\boldsymbol{v})\\
        &=\eta\mathscr{T}(\boldsymbol{v})+\eta\mathscr{S}(\boldsymbol{v})\\
        &=\eta(\mathscr{T}+\mathscr{S})(\boldsymbol{v})
    \end{aligned}
$$

于是两个线性映射的和满足了线性映射的齐次性。根据以上两条证明可知线性映射构成的集合对加法封闭。接下去说明线性映射构成的集合对标量乘法封闭，对于 $\lambda\in\mathbb{F}$ 与 $\boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$ 都有：

$$
    \begin{aligned}
        (\lambda\mathscr{T})(\boldsymbol{u}+\boldsymbol{v})&=\lambda(\mathscr{T}(\boldsymbol{u}+\boldsymbol{v}))\\
        &=\lambda(\mathscr{T}(\boldsymbol{u})+\mathscr{T}(\boldsymbol{v}))\\
        &=(\lambda\mathscr{T})(\boldsymbol{u})+(\lambda\mathscr{T})(\boldsymbol{v})
    \end{aligned}
$$

线性映射的标量乘法满足了线性映射的可加性。同样的，设 $\eta\in\mathbb{F}$ 和 $\boldsymbol{v}\in\mathcal{V}$，都有：

$$
    \begin{aligned}
        (\lambda\mathscr{T})(\eta\boldsymbol{v})&=\lambda(\mathscr{T}(\eta\boldsymbol{v}))\\
        &=\lambda(\eta\mathscr{T}(\boldsymbol{v}))\\
        &=\eta(\lambda\mathscr{T})(\boldsymbol{v})
    \end{aligned}
$$

于是线性映射的标量乘法满足了线性映射的齐次性。根据以上两条证明可知线性映射构成的集合对标量乘法封闭。

综上所述，线性映射构成的集合是向量空间。$\square$

<br>

> **定义 3.1-3 线性映射构成的集合上的复合/乘法**
>
> 设 $\mathscr{T}\in\mathcal{L}(\mathcal{U},\mathcal{V})$ 与 $\mathscr{S}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则线性映射间的复合定义为
>
> $$
    (\mathscr{S}\circ\mathscr{T})(\boldsymbol{u})=\mathscr{S}(\mathscr{T}(\boldsymbol{u})),\;\boldsymbol{u}\in\mathcal{U}
>   $$

<br>

> **命题 3.1-3 线性映射复合运算的性质**
>
> - 结合律：对于线性映射 $\mathscr{T}_1,\mathscr{T}_2,\mathscr{T}_3$，当它们满足 $\mathscr{T}_1\in\mathcal{L}_1(\mathcal{W},\mathcal{X})$、$\mathscr{T}_2\in\mathcal{L}_2(\mathcal{V},\mathcal{W})$ 和 $\mathscr{T}_3\in\mathcal{L}_3(\mathcal{U},\mathcal{V})$ 时，存在
>
> $$
    (\mathscr{T}_1\circ\mathscr{T}_2)\circ\mathscr{T_3}=\mathscr{T}_1\circ(\mathscr{T}_2\circ\mathscr{T}_3)
>   $$
>
> - 恒等律：对于线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，恒等线性映射 $\mathscr{I}_1\in\mathcal{L}(\mathcal{V},\mathcal{V})$ 与 $\mathscr{I}_2\in\mathcal{L}(\mathcal{W},\mathcal{W})$，则有：
>
> $$
    \mathscr{T}\circ\mathscr{I}_1=\mathscr{I}_2\circ\mathscr{T}=\mathscr{T}
>   $$
>
> - 分配律：对于线性映射 $\mathscr{T},\mathscr{T}_1,\mathscr{T}_2\in\mathcal{L(V,W)}$ 与 $\mathscr{S},\mathscr{S}_1,\mathscr{S}_2\in\mathcal{L(U,V)}$，有
>
> $$
    (\mathscr{T}_1+\mathscr{T}_2)\circ\mathscr{S}=\mathscr{T}_1\circ\mathscr{S}+\mathscr{T}_2\circ\mathscr{S}
>   $$
>
> $$
    \mathscr{T}\circ(\mathscr{S}_1+\mathscr{S}_2)=\mathscr{T}\circ\mathscr{S}_1+\mathscr{T}\circ\mathscr{S}_2
> $$

<br>

<!-- NOTICE : 这里是因为之前将线性映射的顺序写错了，记号出了问题，后面修改这段内容的时候映射的修改了定义域、值域的顺序，所以会看起来比较别扭-->

证明：
- 结合律：对于 $\boldsymbol{v}\in\mathcal{U}$

    $$
        \begin{aligned}
            ((\mathscr{T}_1\circ\mathscr{T}_2)\circ\mathscr{T}_3)(\boldsymbol{v})&=(\mathscr{T}_1\circ\mathscr{T}_2)(\mathscr{T}_3(\boldsymbol{v}))\\
            &=\mathscr{T}_1(\mathscr{T}_2(\mathscr{T}_3(\boldsymbol{v})))\\
            &=\mathscr{T}_1(\mathscr{T}_2\circ\mathscr{T}_3(\boldsymbol{v}))\\
            &=(\mathscr{T}_1\circ(\mathscr{T}_2\circ\mathscr{T}_3))(\boldsymbol{v})
        \end{aligned}
    $$

- 恒等律：对于 $\boldsymbol{v_j}\in\mathcal{V}$，设 $\mathscr{T}(\boldsymbol{v_j})=\boldsymbol{w_j}$，其中 $\boldsymbol{w_j}\in\mathcal{W}$

    $$
        \begin{aligned}
            (\mathscr{T}\circ\mathscr{I}_1)(\boldsymbol{v_j})&=\mathscr{T}(\mathscr{I}_1(\boldsymbol{v_j}))\\
            &=\mathscr{T}(\boldsymbol{v_j})\\
            &=\boldsymbol{w_j}\\
            (\mathscr{I}_2\circ\mathscr{T})(\boldsymbol{v_j})&=\mathscr{I}_2(\mathscr{T}(\boldsymbol{v_j}))\\
            &=\mathscr{I}_2(\boldsymbol{w_j})\\
            &=\boldsymbol{w_j}
        \end{aligned}
    $$

- 分配律：对于 $\boldsymbol{u}\in\mathcal{U}$

    $$
        \begin{aligned}
            ((\mathscr{T}_1+\mathscr{T}_2)\circ\mathscr{S})(\boldsymbol{u})&=(\mathscr{T}_1+\mathscr{T}_2)(\mathscr{S}(\boldsymbol{u}))\\
            &=\mathscr{T}_1(\mathscr{S}(\boldsymbol{u}))+\mathscr{T}_2(\mathscr{S}(\boldsymbol{u}))\\
            &=(\mathscr{T}_1\circ\mathscr{S})(\boldsymbol{u})+(\mathscr{T}_2\circ\mathscr{S})(\boldsymbol{u})\\
            &=(\mathscr{T}_1\circ\mathscr{S}+\mathscr{T}_2\circ\mathscr{S})(\boldsymbol{u})
        \end{aligned}
    $$

    $$
        \begin{aligned}
            (\mathscr{T}\circ(\mathscr{S}_1+\mathscr{S}_2))(\boldsymbol{u})&=\mathscr{T}((\mathscr{S}_1+\mathscr{S}_2)(\boldsymbol{u}))\\
            &=\mathscr{T}(\mathscr{S}_1(\boldsymbol{u}))+\mathscr{T}(\mathscr{S}_2(\boldsymbol{u}))\\
            &=(\mathscr{T}\circ\mathscr{S}_1)(\boldsymbol{u})+(\mathscr{T}\circ\mathscr{S}_2)(\boldsymbol{u})\\
            &=(\mathscr{T}\circ\mathscr{S}_1+\mathscr{T}\circ\mathscr{S}_2)(\boldsymbol{u})
        \end{aligned}
    $$

    分配律的证明使用到了线性映射构成的集合对加法封闭的结论。

证毕。$\square$

<br>

### 3.2 零空间与值域

<br>

> **定义 3.2-1 零空间**
>
> 对于线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$，其零空间（null sapce）/核空间（kernel space）记为 $\text{null}\mathscr{T}$，定义为 $\mathcal{V}$ 中那些被 $\mathscr{T}$ 映射为 $\boldsymbol{0}$ 的元素组成的集合：
>
> $$
    \text{null}\mathscr{T}:=\{\boldsymbol{v}\in\mathcal{V}:\mathscr{T}(\boldsymbol{v})=\boldsymbol{0}\}
>   $$

<br>

例如对于多项式的微分运算 $\mathscr{D}\in\mathcal{L}(\mathcal{P}(\mathbb{R}),\mathcal{P}(\mathbb{R})$，其零空间就是常数函数组成的集合。

<br>

> **命题 3.2-1 零空间是向量空间**
>
> 对于线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$，其零空间 $\text{null}\mathscr{T}$ 是向量空间 $\mathcal{V}$ 的子空间

<br>

证明：设 $\boldsymbol{u},\boldsymbol{v}\in\text{null}\mathscr{T}$，根据线性映射的可加性，很容易知道 $\mathscr{T}(\boldsymbol{0})=\boldsymbol{0}$，因此 $\boldsymbol{0}\in\text{null}\mathscr{T}$，故有

$$
    \mathscr{T}(\boldsymbol{u}+\boldsymbol{v})=\mathscr{T}(\boldsymbol{u})+\mathscr{T}(\boldsymbol{v})=\boldsymbol{0}+\boldsymbol{0}=\boldsymbol{0}
$$

因此零空间对加法封闭。接下去说明零空间对标量乘法封闭，设 $\lambda\in\mathbb{F}$：

$$
    \mathscr{T}(\lambda\boldsymbol{u})=\lambda\mathscr{T}(\boldsymbol{u})=\lambda\boldsymbol{u}=\boldsymbol{0}
$$

因此零空间还对标量乘法封闭，这说明零空间是一个向量空间，且其又是向量空间 $\mathcal{V}$ 的子集，因此其是 $\mathcal{V}$ 的子空间。$\square$

<br>

> **定义 3.2-2 单射**
>
> 对于线性映射 $\mathscr{T}:\mathcal{V\mapsto W}$，如果 $\mathscr{T}(\boldsymbol{u})=\mathscr{T}(\boldsymbol{v})$ 可以得到 $\boldsymbol{u}=\boldsymbol{v}$，则称线性映射 $\mathscr{T}$ 为单射（injective）

<br>

> **命题 3.2-2 单射意味着零空间只有元素 $\boldsymbol{0}$**
>
> 对于线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$，$\mathscr{T}$ 是单射当且仅当 $\text{null}\mathscr{T}=\{0\}$

<br>

证明：
- 充分性：当 $\mathscr{T}$ 是一个单射时，对于任意 $\boldsymbol{v}\in\mathcal{V}$ 都有 $\mathscr{T}(\boldsymbol{v})=\boldsymbol{0}=\mathscr{T}(\boldsymbol{0})$ 成立，根据单射的定义可知 $\boldsymbol{v}=\boldsymbol{0}$，因此 $\text{null}\mathscr{T}$ 中只有元素 $\boldsymbol{0}$；
- 必要性：当 $\text{null}\mathscr{T}=\{0\}$ 时，对于任意 $\boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$ 且满足 $\mathscr{T}(\boldsymbol{u})=\mathscr{T}(\boldsymbol{v})$ 都有

    $$
        \mathscr{T}(\boldsymbol{u}-\boldsymbol{v})=\mathscr{T}(\boldsymbol{u})-\mathscr{T}(\boldsymbol{v})=\boldsymbol{0}
    $$

    因此 $\boldsymbol{u}-\boldsymbol{v}\in\text{null}\mathscr{T}$，于是 $\boldsymbol{u}-\boldsymbol{v}=\boldsymbol{0}$，即 $\boldsymbol{u}=\boldsymbol{v}$，则 $\mathscr{T}$ 是一个单射。

证毕。$\square$

<br>

> **定义 3.2-3 值域**
>
> 对于线性映射 $\mathscr{T}:\mathcal{V\mapsto W}$，其值域（range）/象（image）是 $\mathcal{W}$ 的子集且包含所有经过 $\mathscr{T}$ 映射后的元素：
>
> $$
    \text{range}\mathscr{T}=\{\mathscr{T}(\boldsymbol{v}):\boldsymbol{v}\in\mathcal{V}\}
>   $$

<br>

> **命题 3.2-3 值域是向量空间**
>
> 对于线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$，其值域 $\text{range}\mathscr{T}$ 是向量空间 $\mathcal{W}$ 的子空间

<br>

证明：由 $\mathscr{T}(\boldsymbol{0})=\boldsymbol{0}$ 可知 $\boldsymbol{0}\in\text{range}\mathscr{T}$。设 $\boldsymbol{w_1},\boldsymbol{w_2}\in\text{range}\mathscr{T}$，则由值域的定义可知存在向量 $\boldsymbol{v_1},\boldsymbol{v_2}\in\mathcal{V}$ 使得 $\mathscr{T}(\boldsymbol{v_1})=\boldsymbol{w_1}$ 与 $\mathscr{T}(\boldsymbol{v_2})=\boldsymbol{w_2}$，则

$$
    \mathscr{T}(\boldsymbol{v_1}+\boldsymbol{v_2})=\mathscr{T}(\boldsymbol{v_1})+\mathscr{T}(\boldsymbol{v_2})=\boldsymbol{w_1}+\boldsymbol{w_2}
$$

因此 $\boldsymbol{w_1}+\boldsymbol{w_2}\in\text{range}\mathscr{T}$，于是 $\text{range}\mathscr{T}$ 对加法封闭。接下去说明其对标量乘法也封闭，设 $\lambda\in\mathbb{F}$，$\boldsymbol{w}\in\text{range}\mathscr{T}$，于是存在 $\boldsymbol{v}\in\mathcal{V}$ 使得 $\mathscr{T}(\boldsymbol{v})=\boldsymbol{w}$，则

$$
    \mathscr{T}(\lambda\boldsymbol{v})=\lambda\mathscr{T}(\boldsymbol{v})=\lambda\boldsymbol{w}
$$

因此 $\text{range}\mathscr{T}$ 对标量乘法封闭。综上所述，$\text{range}\mathscr{T}$ 是向量空间，且又是 $\mathcal{W}$ 的子集，因此是其子空间。$\square$

<br>

> **定义 3.2-4 满射**
>
> 对于线性映射 $\mathscr{T}:\mathcal{V\mapsto W}$，如果 $\text{range}\mathscr{T}=\mathcal{W}$，则称线性映射 $\mathscr{T}$ 为满射（surjective）

<br>

对于多项式微分运算 $\mathscr{D}\in\mathcal{L}(\mathcal{P}_5(\mathbb{R}),\mathcal{P}_5(\mathbb{R}))$，由于 $x^5$ 不属于 $\text{range}\mathscr{D}$，因此其不是满射。如果将其改为 $\mathscr{D}\in\mathcal{L}(\mathcal{P}_5(\mathbb{R}),\mathcal{P}_4(\mathbb{R}))$，则其是满射。

<br>

> **定理 3.2-4 线性映射基础定理**
>
> 设 $\mathcal{V}$ 是一个有限维向量空间，线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$，则其值域 $\text{range}\mathscr{T}$ 也是有限维向量空间，且
>
> $$
    \dim\mathcal{V}=\dim\text{null}\mathscr{T}+\dim\text{range}\mathscr{T}
>   $$

<br>

证明：设 $\boldsymbol{u_1},\cdots,\boldsymbol{u_m}$ 是 $\text{null}\mathscr{T}$ 的基，根据维数的定义，$\dim\text{null}\mathscr{T}=m$。对于 $\mathcal{V}$ 来说 $\boldsymbol{u_1},\cdots,\boldsymbol{u_m}$ 是一组线性无关向量组，根据命题 2.2-4（线性无关向量组可以扩充成基）知 $\mathcal{V}$ 的基可以写作：

$$
    \boldsymbol{u_1},\cdots,\boldsymbol{u_m},\boldsymbol{v_1},\cdots,\boldsymbol{v_n}
$$

则 $\dim\mathcal{V}=m+n$，为了证明基础定理，只需要证明 $\dim\text{range}\mathscr{T}=n$，即只要说明 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\text{range}\mathscr{T}$ 的基即可。对于 $\boldsymbol{v}\in\mathcal{V}$，设 $a_1,\cdots,a_m,b_1,\cdots,b_n\in\mathbb{F}$，则

$$
    \boldsymbol{v}=a_1\boldsymbol{w_1}+\cdots+a_m\boldsymbol{w_m}+b_1\boldsymbol{v_1}+\cdots+b_n\boldsymbol{v_n}
$$

由线性映射的可加性与齐次性可知：

$$
    \mathscr{T}(\boldsymbol{v})=b_1\mathscr{T}(\boldsymbol{v_1})+\cdots+b_n\mathscr{T}(\boldsymbol{v_n})
$$

注意其中所有的 $a_i\mathscr{T}(\boldsymbol{w_i})=\boldsymbol{0}$。下面只要再说明 $b_1\mathscr{T}(\boldsymbol{v_1}),\cdots,b_n\mathscr{T}(\boldsymbol{v_n})$ 是线性无关的即可说明它们是 $\text{range}\mathscr{T}$ 的基。设 $c_1,\cdots,c_n\in\mathbb{F}$ 使得

$$
    c_1\mathscr{T}(\boldsymbol{v_1})+\cdots+c_n\mathscr{T}(\boldsymbol{v_n})=\boldsymbol{0}
$$

根据线性映射的可加性和齐次性可知：

$$
    \mathscr{T}(c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n})=\boldsymbol{0}
$$

因此 $c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}\in\text{null}\mathscr{T}$，于是存在 $d_1,\cdots,d_m\in\mathbb{F}$ 使得

$$
    c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}=d_1\boldsymbol{w_1}+\cdots+d_m\boldsymbol{w_m}
$$

由于 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n},\boldsymbol{w_1},\cdots,\boldsymbol{w_m}$ 是线性无关的，因此上面所有的系数都是 $0$，也说明了使得 $c_1\mathscr{T}(\boldsymbol{v_1})+\cdots+c_n\mathscr{T}(\boldsymbol{v_n})=\boldsymbol{0}$ 的系数只能全为 $0$，即 $\mathscr{T}(\boldsymbol{v_1}),\cdots,\mathscr{T}(\boldsymbol{v_n})$ 线性无关，因此它们是 $\text{range}\mathscr{T}$ 的基，故 $\dim\text{range}\mathscr{T}=n$。

综上所述，我们证明了线性映射基础定理。$\square$

<br>

> **命题 3.2-5 值域为更低维向量空间的线性映射不是单射**
>
> 考虑向量空间 $\mathcal{V}$ 和 $\mathcal{W}$ 是有限维向量空间并且 $\dim\mathcal{V}>\dim\mathcal{W}$，则不存在单射 $\mathscr{T}$ 使得 $\mathscr{T}:\mathcal{V\mapsto W}$

<br>

证明：根据线性映射基础定理，令 $\mathscr{T}\in\mathcal{L(V,W)}$，则有

$$
    \begin{aligned}
        \dim\text{null}\mathscr{T}&=\dim\mathcal{V}-\dim\text{range}\mathscr{T}\\
        &\geq\dim\mathcal{V}-\dim\mathcal{W}\\
        &>0
    \end{aligned}
$$

这说明 $\text{null}\mathscr{T}$ 不止包括元素 $\boldsymbol{0}$，因此其不是单射。$\square$

<br>

> **命题 3.2-6 值域为更高维向量空间的线性映射不是满射**
>
> 考虑向量空间 $\mathcal{V}$ 和 $\mathcal{W}$ 是有限维向量空间并且 $\dim\mathcal{V}<\dim\mathcal{W}$，则不存在满射 $\mathscr{T}$ 使得 $\mathscr{T}:\mathcal{V\mapsto W}$

<br>

证明：根据线性映射基础定理，令 $\mathscr{T}\in\mathcal{L(V,W)}$，则有

$$
    \begin{aligned}
        \dim\text{range}\mathscr{T}&=\dim\mathcal{V}-\dim\text{null}\mathscr{T}\\
        &\leq\dim\mathcal{V}\\
        &<\dim\mathcal{W}
    \end{aligned}
$$

因此根据满射的定义可知 $\mathscr{T}$ 不是满射。$\square$

线性映射基础定理推导出的这两个命题有重要的作用，用它们可以探究线性方程组解的情况。设正整数 $m,n$，令 $A_{j,k}\in\mathbb{F}$，其中 $j=1,\cdots,m$，$k=1,\cdots,n$，考虑如下线性方程组：

$$
    \begin{aligned}
        \sum_{k=1}^nA_{1,k}x_k&=0\\
        &\vdots\\
        \sum_{k=1}^nA_{m,k}x_k&=0
    \end{aligned}
$$

明显 $x_1=\cdots=x_k=0$ 是上述方程组的一个解，我们要探讨的问题是是否存在其余的解。定义线性映射 $\mathscr{T}:\mathbb{F}^n\mapsto\mathbb{F}^m$ 为：

$$
    \mathscr{T}(x_1,\cdots,x_n)=\left(\sum_{k=1}^nA_{1,k}x_k,\cdots,\sum_{k=1}^nA_{m,k}x_k\right)
$$

方程 $\mathscr{T}(x_1,\cdots,x_n)=\boldsymbol{0}$ 与上述线性方程组等价，所以我们想探讨的问题实际上等价于研究线性映射的零空间 $\text{null}\mathscr{T}$ 的维数。我们给出下面这个命题：

<br>

> **命题 3.2-7 齐次线性方程组的解**
>
> 当一个齐次线性方程组中变量数大于方程个数（在上面的例子中有 $m<n$）时，方程有非零解

<br>

证明：因为我们构造了线性映射 $\mathscr{T}:\mathbb{F}^n\mapsto\mathbb{F}^m$，当 $m<n$ 时，根据命题 3.2-5 可知零空间不等于 $\{\boldsymbol{0}\}$，因此方程组存在非零解。$\square$

设正整数 $m,n$，令 $A_{j,k}\in\mathbb{F}$，其中 $j=1,\cdots,m$，$k=1,\cdots,n$。对于 $c_1,\cdots,c_m\in\mathbb{F}$，考虑以下的非齐次线性方程组：

$$
    \begin{aligned}
        \sum_{k=1}^nA_{1,k}x_k&=c_1\\
        &\vdots\\
        \sum_{k=1}^nA_{m,k}x_k&=c_m
    \end{aligned}
$$

我们要探讨的问题是是否存在一组 $(c_1,\cdots,c_k)$ 使得上述非齐次线性方程组不存在解。定义线性映射 $\mathscr{T}:\mathbb{F}^n\mapsto\mathbb{F}^m$ 为：

$$
    \mathscr{T}(x_1,\cdots,x_n)=\left(\sum_{k=1}^nA_{1,k}x_k,\cdots,\sum_{k=1}^nA_{m,k}x_k\right)
$$

方程 $\mathscr{T}(x_1,\cdots,x_n)=(c_1,\cdots,c_n)$ 与上述非齐次线性方程组等价，所以我们探讨的问题等价于研究 $\text{range}\mathscr{T}=\mathbb{F}^m$ 是否有可能不成立。我们给出下面这个命题：

<br>

> **命题 3.2-8 非齐次线性方程组的解**
>
> 当一个非齐次线性方程组的方程个数大于变量数（在上面的例子中有 $m>n$）时，存在这样的 $(c_1,\cdots,c_m)$ 使得该非齐次线性方程组无解

<br>

证明：因为我们构造了线性映射 $\mathscr{T}:\mathbb{F}^n\mapsto\mathbb{F}^m$，当 $m>n$ 时，根据命题 3.2-6，$\text{range}\mathscr{T}\neq\mathcal{W}$，因此存在 $\boldsymbol{c}\in\mathcal{W}\backslash\text{range}\mathscr{T}$ 使得上述非齐次线性方程组无解。

<br>

### 3.3 矩阵

<br>

> **定义 3.3-1 矩阵**
>
> 设正整数 $m,n$，则一个 $m\times n$ 矩阵 $\bf{A}$ 是一个 $m$ 行 $n$ 列的以 $\mathbb{F}$ 中的元素作为内容的矩形数组，记作
>
> $$
    \bf{A}=\begin{pmatrix}
        A_{1,1}&\cdots&A_{1,n}\\
        \vdots& &\vdots\\
        A_{m,1}&\cdots&A_{m,n}
    \end{pmatrix}
>   $$
>
> $A_{j,k}$ 表示位于第 $j$ 行第 $k$ 列的元素

<br>

> **定义 3.3-2 线性映射的矩阵表示**
>
> 考虑线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$，$\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基，$\boldsymbol{w_1},\cdots,\boldsymbol{w_m}$ 是 $\mathcal{W}$ 的基。以这两组基为基础，线性映射 $\mathscr{T}$ 的矩阵表示是一个 $m\times n$ 的矩阵，记作 $\mathcal{M}(\mathscr{T})$，其中元素 $A_{j,k}$ 定义如下
>
> $$
    \mathscr{T}(\boldsymbol{v_k})=A_{1,k}\boldsymbol{w_1}+\cdots+A_{m,k}\boldsymbol{w_m}
>   $$
>
> 事实上，$m$ 是 $\mathscr{T}$ 值域的维数，$n$ 是 $\mathscr{T}$ 定义域的维数。$\boldsymbol{v_k}$ 经过 $\mathscr{T}$ 映射到 $\mathcal{W}$ 中的元素可以被 $\mathcal{W}$ 中的基唯一表示

<br>

$$
    \mathcal{M}(\mathscr{T})=\begin{pmatrix}
        A_{1,1}&\cdots&A_{1,k}&\cdots&A_{1,n}\\
        \vdots&&\vdots&&\vdots\\
        A_{m,1}&\cdots&A_{m,k}&\cdots&A_{m,n}
    \end{pmatrix}
$$

对于线性映射 $\mathscr{T}:\mathbb{F}^n\mapsto\mathbb{F}^m$，除非上下文有具体说明，否则一般假设这些基是标准基。我喜欢将线性映射的矩阵表示看作一个「加工厂」，位于矩阵上方的定义域向量空间中的基经过线性映射，映射到位于矩阵左方的象，而这些象的「零件」是值域向量空间的基，其「配比」就是矩阵中的一列中的系数。

对于涉及多项式向量空间 $\mathcal{P}_m(\mathbb{F})$ 的线性映射，基本用 $1,x,x^2,\cdots,x^m$ 作为基。例如对于微分运算 $\mathscr{D}\in\mathcal{L}(\mathcal{P}_m(\mathbb{R}),\mathcal{P}_{m-1}(\mathbb{R}))$，由于

$$
    \mathscr{D}(x^k)=(x^k)'=kx^{k-1}
$$

因此 $\mathscr{D}$ 的矩阵可以写作

$$
    \mathcal{M}(\mathscr{D})=\begin{pmatrix}
        0&1&0&\cdots&0\\
        0&0&2&\cdots&0\\
        \vdots&\vdots&\vdots&\ddots&0\\
        0&0&0&\cdots&m
    \end{pmatrix}_{m\times(m+1)}
$$

<br>

> **定义 3.3-3 矩阵加法**
>
> 对于行列大小相同的矩阵，它们的和定义为各个位置上元素的和重新组成的矩阵，即 $(A+C)_{j,k}=A_{j,k}+C_{j,k}$，则
>
> $$
    \begin{pmatrix}
        A_{1,1}&\cdots&A_{1,n}\\
        \vdots&&\vdots\\
        A_{m,1}&\cdots&A_{m,n}
    \end{pmatrix}
    +
    \begin{pmatrix}
        C_{1,1}&\cdots&C_{1,n}\\
        \vdots&&\vdots\\
        C_{m,1}&\cdots&C_{m,n}
    \end{pmatrix}
    =
    \begin{pmatrix}
        A_{1,1}+C_{1,1}&\cdots&A_{1,n}+C_{1,n}\\
        \vdots&&\vdots\\
        A_{m,1}+C_{m,1}&\cdots&A_{m,n}+C_{m,n}
    \end{pmatrix}
>   $$

<br>

> **命题 3.3-1 线性映射矩阵的加法**
>
> 对于线性映射 $\mathscr{S},\mathscr{T}\in\mathcal{L(V,W)}$，有 $\mathcal{M}(\mathscr{S}+\mathscr{T})=\mathcal{M}(\mathscr{S})+\mathcal{M}(\mathscr{T})$

<br>

证明：设 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}$ 为 $\mathcal{V}$ 的基，$\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$ 为 $\mathcal{W}$ 的基，根据线性映射的矩阵中系数的定义可知

$$
    \mathscr{T}(\boldsymbol{v_k})=\sum_{j=1}^nA_{j,k}\boldsymbol{w_k},\quad\mathscr{S}(\boldsymbol{v_k})=\sum_{j=1}^nB_{j,k}\boldsymbol{w_k}
$$

因此根据线性映射的加法定义可知：

$$
    (\mathscr{T}+\mathscr{S})(\boldsymbol{v_k})=\sum_{j=1}^n(A_{j,k}+B_{j,k})\boldsymbol{w_k}
$$

在 $\mathcal{M}(\mathscr{T}+\mathscr{S})$ 的第 $k$ 列，基的系数为 $A_{j,k}+B_{j,k}$。$\square$

<br>

> **定义 3.3-4 矩阵标量乘法**
>
> 矩阵与标量之间的乘积等于矩阵元素与标量之间相乘后组成的新矩阵，设 $\lambda\in\mathbb{F}$，即 $(\lambda A)_{j,k}=\lambda A_{j,k}$，则
> 
> $$
    \lambda\begin{pmatrix}
        A_{1,1}&\cdots&A_{1,n}\\
        \vdots&&\vdots\\
        A_{m,1}&\cdots&A_{m,n}
    \end{pmatrix}
    =\begin{pmatrix}
        \lambda A_{1,1}&\cdots&\lambda A_{1,n}\\
        \vdots&&\vdots\\
        \lambda A_{m,1}&\cdots&\lambda A_{m,n}
    \end{pmatrix}
>   $$

<br>

> **命题 3.3-2 线性映射矩阵的标量乘法**
>
> 设 $\lambda\in\mathbb{F}$，$\mathscr{T}\in\mathcal{L(V,W)}$，则 $\mathcal{M}(\lambda\mathscr{T})=\lambda\mathcal{M}(\mathscr{T})$

<br>

证明：设 $\boldsymbol{v_1},\cdots,\boldsymbol{v_m}$ 为 $\mathcal{V}$ 的基，$\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$ 为 $\mathcal{W}$ 的基，根据线性映射的矩阵中系数的定义可知

$$
    \mathscr{T}(\boldsymbol{v_k})=\sum_{j=1}^nA_{j,k}\boldsymbol{w_j}
$$

因此根据线性映射的乘法定义可知：

$$
    \lambda\mathscr{T}(\boldsymbol{v_k})=\lambda\sum_{j=1}^nA_{j,k}\boldsymbol{w_j}=\sum_{j=1}^n\lambda A_{j,k}\boldsymbol{w_k}
$$

在 $\mathcal{M}(\lambda\mathscr{T})$ 的第 $k$ 列，基的系数是 $\lambda A_{j,k}$。$\square$

<br>

> **定义 3.3-5 $\mathbb{F}^{m,n}$**
>
> 对于所有元素属于 $\mathbb{F}$ 的 $m\times n$ 矩阵，用 $\mathbb{F}^{m,n}$ 表示它们构成的集合

<br>

> **命题 3.3-3 $\dim\mathbb{F}^{m,n}=mn$**
>
> $\mathbb{F}^{m,n}$ 是一个向量空间，并且其维数是 $mn$

<br>

证明：由于 $\mathbb{F}^{m,n}$ 对加法和标量乘法封闭（根据命题 3.3-1 和 3.3-2），并且存在一个零映射 $0\in\mathbb{F}^{m,n}$，因此 $\mathbb{F}^{m,n}$ 是向量空间。设 $\mathscr{B}_{j,k}$ 表示在 $\mathcal{M}(\mathscr{B}_{j,k})$ 中满足 $A_{j,k}=1$ 且 $A_{a,b}=0$ 其中 $a\neq j,b\neq k$ 的矩阵对应的线性映射，则很明显 $\mathscr{B}_{j,k}$ 其中 $1\leq j\leq m,1\leq k\leq n$ 构成了 $\mathbb{F}^{m,n}$ 的基。设 $\mathcal{M}(\mathscr{T})\in\mathbb{F}^{m,n}$，设 $\mathcal{M}(\mathscr{T})$ 中第 $j$ 行第 $k$ 列的元素为 $T_{j,k}$，则

$$
    \begin{aligned}
    \mathcal{M}(\mathscr{T})&=T_{1,1}\mathcal{M}(\mathscr{B}_{1,1})+\cdots+T_{m,n}\mathcal{M}(\mathscr{B}_{m,n})\\
    &=\sum_{1\leq j\leq m,1\leq k\leq n}T_{j,k}\mathcal{M}(\mathscr{B}_{j,k})
    \end{aligned}
$$

证毕。$\square$

接下去考虑一个有意思的问题，在之前我们定义了线性映射的复合/乘法，所以很自然的，如果我们设 $\mathscr{T}:\mathcal{U\mapsto V}$ 与 $\mathscr{S}:\mathcal{V\mapsto W}$，我们会关心 $\mathcal{M}(\mathscr{S}\circ\mathscr{T})=\mathcal{M}(\mathscr{S})\mathcal{M}(\mathscr{T})$ 是否成立，但是我们还没定义矩阵的乘法。设 $\boldsymbol{u_1},\cdots,\boldsymbol{u_m}$ 是 $\mathcal{U}$ 的基，$\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基，$\boldsymbol{w_1},\cdots,\boldsymbol{w_p}$ 是 $\mathcal{W}$ 的基，设 $\mathcal{M}(\mathscr{S})=\bf{A},\mathcal{M}(\mathscr{T})=\bf{C}$，对于 $1\leq k\leq m$，我们有

$$
    \begin{aligned}
        (\mathscr{S}\circ\mathscr{T})(\boldsymbol{u_k})&=\mathscr{S}\left(\sum_{r=1}^nC_{r,k}\boldsymbol{v_r}\right)\\
        &=\sum_{r=1}^nC_{r,k}\mathscr{S}(\boldsymbol{v_r})\\
        &=\sum_{r=1}^n\left(C_{r,k}\sum_{j=1}^pA_{j,r}\boldsymbol{w_j}\right)\\
        &=\sum_{r=1}^n\left(\sum_{j=1}^pA_{j,r}C_{r,k}\right)\boldsymbol{w_j}
    \end{aligned}
$$

于是我们可以给出如下的矩阵乘法的定义：

<br>

> **定义 3.3-6 矩阵的乘法**
>
> 设 $\bf{A}$ 是 $m\times n$ 矩阵，$\bf{C}$ 是 $n\times p$ 矩阵，则它们的乘积 $\bf{AC}$ 的第 $j$ 行第 $k$ 列的元素为被如下定义
>
> $$
    (AC)_{j,k}=\sum_{r=1}^nA_{j,r}C_{r,k}
>   $$
>
> 即 $\bf{AC}$ 第 $j$ 行第 $k$ 列的元素是 $\bf{A}$ 的第 $j$ 行与 $\bf{C}$ 的第 $k$ 列元素的乘积之和

<br>

> **命题 3.3-4 线性映射复合的矩阵表示**
>
> 令 $\mathscr{T}\in\mathcal{L(U,V)}$ 与 $\mathscr{S}\in\mathcal{L(V,W)}$，则 $\mathcal{M}(\mathscr{S}\circ\mathscr{T})=\mathcal{M}(\mathscr{S})\mathcal{M}(\mathscr{T})$，证明已经在上面研究线性映射复合的矩阵表示时就完成了（在定义矩阵乘法之后）

<br>

> **命题 3.3-4 矩阵乘法的分配律**
>
> 当 $\bf{A}(\bf{B}+\bf{C})$ 与 $(\bf{D}+\bf{E})\bf{F}$ 运算有意义时，有
>
> $$
    \begin{aligned}
        \bf{A}(\bf{B}+\bf{C})&=\bf{AB}+\bf{AC}\\
        (\bf{D}+\bf{E})\bf{F}&=\bf{DF}+\bf{EF}
    \end{aligned}
>   $$

<br>

证明：
- 设 $\mathbf{A}=\mathcal{M}(\mathscr{A})$，为$m\times n$ 矩阵，设 $\mathbf{B}=\mathcal{M}(\mathscr{B}),\mathbf{C}=\mathcal{M}(\mathscr{C})$，都是 $n\times p$ 矩阵，则根据线性映射复合的分配律（命题 3.1-3）：

    $$
        \mathscr{A}\circ(\mathscr{B}+\mathscr{C})=\mathscr{A}\circ\mathscr{B}+\mathscr{A}\circ\mathscr{C}
    $$

    由矩阵乘法和线性映射复合的关系知

    $$ 
        \mathcal{M}(\mathscr{A})(\mathcal{M}(\mathscr{B})+\mathcal{M}(\mathscr{C}))=\mathcal{M}(\mathscr{A})\mathcal{M}(\mathscr{B})+\mathcal{M}(\mathscr{A})\mathcal{M}(\mathscr{C})
    $$

- 设 $\mathbf{D}=\mathcal{M}(\mathscr{D}),\mathbf{E}=\mathcal{M}(\mathscr{E})$ 为 $m\times n$ 矩阵，设 $\mathbf{F}=\mathcal{M}(\mathscr{F})$ 为 $n\times p$ 矩阵，则根据线性映射复合的分配律：

    $$
        (\mathscr{D}+\mathscr{E})\circ\mathscr{F}=\mathscr{D}\circ\mathscr{F}+\mathscr{D}\circ\mathscr{F}
    $$

    由矩阵乘法和线性映射复合的关系知

    $$
        (\mathcal{M}(\mathscr{D})+\mathcal{M}(\mathscr{E}))\mathcal{M}(\mathscr{F}))=\mathcal{M}(\mathscr{D})\mathcal{M}(\mathscr{F})+\mathcal{M}(\mathscr{E})\mathcal{M}(\mathscr{F})
    $$

证毕。$\square$

<br>

> **命题 3.3-5 矩阵乘法的结合律**
>
> 当 $\bf (AB)C$ 运算有意义时，$\bf A(BC)$ 运算也有意义且 $\bf (AB)C=A(BC)$

<br>

证明：设 $\mathbf{A}=\mathcal{M}(\mathscr{A})$ 是 $m\times n$ 矩阵，$\mathbf{B}=\mathcal{M}(\mathscr{B})$ 是 $n\times p$ 矩阵，$\mathbf{C}=\mathcal{M}(\mathscr{C})$ 是 $p\times q$ 矩阵，$\bf A(BC)$ 运算有意义是显然的。根据线性映射复合的结合律（命题 3.1-3）可知

$$
    (\mathscr{A\circ B})\circ\mathscr{C}=\mathscr{A}\circ(\mathscr{B\circ C})
$$

根据矩阵乘法和线性映射复合的关系知矩阵乘法的结合律成立。$\square$

我们用记号 $\mathbf{A}_{j,.}$ 表示 $m\times n$ 矩阵 $\mathbf{A}$ 的第 $j$ 行分离出的 $1\times n$ 矩阵（我们可以称之为行向量），用 $\mathbf{A}_{.,k}$ 表示它的第 $k$ 列分离出的 $m\times 1$ 矩阵（我们可以称之为列向量），则之前矩阵乘法的定义又可以为

$$
    (AC)_{j,k}=\mathbf{A}_{j,.}\mathbf{C}_{k,.}
$$

或者

$$
    (AC)_{.,k}=\mathbf{AC}_{.,k}
$$

<br>

> **命题 3.3-6 列向量的线性组合**
>
> 设 $\mathbf{A}$ 是 $m\times n$ 矩阵，设 $\boldsymbol{c}$ 是 $n\times 1$ 矩阵（列向量）如下：
>
> $$
    \boldsymbol{c}=\begin{pmatrix}
        c_1\\ \vdots \\ c_n
    \end{pmatrix}
>   $$
>
> 则矩阵和列向量的乘积可以如下表示：
>
> $$
    \mathbf{A}\boldsymbol{c}=c_1\mathbf{A}_{.,1}+\cdots+c_n\mathbf{A}_{.,n}
>   $$
>
> $\mathbf{A}\boldsymbol{c}$ 是 $\mathbf{A}$ 的列向量的线性组合，它们的系数是 $\boldsymbol{c}$ 的分量

<br>

有了这样的方法就能够给出一个矩阵乘法更清晰的理解，即**两个矩阵相乘之后的每个列向量都是前面矩阵与后面矩阵中相对应的列向量的乘积**。

<br>

### 3.4 可逆性和同构的向量空间

<br>

> **定义 3.4-1 可逆与逆**
>
> 一个线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$ 称为可逆的（invertible），当且仅当存在一个线性映射 $\mathscr{S}\in\mathcal{L(W,V)}$ 使得 $\mathscr{T}\circ\mathscr{S}$ 等于 $\mathcal{V}$ 上的恒等线性映射 $\mathscr{I}_v$，$\mathscr{S}\circ\mathscr{T}$ 等于 $\mathcal{W}$ 上的恒等线性映射 $\mathscr{I}_w$
>
> 上面所说的线性映射 $\mathscr{S}$ 称为 $\mathscr{T}$ 的逆（inverse），可以记作 $\mathscr{T}^{-1}$

<br>

> **命题 3.4-1 逆是唯一的**
>
> 一个可逆的线性映射只存在唯一的逆

<br>

证明：假设 $\mathscr{S}_1,\mathscr{S}_2$ 都是可逆线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$ 的逆，则我们有

$$
    \begin{aligned}
        \mathscr{S_1}&=\mathscr{S}_1\circ\mathscr{I}_w=\mathscr{S}_1\circ(\mathscr{T}\circ\mathscr{S}_2)\\
        &=(\mathscr{S}_1\circ\mathscr{T})\circ\mathscr{S}_2=\mathscr{I}_v\circ\mathscr{S}_2=\mathscr{S}_2
    \end{aligned}
$$

证毕。$\square$

<br>

> **命题 3.4-2 线性映射的可逆等价于双射**
>
> 一个线性映射可逆，当且仅当它既是一个单射又是一个满射

<br>

证明：
- 单射（充分性）：设 $\boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$ 并且有 $\mathscr{T}(\boldsymbol{u})=\mathscr{T}(\boldsymbol{v})$，我们要说明的是 $\boldsymbol{u}=\boldsymbol{v}$，考虑

    $$
        \boldsymbol{u}=\mathscr{T}^{-1}(\mathscr{T}(\boldsymbol{u}))=\mathscr{T}^{-1}(\mathscr{T}(\boldsymbol{v}))=\boldsymbol{v}
    $$

- 满射（充分性）：考虑 $\boldsymbol{w}\in\mathcal{W}$，则 $\boldsymbol{w}=\mathscr{T}(\mathscr{T}^{-1}(\boldsymbol{w}))$，这说明 $\boldsymbol{w}\in\text{range}\mathscr{T}$，于是可以得到 $\text{range}\mathscr{T}=\mathcal{W}$，因此 $\mathscr{T}$ 是满射；
- 必要性：设 $\mathscr{T}$ 是一个双射，现在证明它可逆。设 $\boldsymbol{w}\in\mathcal{W}$，根据 $\mathscr{T}$ 是一个双射可知存在唯一的 $\mathscr{S}(\boldsymbol{w})$ 使得 $\mathscr{T}(\mathscr{S}(\boldsymbol{w}))=\boldsymbol{w}$，则 $\mathscr{T}\circ\mathscr{S}=\mathscr{I}_w$。令 $\boldsymbol{v}\in\mathcal{V}$，则有

    $$
        \mathscr{T}((\mathscr{S}\circ\mathscr{T})\boldsymbol{v})=(\mathscr{T}\circ\mathscr{S})(\mathscr{T}(\boldsymbol{v}))=\mathscr{I}_w(\mathscr{T}(\boldsymbol{v}))=\mathscr{T}(\boldsymbol{v})
    $$

    由于 $\mathscr{T}$ 是双射，我们可以得到 $(\mathscr{S}\circ\mathscr{T})(\boldsymbol{v})=\boldsymbol{v}$，因此 $\mathscr{S}\circ\mathscr{T}=\mathscr{I}_v$。

    注意我们的论证中还存在问题，即我们没有说明 $\mathscr{S}$ 是一个线性映射。设 $\boldsymbol{w_1},\boldsymbol{w_2}\in\mathcal{W}$，则可以得到

    $$
        \mathscr{T}(\mathscr{S}(\boldsymbol{w_1})+\mathscr{S}(\boldsymbol{w_2}))=\mathscr{T}(\mathscr{S}(\boldsymbol{w_1}))+\mathscr{T}(\mathscr{S}(\boldsymbol{w_2}))=\boldsymbol{w_1}+\boldsymbol{w_2}
    $$

    因此 $\mathscr{S}(\boldsymbol{w_1})+\mathscr{S}(\boldsymbol{w_2})$ 是 $\mathcal{V}$ 中唯一通过 $\mathscr{T}$ 映射得到 $\boldsymbol{w_1}+\boldsymbol{w_2}$ 的元素，于是

    $$
        \mathscr{S}(\boldsymbol{w_1}+\boldsymbol{w_2})=\mathscr{S}(\boldsymbol{w_1})+\mathscr{S}(\boldsymbol{w_2})
    $$

    因此 $\mathscr{S}$ 满足可加性。接下去说明 $\mathscr{S}$ 满足齐次性，设 $\boldsymbol{w}\in\mathcal{W}$ 与 $\lambda\in\mathbb{F}$，则

    $$
        \mathscr{T}(\lambda\mathscr{S}(\boldsymbol{w}))=\lambda\mathscr{T}(\mathscr{S}(\boldsymbol{w}))=\lambda\boldsymbol{w}
    $$

    因此 $\lambda\mathscr{S}(\boldsymbol{w})$ 是 $\mathcal{V}$ 中唯一的通过 $\mathscr{T}$ 映射得到 $\lambda\boldsymbol{w}$ 的元素，于是

    $$
        \mathscr{S}(\lambda\boldsymbol{w})=\lambda\mathscr{S}(\boldsymbol{w})
    $$

    我们知道了 $\mathscr{S}$ 是一个线性映射，也因此必要性成立。

证毕。$\square$

<br>

> **定义 3.4-2 同构与同构的向量空间**
>
> 同构（isomorphism）指的是一个保持结构的可逆线性映射
>
> 两个向量空间称为同构的（isomorphic）当且仅当存在一个从一个向量空间到另一个向量空间的同构，记作 $\mathcal{V}\cong\mathcal{W}$

<br>

> **命题 3.4-3 同构与维数的关系**
>
> 定义在 $\mathbb{F}$ 上的两个向量空间是同构的，当且仅当它们的维数相等

<br>

证明：
- 充分性：设 $\mathcal{V,W}$ 是同构的有限维向量空间，因此存在一个同构 $\mathscr{T}:\mathcal{V\mapsto W}$，由于这个映射是可逆的，因此它是一个双射，根据命题 3.2-5 和命题 3.2-6 可知 $\dim\mathcal{V}=\dim\mathcal{W}$；
- 必要性：考虑 $\mathcal{V,W}$ 是维数相同的两个向量空间，设 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基，设 $\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$ 是 $\mathcal{W}$ 的基，令 $\mathscr{T}\in\mathcal{L(V,W)}$，其定义为

    $$
        \mathscr{T}(c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n})=c_1\boldsymbol{w_n}+\cdots+c_n\boldsymbol{w_n}
    $$

    由于 $\forall\boldsymbol{v}\in\mathcal{V}$ 都有 $\boldsymbol{v}=\text{span}(\boldsymbol{v_1},\cdots,\boldsymbol{v_n})$，因此可以知道这样的线性映射是良好定义的（即定义域内所有元素都被映射了）。同时由于 $\forall\boldsymbol{w}\in\mathcal{W}$ 都有 $\boldsymbol{w}=\text{span}(\boldsymbol{w_1}+\cdots+\boldsymbol{w_n})$，因此 $\mathscr{T}$ 是一个满射。由于 $\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$ 线性无关，因此 $\text{null}\mathscr{T}=\{0\}$，于是 $\mathscr{T}$ 是一个单射。

综上所述，我们得到了同构的向量空间的维数相同的结论。$\square$

<br>

我们根据以上命题给出下列结论：

<br>

> **命题 3.4-4 $\mathcal{L(V,W)}$ 与 $\mathbb{F}^{m,n}$ 同构**
>
> 设 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基，$\boldsymbol{w_1},\cdots,\boldsymbol{w_n}$ 是 $\mathcal{W}$ 的基，则 $\mathcal{M}$ 是 $\mathcal{L(V,W)}$ 和 $\mathbb{F}^{m,n}$ 之间的同构。即我们有 $\dim\mathcal{L(V,W)}=(\dim\mathcal{V})(\dim\mathcal{W})$

<br>

由于我们已经知道了 $\mathcal{M}$ 是一个线性映射，我们只要说明它的可逆性，即证明它是一个双射：
- 单射：如果 $\mathscr{T}\in\mathcal{L(V,W)}$ 且 $\mathcal{M}(\mathscr{T})=\mathbf{0}$，则对于任意 $k=1,\cdots,n$ 都有 $\mathscr{T}(\boldsymbol{v_k})=\boldsymbol{0}$，由于 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是一组基，于是我们可以知道 $\mathscr{T}=0$，因此 $\text{null}(\mathcal{M})=\{0\}$；
- 满射：考虑 $\mathbf{A}\in\mathbb{F}^{m,n}$，令 $\mathscr{T}:\mathcal{V\mapsto W}$ 且定义为

    $$
        \mathscr{T}(\boldsymbol{v_k})=\sum_{j=1}^mA_{j,k}\boldsymbol{w_j},\; k=1,\cdots,n
    $$

    则 $\mathcal{M}(\mathscr{T})=\mathbf{A}$，因此 $\text{range}\mathcal{M}=\mathbb{F}^{m,n}$，故 $\mathcal{M}$ 是一个满射。

综上所述，$\mathcal{M}$ 是一个可逆的线性映射，并且是 $\mathcal{L(V,W)}$ 与 $\mathbb{F}^{m,n}$ 之间的同构。

<br>

> **定义 3.4-3 向量的矩阵**
>
> 设 $\boldsymbol{v}\in\mathcal{V}$，设 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基，则向量 $\boldsymbol{v}$ 的以该基表示的矩阵是一个 $n\times 1$ 矩阵：
>
> $$
    \mathcal{M}(\boldsymbol{v})=\begin{pmatrix}
        c_1\\ \vdots \\ c_n
    \end{pmatrix}
>   $$
>
> 其中 $c_1,\cdots,c_n$ 满足 $\boldsymbol{v}=c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}$

<br>

根据以上定义，我们很容易知道以下结论：设线性映射 $\mathscr{T}\in\mathcal{L(V,W)}$，且 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基，$\boldsymbol{w_1},\cdots,\boldsymbol{w_m}$ 是 $\mathcal{W}$ 的基，则有

$$
    \mathcal{M}(\mathscr{T})_{.,k}=\mathcal{M}(\mathscr{T}(\boldsymbol{v_k}))
$$

<br>

> **命题 3.4-5 线性映射的矩阵与向量矩阵的乘积**
>
> 设 $\mathscr{T}\in\mathcal{L(V,W)}$ 与 $\boldsymbol{v}\in\mathcal{V}$，则有 $\mathcal{M}(\mathscr{T}(\boldsymbol{v}))=\mathcal{M}(\mathscr{T})\mathcal{M}(\boldsymbol{v})$

<br>

证明：设 $\boldsymbol{v_1},\cdots,\boldsymbol{v_n}$ 是 $\mathcal{V}$ 的基，$\boldsymbol{w_1},\cdots,\boldsymbol{w_m}$ 是 $\mathcal{W}$ 的基。设 $\boldsymbol{v}=a_1\boldsymbol{v_1}+\cdots+a_n\boldsymbol{v_n}$，其中 $a_1,\cdots,a_n\in\mathbb{F}$，则

$$
    \mathscr{T}(\boldsymbol{v})=c_1\mathscr{T}(\boldsymbol{v_1})+\cdots+c_n\mathscr{T}(\boldsymbol{v_n})
$$

故可以得到

$$
    \begin{aligned}
        \mathcal{M}(\mathscr{T}(\boldsymbol{v}))&=c_1\mathcal{M}(\mathscr{T}(\boldsymbol{v_1}))+\cdots+c_n\mathcal{M}(\mathscr{T}(\boldsymbol{v_n}))\\
        &=c_1\mathcal{M}(\mathscr{T})_{.,1}+\cdots+c_n\mathcal{M}(\mathscr{T})_{.,n}\\
        &=\mathcal{M}(\mathscr{T})\mathcal{M}(\boldsymbol{v})
    \end{aligned}
$$

证毕。$\square$

<br>

> **定义 3.4-4 线性算子**
>
> 一个从某个向量空间到它自身的线性映射称为线性算子（operator），用记号 $\mathcal{L(V)}$ 表示线性算子 $\mathcal{L(V,V)}$

<br>

我们会对线性算子这种特殊的线性映射的可逆性感兴趣，接下来的命题揭示了对于有限维向量空间上的线性算子，单射和满射是等价的。

<br>

> **命题 3.4-6 有限维向量空间上的线性算子的单射和满射等价**
>
> 设 $\mathcal{V}$ 是有限维向量空间，设 $\mathscr{O}$ 是 $\mathcal{V}$ 上的线性算子，则以下命题等价：
> - （a）：$\mathscr{O}$ 是可逆的；
> - （b）：$\mathscr{O}$ 是单射；
> - （c）：$\mathscr{O}$ 是满射。

<br>

证明：使用等价证明的循环法
- （a）推导出（b）是显然的，线性算子可逆意味着线性算子是双射；
- （b）推导（c）：由于 $\text{null}\mathscr{O}=\{0\}$，因此

    $$
        \dim\text{range}\mathscr{O}=\dim\mathcal{V}-\dim\text{null}\mathscr{O}=\dim\mathcal{V}
    $$

    因此 $\text{range}\mathscr{O}=\mathcal{V}$，故 $\mathscr{O}$ 是双射，（b）可以推导出（c）；

- （c）推导（a）：同样的方法可以得到 $\dim\text{null}\mathscr{O}=0$，这样又可以推出 $\mathscr{O}$ 是一个单射，即其是一个双射，可逆。

证毕。$\square$

该命题可以用于证明一些结论，例如我们可以证明对于任意多项式 $q(x)\in\mathcal{P}(\mathbb{R})$，都存在多项式 $p(x)\in\mathcal{P}(\mathbb{R})$ 使得

$$
    q(x)=\left[(ax^2+bx+c)p(x)\right]''
$$

由于命题 3.4-6 不适用于无限维向量空间，因此我们不能对 $\mathcal{P}(\mathbb{R})$ 进行分析，但是我们知道多项式 $q(x)$ 一定有次数 $m$，即 $q(x)\in\mathcal{P}_m(\mathbb{R})$，因此我们定义线性算子 $\mathscr{Q}:\mathcal{P}_m(\mathbb{R})\mapsto\mathcal{P}_m(\mathbb{R})$：

$$
    \mathscr{Q}(p(x))=\left[(ax^2+bx+c)p(x)\right]''
$$

由于多项式 $(ax^2+bx+c)p(x)$ 的次数为 $m+2$，而 $\left[(ax^2+bx+c)p(x)\right]''$ 的次数为 $m$，因此线性算子 $\mathscr{Q}$ 是定义良好的。我们知道使得 $\mathscr{Q}(p(x))=0$ 的解只有 $p(x)=0$，因此 $\text{null}\mathscr{Q}=\{0\}$，这说明 $\mathscr{Q}$ 是一个单射。根据命题 3.4-6 知线性算子 $\mathscr{Q}$ 是满射，我们完成了证明。

<br>

### 3.5 向量空间的乘积和商

<br>

#### 3.5.1 向量空间的乘积

<br>

> **定义 3.5-1 向量空间的乘积**
>
> 考虑 $\mathcal{V}_1,\cdots,\mathcal{V}_m$ 是定义在 $\mathbb{F}$ 上的向量空间，则它们的乘积（product）定义为：
>
> $$
    \mathcal{V}_1\times\cdots\times\mathcal{V}_m=\{(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m):\boldsymbol{v}_1\in\mathcal{V}_1,\cdots,\boldsymbol{v}_m\in\mathcal{V}_m\}
>   $$
>
> 乘积 $\mathcal{V}_1\times\cdots\times\mathcal{V}_m$ 上的加法定义为：
>
> $$
    (\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m)+(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m)=(\boldsymbol{u}_1+\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m+\boldsymbol{u}_m)
>   $$
>
> 乘积 $\mathcal{V}_1\times\cdots\times\mathcal{V}_m$ 上的标量乘法定义为：
>
> $$
    \lambda(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m)=(\lambda\boldsymbol{v}_1,\cdots,\lambda\boldsymbol{v}_m)
>   $$

<br>

向量空间的乘积与集合的 Cartesian 积类似，由于集合的 Cartesian 积还是集合，我们自然会考虑向量空间的乘积是否也是向量空间（当然向量空间是满足加法和标量乘法封闭的集合，自然不能这么类比，但这也确实是我看待以下命题的动机）。

<br>

> **命题 3.5-1 向量空间的乘积仍然是向量空间**
>
> 设 $\mathcal{V}_1,\cdots,\mathcal{V}_m$ 是定义在 $\mathbb{F}$ 上的向量空间，则 $\mathcal{V}_1\times\cdots\times\mathcal{V}_m$ 也是定义在 $\mathbb{F}$ 上的向量空间

<br>

证明：
- 对任意向量 $\boldsymbol{u}_i,\boldsymbol{v}_i\in\mathcal{V}_i$，都有 $\boldsymbol{u}_i+\boldsymbol{v}_i\in\mathcal{V}_i$，因此

    $$
        (\boldsymbol{u}_1+\boldsymbol{v}_1,\cdots,\boldsymbol{u}_m+\boldsymbol{v}_m)\in\mathcal{V}_1\times\cdots\times\mathcal{V}_m
    $$

    向量空间的乘积对加法封闭；
- 对任意向量 $\boldsymbol{v}_i\in\mathcal{V}_i$ 与 $\lambda\in\mathbb{F}$ 都有 $\lambda\boldsymbol{v}_i\in\mathcal{V}_i$，因此

    $$
        (\lambda\boldsymbol{v}_1,\cdots,\lambda\boldsymbol{v}_m)\in\mathcal{V}_1\times\cdots\times\mathcal{V}_m
    $$

    向量空间的乘积对标量乘法封闭；
- 存在 $0=(\boldsymbol{0},\cdots,\boldsymbol{0})\in\mathcal{V}_1\times\cdots\times\mathcal{V}_m$。

综上所述，向量空间的乘积依然是向量空间。$\square$

很有意思的是，从集合对象的角度来说，$\mathbb{R}^m\times\mathbb{R}^n\neq\mathbb{R}^{m+n}$，但是这两个向量空间是同构的，所以有些人会将它们看作是相等的。

<br>

> **命题 3.5-2 向量空间的乘积的维数**
>
> 设 $\mathcal{V}_1,\cdots,\mathcal{V}_m$ 是有限维向量空间，它们的乘积也是有限维的，并且
>
> $$
    \dim(\mathcal{V}_1\times\cdots\times\mathcal{V}_m)=\dim\mathcal{V}_1+\cdots+\dim\mathcal{V}_m
>   $$

<br>

证明：对于每个向量空间 $\mathcal{V}_j$ 取它的基 $\boldsymbol{v}_{j1},\cdots,\boldsymbol{v}_{jk}$，其中 $k=\dim\mathcal{V}_j$，取其余向量空间中的 $\boldsymbol{0}$，构造出新的向量：

$$
    (\boldsymbol{0}_1,\boldsymbol{0}_2,\cdots,\boldsymbol{v}_{ji},\boldsymbol{0}_{j+1},\cdots,\boldsymbol{0}_m)
$$

其中 $1\leq i\leq\dim\mathcal{V}_j$，于是总共可以构造出 $\dim\mathcal{V}_1+\cdots+\dim\mathcal{V}_m$ 个新的向量，这些向量恰好是 $\mathcal{V}_1\times\cdots\times\mathcal{V}_m$ 的标准基，于是命题成立。

在第一章介绍了向量空间子空间的和与直和，并且我们知道了子空间的和仍然是子空间，根据刚才的命题，我们还想探讨下子空间的乘积与子空间的和之间的关系。

<br>

> **命题 3.5-3 子空间的乘积与直和**
>
> 设 $\mathcal{U}_1,\cdots,\mathcal{U}_m$ 是有限维向量空间 $\mathcal{V}$ 的子空间，定义线性映射 $\Gamma$ 为 $\Gamma:\mathcal{U}_1\times\cdots\times\mathcal{U}_m\mapsto\mathcal{U}_1+\cdots+\mathcal{U}_m$，满足
>
> $$
    \Gamma(\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m)=\boldsymbol{u}_1+\cdots+\boldsymbol{u}_m
>   $$
>
> $\mathcal{U}_1+\cdots+\mathcal{U}_m$ 是直和当且仅当 $\Gamma$ 是单射

<br>

证明：
- 充分性：当 $\mathcal{U}_1+\cdots+\mathcal{U}_m$ 是直和时，意味着 $\boldsymbol{0}$ 的和形式为 $\boldsymbol{0}_1+\cdots+\boldsymbol{0}_m$，即 $\boldsymbol{u}_i=\boldsymbol{0}_i$，用零空间的来表示就是

    $$
        \text{null}\;\Gamma=\{\boldsymbol{0}\}
    $$

    于是 $\Gamma$ 是单射；
- 必要性：单射意味着零空间只有 $\boldsymbol{0}$ 一个元素，即意味着 $\boldsymbol{0}$ 的和形式为 $\boldsymbol{0}_1+\cdots+\boldsymbol{0}_m$，则 $\mathcal{U}_1+\cdots+\mathcal{U}_m$ 为直和。

证毕。$\square$

$\Gamma$ 很明显是一个满射，$\text{range}\;\Gamma=\mathcal{U}_1+\cdots+\mathcal{U}_m$，那么 $\Gamma$ 是可逆的，根据线性映射基础定理可知 $\mathcal{U}_1\times\cdots\times\mathcal{U}_m$ 与 $\mathcal{U}_1+\cdots+\mathcal{U}_m$ 的维数是相等的。那么我们很快就可以给出下面这个结论：

<br>

> **命题 3.5-4 直和的另一种判断方式**
>
> 设 $\mathcal{U}_1,\cdots,\mathcal{U}_m$ 是有限维向量空间 $\mathcal{V}$ 的子空间，则 $\mathcal{U}_1+\cdots+\mathcal{U}_m$ 是直和当且仅当
>
> $$
    \dim(\mathcal{U}_1+\cdots+\mathcal{U}_m)=\dim\mathcal{U}_1+\cdots+\dim\mathcal{U}_m
>   $$

<br>

#### 3.5.2 向量空间的商

<br>

> **定义 3.5-2 向量和向量空间的加法**
>
> 设向量 $\boldsymbol{v}\in\mathcal{V}$ 和子空间 $\mathcal{U}\subseteq\mathcal{V}$，则向量和向量空间的和 $\boldsymbol{v}+\mathcal{U}$ 定义为
>
> $$
    \boldsymbol{v}+\mathcal{U}=\{\boldsymbol{v}+\boldsymbol{u}:\boldsymbol{u}\in\mathcal{U}\}
>   $$
>
> 这样的和 $\boldsymbol{v}+\mathcal{U}$ 称为向量空间 $\mathcal{V}$ 的**仿射子集**（affine subset），并且称它**平行**（parallel）于子空间 $\mathcal{U}$

<br>

> **定义 3.5-3 商空间**
>
> 设 $\mathcal{U}$ 是向量空间 $\mathcal{V}$ 的子空间，则**商空间**（quotient space）$\mathcal{V}/\mathcal{U}$ 是所有平行于 $\mathcal{U}$ 的 $\mathcal{V}$ 的仿射子集构成的集合，即
>
> $$
    \mathcal{V}/\mathcal{U}=\{\boldsymbol{v}+\mathcal{U}:\boldsymbol{v}\in\mathcal{V}\}
>   $$

<br>

我们可以从 $\mathbb{R}^2$ 理解商空间的概念，设

$$
    \mathcal{U}=\{(x,2x)\in\mathbb{R}^2:x\in\mathbb{R}\}
$$

则商空间 $\mathbb{R}^2/\mathcal{U}$ 是二维 Cartesian 平面中所有斜率为 $2$ 的直线。

接下来将要说明商空间也是一个向量空间，在此之前我们先给出一个很明显的命题：

<br>

> **命题 3.5-5 两个平行于同一子空间的仿射子集的关系**
>
> 两个平行于同一子空间的仿射子集要么相等，要么没有交集。设 $\mathcal{U}$ 是向量空间 $\mathcal{V}$ 的子空间，设向量 $\boldsymbol{v},\boldsymbol{w}\in\mathcal{V}$，则下列命题等价：
> - （a）$\boldsymbol{v}-\boldsymbol{w}\in\mathcal{U}$
> - （b）$\boldsymbol{v}+\mathcal{U}=\boldsymbol{w}+\mathcal{U}$
> - （c）$(\boldsymbol{v}+\mathcal{U})\cap(\boldsymbol{w}+\mathcal{U})\neq\emptyset$

<br>

证明：
- （a）推出（b）：设 $\boldsymbol{u}\in\mathcal{U}$，则

    $$
        \boldsymbol{v}+\boldsymbol{u}=\boldsymbol{w}+((\boldsymbol{v}-\boldsymbol{w})+\boldsymbol{u})
    $$

    因为 $\boldsymbol{v}-\boldsymbol{w},\boldsymbol{u}\in\mathcal{U}$，则 $(\boldsymbol{v}-\boldsymbol{w})+\boldsymbol{u}\in\mathcal{U}$，因此 $\boldsymbol{v}+\boldsymbol{u}\in\boldsymbol{w}+\mathcal{U}$，于是 $\boldsymbol{v}+\mathcal{U}\subseteq\boldsymbol{w}+\mathcal{U}$，同理我们也可以得到 $\boldsymbol{w}+\mathcal{U}\subseteq\boldsymbol{v}+\mathcal{U}$，于是可以得到 $\boldsymbol{v}+\mathcal{U}=\boldsymbol{w}+\mathcal{U}$；
- （b）推出（c）：当 $\boldsymbol{v}+\mathcal{U}=\boldsymbol{w}+\mathcal{U}$ 时，很明显 $\boldsymbol{v}+\mathcal{U}\neq\emptyset$，因为仿射子集中肯定存在 $\boldsymbol{v}$ 这个元素，则

    $$
        (\boldsymbol{v}+\mathcal{U})\cap(\boldsymbol{w}+\mathcal{U})=\boldsymbol{v}+\mathcal{U}\neq\emptyset
    $$

- （c）推出（a）：当 $(\boldsymbol{v}+\mathcal{U})\cap(\boldsymbol{w}+\mathcal{U})\neq\emptyset$ 时，存在元素 $\boldsymbol{x}\in\boldsymbol{v}+\mathcal{U}$ 且 $\boldsymbol{x}\in\boldsymbol{w}+\mathcal{U}$，即存在 $\boldsymbol{u}_1,\boldsymbol{u}_2$ 使得

    $$
        \boldsymbol{x}=\boldsymbol{v}+\boldsymbol{u}_1=\boldsymbol{w}+\boldsymbol{u}_2
    $$

    我们将两个式子变形得到：

    $$
       \boldsymbol{v}-\boldsymbol{w}=\boldsymbol{u}_2-\boldsymbol{u}_1
    $$

    由于 $\mathcal{U}$ 对加法与标量乘法封闭，因此 $\boldsymbol{u}_1+(-1)\boldsymbol{u}_2\in\mathcal{U}$，故 $\boldsymbol{v}-\boldsymbol{w}\in\mathcal{U}$。

证毕。$\square$

可以从二维 Cartesian 平面中理解这个命题。

<br>

> **定义 3.5-4 商空间上的加法和标量乘法**
>
> 设 $\mathcal{U}$ 是 $\mathcal{V}$ 的子空间，则 $\mathcal{V}/\mathcal{U}$ 上的加法和标量乘法定义为：
>
> $$
    \begin{aligned}
        (\boldsymbol{v}+\mathcal{U})+(\boldsymbol{w}+\mathcal{U})&=(\boldsymbol{v}+\boldsymbol{w})+\mathcal{U}\\
        \lambda(\boldsymbol{v}+\mathcal{U})&=(\lambda\boldsymbol{v})+\mathcal{U}
    \end{aligned}
>   $$
>
> $\boldsymbol{v},\boldsymbol{w}\in\mathcal{V}，\lambda\in\mathbb{F}$

<br>

> **命题 3.5-6 商空间是向量空间**
>
> 设 $\mathcal{U}$ 是 $\mathcal{V}$ 的子空间，则商空间 $\mathcal{V}/\mathcal{U}$ 是向量空间

<br>

证明：首先我们要证明刚才定义的商空间上的加法和标量乘法是良好的。
- 加法：设 $\boldsymbol{v},\boldsymbol{w},\boldsymbol{v}',\boldsymbol{w}'\in\mathcal{V}$，它们使得 $\boldsymbol{v}+\mathcal{U}=\boldsymbol{v}'+\mathcal{U}$ 和 $\boldsymbol{w}+\mathcal{U}=\boldsymbol{w}'+\mathcal{U}$ 成立，根据命题 3.5-5 可知 $\boldsymbol{v}-\boldsymbol{v}'\in\mathcal{U}$，同理 $\boldsymbol{w}-\boldsymbol{w}'\in\mathcal{U}$。因为 $\mathcal{U}$ 也是向量空间，加法封闭，于是

    $$
        (\boldsymbol{v}+\boldsymbol{w})-(\boldsymbol{v}'+\boldsymbol{w}')\in\mathcal{U}
    $$

    根据命题 3.5-5 可知 $\boldsymbol{v}+\boldsymbol{w}=\boldsymbol{v}'+\boldsymbol{w}'$，因此

    $$
        (\boldsymbol{v}+\boldsymbol{w})+\mathcal{U}=(\boldsymbol{v}'+\boldsymbol{w}')+\mathcal{U}
    $$

    据此可以知道商空间上的加法是定义良好的；
- 标量乘法：设 $\lambda\in\mathbb{F}$，$\boldsymbol{v},\boldsymbol{v}'\in\mathcal{V}$，它们使得 $\boldsymbol{v}+\mathcal{U}=\boldsymbol{v}'+\mathcal{U}$，根据命题 3.5-5 可知 $\boldsymbol{v}-\boldsymbol{v}'\in\mathcal{U}$，因为 $\mathcal{U}$ 是向量空间，对标量乘法封闭，因此 $\lambda(\boldsymbol{v}-\boldsymbol{v}')\in\mathcal{U}$，即 $\lambda\boldsymbol{v}-\lambda\boldsymbol{v}'\in\mathcal{U}$，根据命题 3.5-5 可知

    $$
        (\lambda\boldsymbol{v})+\mathcal{U}=(\lambda\boldsymbol{u}')+\mathcal{U}
    $$

    据此可以知道商空间上的标量乘法是定义良好的。

商空间中的零向量是 $\boldsymbol{0}$，其中 $\boldsymbol{v}=-\boldsymbol{w}$。由商空间上的加法和标量乘法的定义可知商空间对加法和标量乘法封闭，因此商空间也是向量空间。$\square$

<br>

> **定义 3.5-5 商映射**
>
> 设 $\mathcal{U}$ 是 $\mathcal{V}$ 的子空间，则商映射（quotient map）$\pi$ 定义为线性映射 $\pi:\mathcal{V}\mapsto\mathcal{V}/\mathcal{U}$，具体定义是对任意的向量 $\boldsymbol{v}\in\mathcal{V}$，有
>
> $$
    \pi(\boldsymbol{v})=\boldsymbol{v}+\mathcal{U}
>   $$

<br>

> **命题 3.5-7 商空间的维数**
>
> 设 $\mathcal{V}$ 是有限维的向量空间，$\mathcal{U}$ 是 $\mathcal{V}$ 的子空间，则
>
> $$
    \dim\mathcal{V}/\mathcal{U}=\dim\mathcal{V}-\dim\mathcal{U}
>   $$

<br>

我们定义商映射就是为了给出该命题的证明（在这里我的动机是这样的）：设 $\pi$ 是从 $\mathcal{V}$ 到 $\mathcal{V}/\mathcal{U}$ 的商映射，根据零空间的定义：

$$
    \begin{aligned}
        \text{null}\;\pi&=\{\boldsymbol{v}\in\mathcal{V}:\pi(\boldsymbol{v})=\boldsymbol{0}\}\\
        &=\{\boldsymbol{v}\in\mathcal{V}:\boldsymbol{v}+\boldsymbol{w}=\boldsymbol{0},\boldsymbol{w}\in\mathcal{U}\}\\
        &=\{\boldsymbol{v}\in\mathcal{V}:\boldsymbol{v}=-\boldsymbol{w}\}\\
        &=\mathcal{U}
    \end{aligned}
$$

由于 $\text{range}\;\pi=\mathcal{V}/\mathcal{U}$，因此根据线性映射基础定理可知

$$
    \dim\mathcal{V}=\dim\text{null}\;\pi+\dim\text{range}\;\pi=\dim\mathcal{W}+\dim\mathcal{V}/\mathcal{U}
$$

<br>

> **定义 3.5-6 $\tilde{\mathscr{T}}$**
>
> 设线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，定义 $\tilde{\mathscr{T}}:\mathcal{V}/(\text{null}\mathscr{T})\mapsto\mathcal{W}$ 为
>
> $$
    \tilde{\mathscr{T}}(\boldsymbol{v}+\text{null}\mathscr{T})=\mathscr{T}(\boldsymbol{v})
>   $$

<br>

说明 $\tilde{\mathscr{T}}$ 良好定义的过程如下：设 $\boldsymbol{u},\boldsymbol{v}\in\mathcal{V}$，并且满足 $\boldsymbol{u}+\text{null}\mathscr{T}=\boldsymbol{v}+\text{null}\mathscr{T}$，根据命题 3.5-5 可知 $\boldsymbol{u}-\boldsymbol{v}\in\text{null}\mathscr{T}$，则 $\mathscr{T}(\boldsymbol{u}-\boldsymbol{v})=\boldsymbol{0}$，故 $\mathscr{T}(\boldsymbol{u})=\mathscr{T}(\boldsymbol{v})$。因此 $\tilde{\mathscr{T}}$ 是定义良好的。

<br>

> **命题 3.5-8 $\tilde{\mathscr{T}}$ 的性质**
> 
> 设 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则 $\tilde{\mathscr{T}}$ 具有以下性质：
> 
> - $\tilde{\mathscr{T}}$ 是从 $\mathcal{V}/(\text{null}\mathscr{T})$ 到 $\mathcal{W}$ 的线性映射；
> - $\tilde{\mathscr{T}}$ 是单射；
> - $\text{range}\tilde{\mathscr{T}}=\text{range}\mathscr{T}$；
> - $\mathcal{V}/\text{null}\mathscr{T}$ 与 $\text{range}\mathscr{T}$ 是同构的。

<br>

- 性质1：证明是线性映射的方法是证明其满足可加性和齐次性。设 $\boldsymbol{v}_1,\boldsymbol{v}_2\in\mathcal{V}/\text{null}\mathscr{T}$，则

    $$
        \begin{aligned}
            \tilde{\mathscr{T}}((\boldsymbol{v}_1+\text{null}\mathscr{T})+(\boldsymbol{v}_2+\text{null}\mathscr{T}))&=\tilde{\mathscr{T}}((\boldsymbol{v}_1+\boldsymbol{v}_2)+\text{null}\mathscr{T})\\
            &=\mathscr{T}(\boldsymbol{v}_1+\boldsymbol{v}_2)\\
            &=\mathscr{T}(\boldsymbol{v}_1)+\mathscr{T}(\boldsymbol{v}_2)\\
            &=\tilde{\mathscr{T}}(\boldsymbol{v}_1+\text{null}\mathscr{T})+\tilde{\mathscr{T}}(\boldsymbol{v}_2+\text{null}\mathscr{T})
        \end{aligned}
    $$

    故其满足可加性，接着证明其满足齐次性，设 $\lambda\in\mathbb{F},\boldsymbol{v}\in\mathcal{V}/\text{null}\mathscr{T}$，则

    $$
        \begin{aligned}
            \tilde{\mathscr{T}}(\lambda(\boldsymbol{v}+\text{null}\mathscr{T}))&=\tilde{\mathscr{T}}(\lambda\boldsymbol{v}+\text{null}\mathscr{T})\\
            &=\mathscr{T}(\lambda\boldsymbol{v})\\
            &=\lambda\mathscr{T}(\boldsymbol{v})\\
            &=\lambda\tilde{\mathscr{T}}(\boldsymbol{v}+\text{null}\mathscr{T})
        \end{aligned}
    $$

    故其满足齐次性，这说明 $\tilde{\mathscr{T}}$ 是一个线性映射；
- 性质2：要说明一个线性映射是单射，只需要证明其零空间只有元素零向量。设 $\boldsymbol{v}\in\mathcal{V}$，其满足 $\tilde{\mathscr{T}}(\boldsymbol{v}+\text{null}\mathscr{T})=\boldsymbol{0}$，注意到这等价于 $\mathscr{T}(\boldsymbol{v})=\boldsymbol{0}$，则 $\boldsymbol{v}\in\text{null}\mathscr{T}$，根据命题 3.5-5 可知 $\boldsymbol{v}+\text{null}\mathscr{T}=\boldsymbol{0}+\text{null}\mathscr{T}$，故

    $$
        \text{null}\tilde{\mathscr{T}}=\{\boldsymbol{0}\}
    $$

    因此 $\tilde{\mathscr{T}}$ 是单射；
- 性质3：根据定义 3.5-6，这个性质是显然的；
- 性质4：由于 $\tilde{\mathscr{T}}$ 完全可以看作 $\tilde{\mathscr{T}}:\mathcal{V}/\text{null}\mathscr{T}\mapsto\text{range}\tilde{\mathscr{T}}$，这样的 $\tilde{\mathscr{T}}$ 是双射，这说明在 $\mathcal{V}/\text{null}\mathscr{T}$ 与 $\text{range}\tilde{\mathscr{T}}$ 之间存在可逆的线性映射，即 $\mathcal{V}/\text{null}\mathscr{T}$ 与 $\text{range}\mathscr{T}=\text{range}\tilde{\mathscr{T}}$ 是同构的。

证毕。$\square$

<br>

### 3.6 对偶

<br>

> **定义 3.6-1 线性泛函**
>
> 一个在向量空间 $\mathcal{V}$ 上的线性泛函（linear functional）是一个从 $\mathcal{V}$ 到数域 $\mathbb{F}$ 的线性映射，即一个线性泛函是 $\mathcal{L}(\mathcal{V},\mathbb{F})$ 的一个元素

<br>

线性泛函的例子有很多，例如设 $(c_1,\cdots,c_n)\in\mathbb{F}^n$，令 $\varphi:\mathbb{F}^n\mapsto\mathbb{F}$ 定义为

$$
    \varphi(x_1,\cdots,x_n)=c_1x_1+\cdots+c_nx_n
$$

这样的线性映射就是一个线性泛函。再比如设线性映射 $\varphi:\mathcal{P}(\mathbb{R})\mapsto\mathbb{R}$ 定义为

$$
    \varphi(p)=\int_0^1p(x)\mathrm{d}x,\quad p\in\mathcal{P}(\mathbb{R})
$$

这也明显是一个线性泛函。

<br>

> **定义 3.6-2 对偶空间**
>
> 向量空间 $\mathcal{V}$ 的对偶空间（dual space），记作 $\mathcal{V}'$，是所有在 $\mathcal{V}$ 上的线性泛函构成的集合，即 $\mathcal{V}'=\mathcal{L}(\mathcal{V},\mathbb{F})$

<br>

根据命题 3.4-4 可知，$\dim\mathcal{V}'=\dim\mathcal{V}\dim\mathbb{F}=\dim\mathcal{V}$，如果 $\mathcal{V}$ 是有限维向量空间，则 $\mathcal{V}'$ 也是有限维向量空间。

<br>

> **定义 3.6-3 对偶基**
>
> 设 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 是向量空间 $\mathcal{V}$ 的一组基，则 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 的对偶基（dual basis）是对偶空间的 $\mathcal{V}'$ 的一组元素 $\varphi_1,\cdots,\varphi_n$，每一个元素 $\varphi_j$ 都是一个线性泛函，满足
>
> $$
    \varphi_j(\boldsymbol{v}_k)=\begin{cases}
        1&k=j\\
        0&k\neq j
    \end{cases}
>   $$

<br>

根据命题 3.1-1 可知每个线性泛函 $\varphi_j$ 都是存在的，接下来要说明这一组线性泛函确实是对偶空间的一组基：

<br>

> **命题 3.6-1 对偶基是对偶空间的一组基**
>
> 设向量空间 $\mathcal{V}$ 是有限维的，则 $\mathcal{V}$ 的基的对偶基是对偶空间 $\mathcal{V}'$ 的基

<br>

证明：根据命题 2.3-3 可知，由于我们已经知道对偶空间的维数为 $n$，只要证明这组线性泛函 $\varphi_1,\cdots,\varphi_n$ 是线性无关的就可以证明它是一组基了。根据线性无关的定义（定义 2.1-6）可知，考虑 $a_1,\cdots,a_n\in\mathbb{F}$ 满足

$$
    a_1\varphi_1+\cdots+a_n\varphi_n=0
$$

注意到 $(a_1\varphi_1+\cdots+a_n\varphi_n)(\boldsymbol{v}_j)=a_j$，其中 $1\leq j\leq n$，于是要使得 $a_1\varphi_1+\cdots+a_n\varphi_n$ 是零映射，则 $a_1=\cdots=a_n=0$，于是我们知道了 $\varphi_1,\cdots,\varphi_n$ 是线性无关的，于是它是对偶空间的一组基。$\square$

<br>

> **定义 3.6-4 对偶映射**
>
> 设 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则 $\mathscr{T}$ 的对偶映射（dual map）$\mathscr{T}'\in\mathcal{L}(\mathcal{W}',\mathcal{V}')$ 定义为
>
> $$
    \mathscr{T}'(\varphi)=\varphi\circ\mathscr{T},\quad\varphi\in\mathcal{W}'
>   $$
>
> 上面的定义有些难理解，首先我们知道 $\mathscr{T}:\mathcal{V}\mapsto\mathcal{W}$，并且 $\varphi:\mathcal{W}\mapsto\mathbb{F}$，因此我们可以得到 $\varphi\circ\mathscr{T}:\mathcal{V}\mapsto\mathbb{F}$，于是我们知道 $\mathscr{T}':\mathcal{W}'\mapsto\mathcal{L}(\mathcal{V},\mathbb{F})$，因此这个定义是没有问题的

<br>

对偶映射是线性映射是容易验证的：
- 可加性：设 $\varphi,\psi\in\mathcal{W}'$，则

    $$
        \mathscr{T}'(\varphi+\psi)=(\varphi+\psi)\circ\mathscr{T}=\varphi\circ\mathscr{T}+\psi\circ\mathscr{T}=\mathscr{T}'(\varphi)+\mathscr{T}'(\psi)
    $$

- 齐次性，设 $\varphi\in\mathcal{W}',\lambda\in\mathbb{F}$，则

    $$
        \mathscr{T}'(\lambda\varphi)=(\lambda\varphi)\circ\mathscr{T}=\lambda(\varphi\circ\mathscr{T})=\lambda\mathscr{T}'(\varphi)
    $$

<br>

> **命题 3.6-2 对偶映射的代数运算**
>
> - 加法：$(\mathscr{S}+\mathscr{T})'=\mathscr{S}'+\mathscr{T}'$，对所有的 $\mathscr{S},\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$；
> - 标量乘法：$(\lambda\mathscr{T})'=\lambda\mathscr{T}'$，对所有的 $\lambda\in\mathbb{F}$ 和所有的 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$；
> - 乘法/复合：$(\mathscr{S}\circ\mathscr{T})'=\mathscr{T}'\circ\mathscr{S}'$，对所有 $\mathscr{T}\in\mathcal{L}(\mathcal{U},\mathcal{V})$ 和 $\mathscr{S}\in\mathcal{L}(\mathcal{V},\mathcal{W})$

<br>

证明：
- 加法：我们知道对任意线性泛函 $\varphi\in\mathcal{W}'$，都有

    $$
        \begin{aligned}
            (\mathscr{T}+\mathscr{S})'(\varphi)&=\varphi\circ(\mathscr{T}+\mathscr{S})\\
            &=\varphi\circ\mathscr{T}+\varphi\circ\mathscr{S}\\
            &=\mathscr{T}'(\varphi)+\mathscr{S}'(\varphi)
        \end{aligned}
    $$

    因此我们有 $(\mathscr{T}+\mathscr{S})'=\mathscr{T}'+\mathscr{S}'$；
- 标量乘法：我们知道对任意线性泛函 $\varphi\in\mathcal{W}'$，都有

    $$
        \begin{aligned}
            (\lambda\mathscr{T})'(\varphi)&=\varphi\circ(\lambda\mathscr{T})\\
            &=\lambda(\varphi\circ\mathscr{T})\\
            &=\lambda\mathscr{T}'(\varphi)
        \end{aligned}
    $$

    因此我们有 $(\lambda\mathscr{T})'=\lambda\mathscr{T}'$；
- 乘法/复合：我们知道对任意线性泛函 $\varphi\in\mathcal{W}'$，都有

    $$
        \begin{aligned}
            (\mathscr{S}\circ\mathscr{T})'(\varphi)&=\varphi\circ(\mathscr{S}\circ\mathscr{T})\\
            &=(\varphi\circ\mathscr{S})\circ\mathscr{T}\\
            &=\mathscr{T}'(\mathscr{S}'(\varphi))\\
            &=(\mathscr{T}'\circ\mathscr{S}')(\varphi)
        \end{aligned}
    $$

    注意 $\varphi:\mathcal{W}\mapsto\mathbb{F}$，$\mathscr{T}:\mathcal{U}\mapsto\mathcal{V}$，$\mathscr{S}:\mathcal{V}\mapsto\mathcal{W}$。注意到 $\varphi\circ\mathscr{S}\in\mathcal{L}(\mathcal{V},\mathbb{F})$，那么这说明 $\varphi\circ\mathscr{S}$ 是一个向量空间 $\mathcal{V}$ 上的线性泛函（所以第三个等号处是合理的）。于是根据推导我们有 $(\mathscr{S}\circ\mathscr{T})'=\mathscr{T}'\circ\mathscr{S}'$

证毕。$\square$

<br>

> **定义 3.6-5 零化子**
>
> 对于子空间 $\mathcal{U}\subset\mathcal{V}$，$\mathcal{U}$ 的零化子（annihilator）记作 $\mathcal{U}^0$，定义为
>
> $$
    \mathcal{U}^0=\{\varphi\in\mathcal{V}':\varphi(\boldsymbol{u})=\boldsymbol{0},\forall\boldsymbol{u}\in\mathcal{U}\}
>   $$

<br>

零化子是向量空间 $\mathcal{V}$ 的对偶空间中的线性泛函构成的集合，因此其是对偶空间 $\mathcal{V}'$ 的子集。就记号的完整性而言，$\mathcal{U}^0_{\mathcal{V}}$ 是更合适的记号，但是我们用 $\mathcal{U}^0$ 就已经能把事情说明白了。

举一个零化子的例子：设 $\boldsymbol{e}_1,\cdots,\boldsymbol{e}_5$ 是 $\mathbb{R}^5$ 的标准基，$\varphi_1,\cdots,\varphi_5$ 是 $(\mathbb{R}^5)'$ 的对偶基，设子空间

$$
    \mathcal{U}=\text{span}(\boldsymbol{e}_1,\boldsymbol{e}_2)=\{(x_1,x_2,0,0,0)\in\mathbb{R}^5:x_1,x_2\in\mathbb{R}\}
$$

我们可以说明该子空间的零化子是 $\mathcal{U}^0=\text{span}(\varphi_3,\varphi_4,\varphi_5)$。我们知道对偶基的定义如下，其中 $1\leq j\leq 5$：

$$
    \boldsymbol{x}=(x_1,\cdots,x_5),\quad\varphi_j(\boldsymbol{x})=x_j
$$

我们先证明 $\text{span}(\varphi_3,\varphi_4,\varphi_5)\subset\mathcal{U}^0$，设线性泛函 $\varphi\in\text{span}(\varphi_3,\varphi_4,\varphi_5)$，则 $\varphi=c_3\varphi_3+c_4\varphi_4+c_5\varphi_5$，设 $\boldsymbol{x}=(x_1,x_2,0,0,0)\in\mathcal{U}$，则

$$
    \varphi(\boldsymbol{x})=c_3\varphi_3(\boldsymbol{x})+c_4\varphi_4(\boldsymbol{x})+c_5\varphi_5(\boldsymbol{x})=0
$$

因此我们知道 $\varphi$ 是 $\mathcal{U}$ 的零化子的元素，故 $\text{span}(\varphi_3,\varphi_4,\varphi_5)\subset\mathcal{U}^0$；

我们再证明 $\mathcal{U}^0\subset\text{span}(\varphi_3,\varphi_4,\varphi_5)$，那么我们设线性泛函 $\varphi\in\mathcal{U}^0$，因为零化子是对偶空间的子集，那么零化子内的线性泛函也应当能被对偶基线性表示，即存在 $c_1,\cdots,c_5\in\mathbb{F}$ 使得

$$
    \varphi=c_1\varphi_1+\cdots+c_5\varphi_5
$$

对于向量空间 $\mathcal{U}$ 的标准基 $\boldsymbol{e}_1$，我们知道

$$
    \varphi(\boldsymbol{e}_1)=c_1\varphi_1(\boldsymbol{e}_1)+\cdots+c_5\varphi_5(\boldsymbol{e}_5)=c_1=0
$$

同理 $\varphi(\boldsymbol{e}_2)=c_2=0$，因此 $\varphi=c_3\varphi_3+c_4\varphi_4+c_5\varphi_5$，于是 $\mathcal{U}^0\in\text{span}(\varphi_3,\varphi_4,\varphi_5)$。

<br>

> **命题 3.6-3 零化子是子空间**
>
> 我们已经知道零化子是对偶空间的子集，它实际上还是一个子空间

<br>

证明：符号承上。设 $0$ 是向量空间 $\mathcal{V}$ 对偶空间中的线性泛函（它将所有向量空间中的元素都映射为 $0$），显然 $0\in\mathcal{U}^0$。我们接着说明零化子对加法和标量乘法封闭：
- 加法：设 $\varphi_1,\varphi_2\in\mathcal{U}^0$，则对任意的向量 $\boldsymbol{u}\in\mathcal{U}$ 都有

    $$
        (\varphi_1+\varphi_2)(\boldsymbol{u})=\varphi_1(\boldsymbol{u})+\varphi_2(\boldsymbol{u})=0
    $$

    因此零化子对加法封闭；
- 标量乘法：设 $\varphi\in\mathcal{U}^0$，$\lambda\in\mathbb{F}$，则对任意的向量 $\boldsymbol{u}\in\mathcal{U}$ 都有

    $$
        (\lambda\varphi)(\boldsymbol{u})=\lambda\varphi(\boldsymbol{u})=0
    $$

    因此零化子对标量乘法封闭。

综上所述，零化子是子空间。$\square$

<br>

> **命题 3.6-4 零化子的维数**
>
> 设 $\mathcal{V}$ 是有限维向量空间，$\mathcal{U}$ 是其子空间，则其零化子的维数满足以下等式：
>
> $$
    \dim\mathcal{U}^0=\dim\mathcal{V}-\dim\mathcal{U}
>   $$

<br>

证明：设恒等映射 $\mathscr{I}\in\mathcal{L}(\mathcal{U},\mathcal{V})$ 定义为 $\mathscr{I}(\boldsymbol{u})=\boldsymbol{u}$，对于所有 $\boldsymbol{u}\in\mathcal{U}$，其对偶映射 $\mathscr{I}'\in\mathcal{L}(\mathcal{V}',\mathcal{U}')$，在对偶映射上引用线性映射基础定理可知：

$$
    \dim\mathcal{V}'=\dim\text{range}\mathscr{I}'+\dim\text{null}\mathscr{I}'
$$

我们注意 $\mathscr{I}'$ 定义为 $\mathscr{I}'(\varphi)=\varphi\circ\mathscr{I}$，其中 $\varphi$ 是对偶空间 $\mathcal{V}'$ 中的线性泛函，$\varphi:\mathcal{V}\mapsto\mathbb{F}$，注意恒等映射 $\mathscr{I}:\mathcal{U}\mapsto\mathcal{V}$，因此复合后的映射 $\varphi\circ\mathscr{I}:\mathcal{U}\mapsto\mathbb{F}$，那么很清楚对偶映射 $\mathscr{I}'$ 的零空间是 $\mathcal{U}$ 的零化子：

$$
    \text{null}\mathscr{I}'=\mathcal{U}^0
$$

我们还证明过一个向量空间和其对偶空间的维数是相等的（定义 3.6-2），观察要证明的等式，可知我们还要证明 $\dim\text{range}\mathscr{I}'=\dim\mathcal{U}$。我们可以考虑证明 $\text{range}\mathscr{I}'=\mathcal{U}'$，可以看出 $\text{range}\mathscr{I}'\subseteq\mathcal{U}'$，于是我们只要证明 $\mathcal{U}'\subseteq\text{range}\mathscr{I}'$：

设线性泛函 $\varphi\in\mathcal{U}'$，我们很容易能给出下面的引理：

设有限维向量空间 $\mathcal{V}$，$\mathcal{U}$ 是其子空间，设线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{U},\mathcal{W})$，则我们可以构造出线性映射 $\mathscr{S}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，定义如下：

$$
    \mathscr{S}(\boldsymbol{u})=\begin{cases}
        \mathscr{T}(\boldsymbol{u})&\boldsymbol{u}\in\mathcal{U}\\
        0&\boldsymbol{u}\in\mathcal{V}\backslash\mathcal{U}
    \end{cases}
$$

满足 $\mathscr{T}(\boldsymbol{u})=\mathscr{S}(\boldsymbol{u})$ 对所有 $\boldsymbol{u}\in\mathcal{U}$ 成立（注意上面是反斜杠，指的是集合的差集，不是商空间）。这个引理说明定义在子空间上的线性映射可以「扩展」为完整的向量空间上的一个线性映射。

在本命题证明过程中，我们可以把线性泛函 $\varphi$「扩展」为向量空间 $\mathcal{V}$ 上的线性泛函 $\psi\in\mathcal{V}'$ 使得 $\varphi(\boldsymbol{u})=\psi(\boldsymbol{u})$，因此存在线性泛函 $\psi$ 使得

$$
    (\psi\circ\mathscr{I})(\boldsymbol{u})=\psi(\mathscr{I}(\boldsymbol{u}))=\psi(\boldsymbol{u})=\varphi(\boldsymbol{u})
$$

因此 $\varphi=\psi\circ\mathscr{I}$，故 $\varphi\in\text{range}\mathscr{I}'$，于是我们得到了 $\mathcal{U}'\subseteq\text{range}\mathscr{I}'$。综上所述，我们有了 $\mathcal{U}'=\text{range}\mathscr{I}'$，把前面的线性映射基础定理改写成下述形式：

$$
    \dim\mathcal{U}^0+\dim\mathcal{U}=\dim\mathcal{V}
$$

我们完成了证明。$\square$

<br>

> **命题 3.6-5 对偶映射的零空间**
>
> 设 $\mathcal{V},\mathcal{W}$ 是有限维向量空间，设线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则
> - （a）$\text{null}\mathscr{T}'=(\text{range}\mathscr{T})^0$
> - （b）$\dim\text{null}\mathscr{T}'=\dim\text{null}\mathscr{T}+\dim\mathcal{W}-\dim\mathcal{V}$

<br>

证明：
- （a）：这种两个集合相等的证明，通常是证明集合包含关系是双向的。我们先证明 $\text{null}\mathscr{T}'\subseteq(\text{range}\mathscr{T})^0$，那么我们先设线性泛函 $\varphi\in\text{null}\mathscr{T}'$，则 $\mathscr{T}'(\varphi)=\varphi\circ\mathscr{T}=0$，其中 $0$ 是「零线性泛函」（将所有向量映射为 $0$），则对所有的向量 $\boldsymbol{v}\in\mathcal{V}$ 都有

    $$
        (\varphi\circ\mathscr{T})(\boldsymbol{v})=\varphi(\mathscr{T}(\boldsymbol{v}))=0
    $$

    这里的 $0$ 是标量。对于向量 $\mathscr{T}(\boldsymbol{v})$，线性泛函 $\varphi$ 将其映射为了标量 $0$，因此 $\varphi$ 是向量空间 $\text{range}\mathscr{T}$ 的零化子，即 $\varphi\in(\text{range}\mathscr{T})^0$，一个方向证明完成；

    我们再证明 $(\text{range}\mathscr{T})^0\subseteq\text{null}\mathscr{T}'$。设线性泛函 $\varphi\in(\text{range}\mathscr{T})^0$，则 $\varphi(\mathscr{T}(\boldsymbol{v}))=0$，这意味着 $(\varphi\circ\mathscr{T})(\boldsymbol{v})=0$，根据定义可知 $\varphi\in\text{null}\mathscr{T}'$。

    综上所述可以得到 $\text{null}\mathscr{T}'=(\text{range}\mathscr{T})'$
- （b）：根据（a）的结论以及命题 3.6-4 可知

    $$
        \begin{aligned}
            \dim\text{null}\mathscr{T}'&=\dim(\text{range}\mathscr{T})^0\\
            &=\dim\mathcal{W}-\dim\text{range}\mathscr{T}\\
            &=\dim\mathcal{W}-(\dim\mathcal{V}-\dim\text{null}\mathscr{T})\\
            &=\dim\text{null}\mathscr{T}+\dim\mathcal{W}-\dim\mathcal{V}
        \end{aligned}
    $$

证毕。$\square$

<br>

> **命题 3.6-6 对偶映射是单射与原映射是满射等价**
>
> 设 $\mathcal{V},\mathcal{W}$ 是有限维向量空间，并且 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则 $\mathscr{T}$ 是满射当且仅当 $\mathscr{T}'$ 是单射

<br>

证明：如果线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$ 是满射，则 $\text{range}\mathscr{T}=\mathcal{W}$，这意味着

$$
    \dim\text{null}\mathscr{T}=\dim\mathcal{V}-\dim\mathcal{W}
$$

代入 3.6-5（b）可知 $\dim\text{null}\mathscr{T}'=0$，因此 $\mathscr{T}'$ 是单射，相反证明过程也是一样的。$\square$

<br>

> **命题 3.6-7 对偶映射的值域**
>
> 设 $\mathcal{V},\mathcal{W}$ 是有限维向量空间，设线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则
> - （a）$\dim\text{range}\mathscr{T}'=\dim\text{range}\mathscr{T}$
> - （b）$\text{range}\mathscr{T}'=(\text{null}\mathscr{T})^0$

<br>

证明：
- （a）：利用命题 3.6-5（b）可得

    $$
        \begin{aligned}
            \dim\text{range}\mathscr{T}'&=\dim\mathcal{W}'-\dim\text{null}\mathscr{T}'\\
            &=\dim\mathcal{W}-(\dim\text{null}\mathscr{T}+\dim\mathcal{W}-\dim\mathcal{V})\\
            &=\dim\mathcal{V}-\dim\text{null}\mathscr{T}\\
            &=\dim\text{range}\mathscr{T}
        \end{aligned}
    $$

- （b）：首先证明 $\text{range}\mathscr{T}'\subseteq(\text{null}\mathscr{T})^0$，设线性泛函 $\varphi\in\text{range}\mathscr{T}'$，则存在线性泛函 $\psi\in\mathcal{W}'$ 使得 $\varphi=\psi\circ\mathscr{T}$，设 $\boldsymbol{v}\in\text{null}\mathscr{T}$，则

    $$
        \varphi(\boldsymbol{v})=(\psi\circ\mathscr{T})(\boldsymbol{v})=\psi(\mathscr{T}(\boldsymbol{v}))=\psi(0)=0
    $$

    因此 $\varphi\in(\text{null}\mathscr{T})^0$，因此一个方向证明完成；

    我们将通过说明 $\dim\text{range}\mathscr{T}'=\dim(\text{null}\mathscr{T})^0$ 来说明两者相等（注意到 $\text{null}\mathscr{T}\subseteq\mathcal{V}）$：

    $$
        \begin{aligned}
            \dim\text{range}\mathscr{T}'&=\dim\text{range}\mathscr{T}\\
            &=\dim\mathcal{V}-\dim\text{null}\mathscr{T}\\
            &=\dim(\text{null}\mathscr{T})^0
        \end{aligned}
    $$

    于是我们知道两个向量空间具有包含关系且维数相等，因此两者相等。

证毕。$\square$

<br>

> **命题 3.6-8 对偶映射是满射与原映射是单射等价**
>
> 设 $\mathcal{V},\mathcal{W}$ 是有限维向量空间，并且 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则 $\mathscr{T}$ 是单射当且仅当 $\mathscr{T}'$ 是满射

<br>

证明：如果线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$ 是单射，则 $\dim\text{null}\mathscr{T}=0$，根据命题 3.6-7（b）可知

$$
    \dim\text{range}\mathscr{T}'=\dim\mathcal{V}=\dim\mathcal{V}'
$$

因此 $\text{range}\mathscr{T}'=\mathcal{V}'$，故 $\mathscr{T}'$ 是满射，相反证明过程也是一样的。$\square$

<br>

### 3.7 矩阵的转置与秩

<br>

> **定义 3.7-1 矩阵的转置**
>
> 一个矩阵 $\mathbf{A}$ 的转置（transpose）记为 $\mathbf{A}^{\mathrm{T}}$，定义为矩阵 $\mathbf{A}$ 的行与列互换得到的新矩阵。若 $\mathbf{A}$ 是一个 $m\times n$ 矩阵，则其转置 $\mathbf{A}^{\mathrm{T}}$ 是一个 $n\times m$ 矩阵，并且
>
> $$
    (A^{\mathrm{T}})_{k,j}=A_{j,k}
>   $$

<br>

> **命题 3.7-1 矩阵转置的运算性质**
>
> 设 $\mathbf{A},\mathbf{B}$ 是 $m\times n$ 矩阵，$\mathbf{C}$ 是 $n\times p$ 矩阵，则有以下矩阵转置的运算性质：
> - （a）$(\mathbf{A}+\mathbf{B})^{\mathrm{T}}=\mathbf{A}^{\mathrm{T}}+\mathbf{B}^{\mathrm{T}}$
> - （b）$(\lambda\mathbf{A})^{\mathrm{T}}=\lambda\mathbf{A}^{\mathrm{T}}$，对于任意 $\lambda\in\mathbb{F}$
> - （c）$(\mathbf{A}\mathbf{C})^{\mathrm{T}}=\mathbf{C}^{\mathrm{T}}\mathbf{A}^{\mathrm{T}}$

<br>

证明：
- （a）：根据定义

    $$
        (A+B)^{\mathrm{T}}_{k,j}=(A+B)_{j,k}=A^{\mathrm{T}}_{k,j}+B^{\mathrm{T}}_{k,j}
    $$

    因此 $(\mathbf{A}+\mathbf{B})^{\mathrm{T}}=\mathbf{A}^{\mathrm{T}}+\mathbf{B}^{\mathrm{T}}$ 成立；
- （b）：根据定义

    $$
        (\lambda A)^{\mathrm{T}}_{k,j}=(\lambda A)_{j,k}=\lambda A_{j,k}=\lambda A^{\mathrm{T}}_{k,j}
    $$

    因此 $(\lambda\mathbf{A})^{\mathrm{T}}=\lambda\mathbf{A}^{\mathrm{T}}$，对于任意 $\lambda\in\mathbb{F}$ 成立；
- （c）：根据定义

    $$
        (AC)^{\mathrm{T}}_{k,j}=(AC)_{j,k}=\sum_{r=1}^nA_{j,r}C_{r,k}=\sum_{r=1}^nC^{\mathrm{T}}_{k,r}A^{\mathrm{T}}_{r,j}=(CA)^{\mathrm{T}}_{k,j}
    $$

    因此 $(\mathbf{A}\mathbf{C})^{\mathrm{T}}=\mathbf{C}^{\mathrm{T}}\mathbf{A}^{\mathrm{T}}$ 成立。

证毕。$\square$

<br>

> **命题 3.7-2 矩阵转置对应对偶映射**
>
> 设线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则 $\mathcal{M}(\mathscr{T}')=(\mathcal{M}(\mathscr{T}))^{\mathrm{T}}$

<br>

证明：设向量空间 $\mathcal{V}$ 的基为 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$，设 $\mathcal{W}$ 的基为 $\boldsymbol{w}_1,\cdots,\boldsymbol{w}_m$，设 $\mathcal{V}$ 的对偶基为 $\varphi_1,\cdots,\varphi_n$，设 $\mathcal{W}$ 的对偶基为 $\psi_1,\cdots,\psi_m$，则 $\mathcal{M}(\mathscr{T})$ 是 $m\times n$ 矩阵，$\mathcal{M}(\mathscr{T}')$ 是 $n\times m$ 矩阵，令 $\mathbf{A}=\mathcal{M}(\mathscr{T}),\mathbf{C}=\mathcal{M}(\mathscr{T}')$。

根据对偶映射 $\mathscr{T}\in\mathcal{L}(\mathcal{W}',\mathcal{V}')$ 可知

$$
    \mathscr{T}'(\psi_j)=\sum_{r=1}^nC_{r,j}\varphi_r
$$

则根据对偶映射的定义可知

$$
    (\psi_j\circ\mathscr{T})(\boldsymbol{v}_k)=\sum_{r=1}^nC_{r,j}\varphi_r(\boldsymbol{v}_k)=C_{k,j}
$$

上述式子中的和式内，由对偶基的定义可知只有当 $r=k$ 时才有 $\varphi_r(\boldsymbol{v}_k)=1$，其余情况均为 $0$。我们又有

$$
    \begin{aligned}
        (\psi_j\circ\mathscr{T})(\boldsymbol{v}_k)&=\psi_j(\mathscr{T}(\boldsymbol{v}_k))\\
        &=\psi_j\left(\sum_{r=1}^mA_{r,k}\boldsymbol{w}_r\right)\\
        &=\sum_{r=1}^mA_{r,k}\psi_j(\boldsymbol{w}_r)\\
        &=A_{j,k}
    \end{aligned}
$$

上述式子中的和式内，由对偶基的定义可知只有当 $r=j$ 时才有 $$ \psi_j(\boldsymbol{w}_r)=1 $$，其余情况均为 $0$。综上所述，$A_{j,k}=C_{k,j}$，于是 $\mathbf{A}=\mathbf{C}^{\mathrm{T}}$，命题得证。$\square$

<br>

> **定义 3.7-2 行秩，列秩**
>
> 设 $\mathbf{A}$ 是 $m\times n$ 矩阵，其元素都是 $\mathbb{F}$ 中的标量
> - $\mathbf{A}$ 的行秩（row rank）是 $\mathbf{A}$ 在空间 $\mathbb{F}^{1,n}$ 中的行向量的线性扩张的维数；
> - $\mathbf{A}$ 的列秩（column rank）是 $\mathbf{A}$ 在空间 $\mathbb{F}^{m,1}$ 中的列向量线性扩张的维数。

<br>

> **命题 3.7-3 线性映射值域的维数等于其矩阵的列秩**
>
> 设向量空间 $\mathcal{V},\mathcal{W}$ 与线性映射 $\mathscr{T}\in\mathcal{L}(\mathcal{V},\mathcal{W})$，则 $\dim\text{range}\mathscr{T}$ 与矩阵 $\mathcal{M}(\mathscr{T})$ 的列秩相等

<br>

证明：设向量空间 $\mathcal{V}$ 的基为 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$，向量空间 $\mathcal{W}$ 的基为 $\boldsymbol{w}_1,\cdots,\boldsymbol{w}_m$。我们先使用记号

$$
    \mathcal{M}(\mathscr{T}(\boldsymbol{v}_k))=\begin{pmatrix}
        A_{1,k}\\ \vdots \\ A_{m,k}
    \end{pmatrix}\in\mathbb{F}^{m,1}
$$

来表示列向量。首先我们知道 $\text{range}\mathscr{T}=\text{span}(\mathscr{T}(\boldsymbol{v}_1),\cdots,\mathscr{T}(\boldsymbol{v}_n))$，我们只要证明

$$
    \text{span}(\mathscr{T}(\boldsymbol{v}_1),\cdots,\mathscr{T}(\boldsymbol{v}_n))\cong\text{span}(\mathcal{M}(\mathscr{T}(\boldsymbol{v}_1)),\cdots,\mathcal{M}(\mathscr{T}(\boldsymbol{v}_n)))
$$

很容易证明 $\mathscr{M}$ 是线性的。设 $\boldsymbol{w}\in\text{span}(\mathscr{T}(\boldsymbol{v}_1),\cdots,\mathscr{T}(\boldsymbol{v}_n))$，则我们设映射

$$
    \mathscr{M}:\text{span}(\mathscr{T}(\boldsymbol{v}_1),\cdots,\mathscr{T}(\boldsymbol{v}_n))\mapsto\text{span}(\mathcal{M}(\mathscr{T}(\boldsymbol{v}_1)),\cdots,\mathcal{M}(\mathscr{T}(\boldsymbol{v}_n)))
$$

我们只要证明 $\mathscr{M}$ 是双射，就可以证明这两个向量空间是同构的：
- 满射：

    $$
        \begin{aligned}
            \mathscr{M}(\boldsymbol{w})&=\mathscr{M}(c_1\mathscr{T}(\boldsymbol{v}_1)+\cdots+c_n\mathscr{T}(\boldsymbol{v}_n))\\
            &=c_1\mathscr{M}(\mathscr{T}(\boldsymbol{v}_1))+\cdots+c_n\mathscr{M}(\mathscr{T}(\boldsymbol{v}_n))\\
            &=c_1\mathcal{M}(\mathscr{T}(\boldsymbol{v}_1))+\cdots+c_n\mathcal{M}(\mathscr{T}(\boldsymbol{v}_n))\\
            &\in\text{span}(\mathcal{M}(\mathscr{T}(\boldsymbol{v}_1)),\cdots,\mathcal{M}(\mathscr{T}(\boldsymbol{v}_n)))
        \end{aligned}
    $$

    第三步的等号实际是两个向量空间的基之间的关系；
- 单射：

    <!--TODO : 这里我没有看懂书上的证明方法，B 站上讲解这本书的视频的方法我也没有看懂，这里的方法是我自己想的，可能有问题-->

    单射的证明可以使用线性映射基础定理证明，我们已经知道 $\dim\text{range}\mathscr{M}=n$，并且

    $$
        \dim\text{span}(\mathscr{T}(\boldsymbol{v}_1),\cdots,\mathscr{T}(\boldsymbol{v}_n))=n
    $$

    由线性映射基础定理可知 $\dim\text{null}\mathscr{M}=0$，因此其零空间只有 $\boldsymbol{0}$ 这个元素，因此其是单射。

综上所述，这两个向量空间之间存在同构，则

$$
    \dim\text{span}(\mathscr{T}(\boldsymbol{v}_1),\cdots,\mathscr{T}(\boldsymbol{v}_n))=\dim\text{span}(\mathcal{M}(\mathscr{T}(\boldsymbol{v}_1)),\cdots,\mathcal{M}(\mathscr{T}(\boldsymbol{v}_n)))
$$

注意到前者是 $\dim\text{range}\mathscr{T}$，后者是 $\mathcal{M}(\mathscr{T})$ 的列秩，命题得证。$\square$

这一章铺垫了这么久，用到了这么多概念，我们终于可以给出一个非常重要的定理：

> **定理 3.7-4 矩阵的行秩与列秩相等**
>
> 设矩阵 $\mathbf{A}\in\mathbb{F}^{m,n}$，则 $\mathbf{A}$ 的行秩与列秩相等

<br>

证明：设线性映射 $\mathscr{T}:\mathbb{F}^{n,1}\mapsto\mathbb{F}^{m,1}$，定义为 $\mathscr{T}(\boldsymbol{x})=\mathbf{A}\boldsymbol{x}$，则 $\mathcal{M}(\mathscr{T})=\mathbf{A}$（这是显然的，根据矩阵的定义）。则我们有

$$
    \begin{aligned}
        \text{column}\;\text{rank}\;\text{of}\;\mathbf{A}&=\text{column}\;\text{rank}\;\text{of}\;\mathcal{M}(\mathscr{T})\\
        &=\dim\text{range}\mathscr{T}\\
        &=\dim\text{range}\mathscr{T}'\\
        &=\text{column}\;\text{rank}\;\text{of}\;\mathcal{M}(\mathscr{T}')\\
        &=\text{column}\;\text{rank}\;\text{of}\;\mathbf{A}^{\mathrm{T}}\\
        &=\text{row}\;\text{rank}\;\text{of}\;\mathbf{A}
    \end{aligned}
$$

第一个等号是我们的定义，第二个等号是命题 3.7-3（线性映射值域的维数等于其矩阵的列秩），第三个等号是命题 3.6-7（线性映射和其对偶映射的值域维数相等），第四个等号是和第二个等号原理相同，第五个等号是命题 3.7-2（矩阵转置对应对偶映射），第六个等号是矩阵转置的定义。$\square$

<br>

> **定义 3.7-3 秩**
>
> 由于矩阵的行秩和列秩相等，我们可以直接定义矩阵的秩就是其列秩

<br>

<br>

<br>

## 4 多项式

<br>

> **定义 4.1-1 复数相关的概念**
>
> 设复数 $z=a+b\mathrm{i}$，其中 $a,b$ 是实数。
> 
> - 我们称 $z$ 的实部是 $a$，记作 $\text{Re}\;z=a$，称 $z$ 的虚部是 $b$，记作 $\text{Im}\;z=b$；
> - 我们记复数 $z$ 的共轭复数（complex conjugate）为 $\overline{z}$，定义为
>
> $$
    \overline{z}=\text{Re}\;z-\text{Im}\;z
>   $$
>
> - 我们记复数 $z$ 的模为 $\lvert z\rvert$，定义为
>
> $$
    \lvert z\rvert=\sqrt{(\text{Re}\;z)^2+(\text{Im}\;z)^2}
>   $$

<br>

下面给复数的相关性质，但我们只选证一部分：

<br>

> **命题 4.1-1 复数的性质**
>
> 设 $w,z\in\mathbb{C}$，则我们有：
> - （a）与共轭复数的和：$z+\overline{z}=2\text{Re}\;z$；
> - （b）与共轭复数的差：$z-\overline{z}=2\text{Im}\;z\;\mathrm{i}$；
> - （c）与共轭复数的积：$z\overline{z}=\lvert z\rvert^2$；
> - （d）共轭复数的和与积：$\overline{w+z}=\overline{w}+\overline{z}$ 和 $\overline{wz}=\overline{w}\;\overline{z}$；
> - （e）共轭复数的共轭复数：$\overline{\overline{z}}=z$；
> - （f）复数的实部和虚部的上界为模：$\lvert\text{Re}\;z\rvert\leq\lvert z\rvert$ 和 $\lvert\text{Im}\rvert\leq\lvert z\rvert$；
> - （g）共轭复数的模：$\lvert\overline{z}\rvert=\lvert z\rvert$；
> - （h）模的乘积：$\lvert wz\rvert=\lvert w\rvert\lvert z\rvert$；
> - （i）三角不等式：$\lvert w+z\rvert\leq\lvert w\rvert+\lvert z\rvert$

<br>

证明（部分）：设 $w=a+b\mathrm{i}$，$z=c+d\mathrm{i}$，则
- （d）我们有

    $$
        \overline{w+z}=\overline{(a+c)+(b+d)\mathrm{i}}=(a+c)-(b+d)\mathrm{i}=\overline{w}+\overline{z}
    $$

- （h）我们有

    $$
        \begin{aligned}
            \lvert wz\rvert^2&=(ac-bd)^2+(ad+bc)^2\\
            &=a^2c^2+a^2d^2+b^2c^2+b^2d^2\\
            &=(a^2+b^2)(c^2+d^2)\\
            &=\lvert w\rvert^2\lvert z\rvert^2
        \end{aligned}
    $$

    由于复数的模不小于 $0$，因此 $\lvert wz\rvert=\lvert w\rvert\lvert z\rvert$；
- （i）我们有

    $$
        \begin{aligned}
            \lvert w+z\rvert^2&=(w+z)(\overline{w}+\overline{z})\\
            &=w\overline{w}+w\overline{z}+z\overline{w}+z\overline{z}\\
            &=\lvert w\rvert^2+\lvert z\rvert^2+w\overline{z}+\overline{w\overline{z}}\\
            &=\lvert w\rvert^2+\lvert z\rvert^2+2\text{Re}(w\overline{z})\\
            &\leq \lvert w\rvert^2+\lvert z\rvert^2+2\lvert w\overline{z}\rvert\\
            &=\lvert w\rvert^2+\lvert z\rvert^2+2\lvert w\rvert\lvert z\rvert\\
            &=(\lvert w\rvert+\lvert z\rvert)^2
        \end{aligned}
    $$

    由于复数的模不小于 $0$，因此 $\lvert w+z\rvert\leq\lvert w\rvert+\lvert z\rvert$。

证毕。$\square$

多项式是一个线性映射 $p:\mathbb{F}\mapsto\mathbb{F}$，设系数 $a_0,\cdots,a_m\in\mathbb{F}$，则线性映射 $p$ 定义如下：

$$
    p(z)=a_0+a_1z+\cdots+a_mz^m,\quad z\in\mathbb{F}
$$

<br>

> **命题 4.1-2 多项式如果是零映射则系数均为零**
>
> 设 $a_0,\cdots,a_m\in\mathbb{F}$，如果
>
> $$
    a_0+a_1z+\cdots+a_mz^m=0
>   $$
>
> 对所有的 $z\in\mathbb{F}$ 成立，则 $a_0=a_1=\cdots=a_m=0$

<br>

证明：我们采用反证法，假设有系数不为零，不妨系数 $a_m$ 不为零，取

$$
    z=\frac{|a_0|+|a_1|+\cdots+|a_{m-1}|}{|a_m|}+1
$$

注意到 $z\geq 1$，因此 $z^j\leq z^{m-1}$ 对所有 $j=0,1,\cdots,m-1$ 成立，因此

$$
    \begin{aligned}
    |a_0+a_1z+\cdots+a_{m-1}z^{m-1}|&\leq|a_0+a_1+\cdots+a_{m-1}|z^{m-1}\\
    &=|a_0+a_1+\cdots+a_{m-1}|z^m\cdot\frac{1}{z}\\
    &=\frac{|a_0+a_1+\cdots+a_{m-1}|}{|a_0+a_1+\cdots+a_{m-1}+a_m|}z^m|a_m|\\
    &<|a_m|z^m=|a_mz^m|
    \end{aligned}
$$

这就说明 $a_0+a_1z+\cdots+a_{m-1}z^{m-1}\neq-a_mz^m$，因此 $a_0+a_1z+\cdots+a_mz^m\neq 0$，这与条件矛盾，因此 $a_m=0$，通过删去 $a_mz^m,a_{m-1}z^{m-1},\cdots$ 可以依次得到 $a_{m-1}=a_{m-2}=\cdots=a_0=0$，命题得证。$\square$

上面这个命题揭示了向量空间 $\mathcal{P}_m(\mathbb{F})$ 的一组基是 $p_0=1,p_1=z,\cdots,p_m=z^m$，这里这个向量空间的元素都是多项式线性映射。

接下来将给出多项式的 Euclid 算法。根据 Euclid 算法可知对于自然数 $p$ 和 $s$，其中 $s\neq 0$，则存在唯一的自然数 $q,r$ 使得

$$
    p=sq+r
$$

其中 $r<s$，这就是用 $s$ 去除 $p$，得到的除数为 $q$，余数为 $r$。我们的下一个目的就是说明多项式域上的 Euclid 算法的形式：

<br>

> **命题 4.1-3 多项式域上的 Euclid 算法**
>
> 设多项式 $p,s\in\mathcal{P}(\mathbb{F})$，其中 $s\neq 0$，则存在唯一的多项式 $q,r\in\mathcal{P}(\mathbb{F})$ 使得
>
> $$
    p=sq+r
>   $$
> 
> 其中 $\deg r<\deg s$

<br>

证明：设 $n=\deg p$，$m=\deg s$。如果 $n<m$，则取 $q=0,r=p$ 即可，命题成立；如果 $n\geq m$，设线性映射 $$ \mathscr{T}:\mathcal{P}_{n-m}(\mathbb{F})\times\mathcal{P}_{m-1}(\mathbb{F})\mapsto\mathcal{P}_n(\mathbb{F}) $$，其定义如下：

$$
    \mathscr{T}((q,r))=sq+r
$$

我们说明 $\mathscr{T}$ 是一个线性映射：
- 可加性：

    $$
        \begin{aligned}
            \mathscr{T}((q_1,r_1)+(q_2,r_2))&=s(q_1+q_2)+r_1+r_2\\
            &=(sq_1+r_1)+(sq_2+r_2)\\
            &=\mathscr{T}((q_1,r_1))+\mathscr{T}((q_2,r_2))
        \end{aligned}
    $$

    因此线性映射 $\mathscr{T}$ 满足可加性；
- 齐次性：

    $$
        \begin{aligned}
            \mathscr{T}(\lambda(q,r))&=s(\lambda q)+\lambda r\\
            &=\lambda(sq+r)\\
            &=\lambda\mathscr{T}((q,r))
        \end{aligned}
    $$

    因此线性映射 $\mathscr{T}$ 满足齐次性。

如果 $(q,r)\in\text{null}\mathscr{T}$，则 $sq+r=0$，如果 $q\neq 0$，则 $\deg sq\geq m$，故 $sq=-r$ 是无解的，因此 $q=r=0$，因此 $\dim\text{null}\mathscr{T}=0$，根据命题 3.5-2 可知

$$
    \dim(\mathcal{P}_{n-m}(\mathbb{F})\times\mathcal{P_{m-1}}(\mathbb{F}))=(n-m+1)+(m-1+1)=n+1
$$

再根据线性映射基础定理可知 $\dim\text{range}\mathscr{T}=n+1$，由于多项式向量空间的特殊性，可知 $$ \text{range}\mathscr{T}=\mathcal{P}_n(\mathbb{F}) $$，因此存在 $$ q\in\mathcal{P}_{n-m}(\mathbb{F}) $$ 和 $$ r\in\mathcal{P}_{m-1}(\mathbb{F}) $$ 使得

$$
    p=qs+r
$$

且 $\deg r\leq m-1<m=\deg s$。$\square$

就像自然数集合上的 Euclid 算法给出了带余数的除法，多项式域上的 Euclid 算法给出了长除法的原理：

$$
    \begin{aligned}
        &\quad\quad\quad\quad\quad\; 1x^3+3x^2+1x-9\\
        1x^2+0x+1\surd&\overline{1x^5+3x^4+2x^3-6x^2-7x-9}\\
        &1x^5+0x^4+1x^3\\
        &\overline{\quad\quad\;\;3x^4+1x^3-6x^2}\\
        &\quad\quad\;\;3x^4+0x^3+3x^2\\
        &\quad\quad\;\;\overline{\quad\quad\;\; 1x^3-9x^2-7x}\\
        &\quad\quad\;\;\quad\quad\;\; 1x^3+0x^2+1x\\
        &\quad\quad\;\;\quad\quad\;\;\overline{\quad\quad -9x^2-8x-9}\\
        &\quad\quad\;\;\quad\quad\;\quad\quad -9x^2+0x-9\\
        &\quad\quad\;\;\quad\quad\;\quad\quad\overline{\quad\; 0x^2-8x+0}
    \end{aligned}
$$

方程 $p(z)=0$ 的解在抽象代数中有非常重要的研究地位，我们在这里只能用线性代数的知识给出一些简单的命题及其证明。

<br>

> **定义 4.1-2 多项式的零点**
>
> 一个标量 $\lambda\in\mathbb{F}$ 称为多项式 $p\in\mathcal{P}(\mathbb{F})$ 的零点或者根当且仅当
>
> $$
    p(\lambda)=0
>   $$

<br>

> **定义 4.1-3 因式**
>
> 一个多项式 $s\in\mathcal{P}(\mathbb{F})$ 称为多项式 $p\in\mathcal{P}(\mathbb{F})$ 的因式（factor）当且仅当存在一个多项式 $q\in\mathcal{P}(\mathbb{F})$ 使得
>
> $$
    p=sq
>   $$

<br>

我们可以用线性代数的方法证明因式分解求根的原理：

<br>

> **命题 4.1-4 每一个多项式的根对应一个维数为 1 的因式**
>
> 设多项式 $p\in\mathcal{P}(\mathbb{F})$ 和标量 $\lambda\in\mathbb{F}$，则 $\lambda$ 是 $p$ 的根当且仅当存在多项式 $q\in\mathcal{P}(\mathbb{F})$ 使得
>
> $$
    p(z)=(z-\lambda)q(z)
>   $$
>
> 对任意 $z\in\mathbb{F}$ 都成立

<br>

证明：
- 必要性：$p(\lambda)=(\lambda-\lambda)q(\lambda)=0$，故 $\lambda$ 是多项式 $p$ 的根；
- 充分性：如果 $\lambda$ 是多项式 $p$ 的根，设 $z-\lambda$，其维数为 $1$，根据命题 4.1-3（多项式域上的 Euclid 算法），则存在多项式 $q\in\mathcal{P}(\mathbb{F})$ 和标量 $r\in\mathbb{F}$（这是因为根据多项式域上的 Euclid 算法，$\dim r=0<1$ 或 $\dim r=-\infty<1$，故 $r$ 是标量）使得

    $$
        p=(z-\lambda)q+r
    $$

    对所有的 $z\in\mathbb{F}$ 成立。如果 $p$ 的根是 $\lambda$，则 $p(\lambda)=r=0$，因此存在多项式 $q\in\mathcal{P}(\mathbb{F})$ 使得

    $$
        p(z)=(z-\lambda)q(z)
    $$

    对任意 $z\in\mathbb{F}$ 都成立。

证毕。$\square$

根据上述命题我们可以推导出下面这个命题：

<br>

> **命题 4.1-5 多项式最多只有和它维数相等的个数的根**
>
> 设多项式 $p\in\mathcal{P}(\mathbb{F})$，其维数为 $\deg p\geq 0$，则 $p$ 在 $\mathbb{F}$ 上最多只有 $\deg p$ 个不同的根

<br>

证明：我们使用数学归纳法证明。当 $m=0$ 时，$p(z)=a_0\neq 0$，因此 $p$ 在 $\mathbb{F}$ 上没有根；当 $m=1$ 时，$p(z)=a_0+a_1z$，且 $a_1\neq 0$，则 $p$ 有一个零点为 $-a_0/a_1$。

假设 $m>1$，假设对于维数为 $m-1$ 的的多项式最多有 $m-1$ 个不同的根。设维数为 $m$ 的多项式 $p$，如果多项式 $p$ 在 $\mathbb{F}$ 上没有根，则命题成立；如果多项式 $p$ 在 $\mathbb{F}$ 上至少有一个根 $\lambda$，则根据命题 4.1-4 可知存在多项式 $q\in\mathcal{P}(\mathbb{F})$ 使得

$$
    p(z)=(z-\lambda)q(z)
$$

很容易知道 $\deg q=m-1$，$q(z)$ 的根也是 $p(z)$ 的根，因此多项式 $p$ 至多有 $m$ 个不同的根。命题得证。$\square$

很多有关多项式的根的命题都需要使用复分析来进行证明，这里只给出了一些简单命题的线性代数方法证明。接下来的这个命题的证明涉及到复分析，所以只给出结论：

<br>

> **定理 4.1-6 代数基本定理**
>
> 任何复系数的一元 $n$ 次多项式在复数域上至少有一个根，其中 $n\geq 1$

<br>

> **命题 4.1-7 复数域上的复系数多项式因式分解**
>
> 设复数域上的非常数的复系数多项式 $p\in\mathcal{P}(\mathbb{C})$，则 $p$ 具有唯一的因式分解：
>
> $$
    p(z)=c(z-\lambda_1)\cdots(z-\lambda_m)
>   $$
>
> 其中 $\lambda_1,\cdots,\lambda_m\in\mathbb{C}$

<br>

证明：设多项式 $p\in\mathcal{P}(\mathbb{C})$，$m=\deg p$，我们对 $m$ 使用数学归纳法进行证明。当 $m=1$ 时可设 $p=a_0+a_1z$，其中 $a_0,a_1\in\mathbb{C}$，很显然此时 $p$ 的唯一根为 $z=-a_0/a_1$，因此 $p$ 具有唯一的因式分解 $p(z)=a_1(z+a_0/a_1)$。

假设 $m>1$ 并且这个命题对 $m-1$ 成立。设多项式 $p\in\mathcal{P}(\mathbb{C})$，我们将说明存在这样的因式分解。注意到 $\deg p\geq 2$，因此根据定理 4.1-6 可知 $p$ 存在根 $\lambda$，故存在多项式 $q\in\mathcal{P}(\mathbb{C})$ 使得

$$
    p(z)=(z-\lambda)q(z)
$$

对所有 $z\in\mathbb{C}$ 成立，因为 $\deg q=m-1$，根据假设，$q$ 存在这样的因式分解，将其代入即可得到 $p$ 也有这种形式的因式分解。归纳假设成立。

接下去证明这种因式分解是唯一的，首先我们知道系数 $c$ 是由项 $z^m$ 单独决定的。我们设存在一组不同的根 $\tau_1,\cdots,\tau_m$ 使得

$$
    (z-\lambda_1)\cdots(z-\lambda_m)=(z-\tau_1)\cdots(z-\tau_m)
$$

当 $z=\lambda_1$ 时，左侧式子为 $0$，因此 $\tau_1,\cdots,\tau_m$ 中有一个等于 $\lambda_1$，由于我们不关心 $\tau_i$ 的顺序，不妨设 $\tau_1=\lambda_1$。于是当 $z\neq \lambda_1$ 时，两侧的 $z-\lambda_1$ 可以删去，得到

$$
    (z-\lambda_2)\cdots(z-\lambda_m)=(z-\tau_2)\cdots(z-\tau_m)
$$

以此类推就能得到 $\tau_2=\lambda_2,\cdots,\tau_m=\lambda_m$，因此可以得出因式分解唯一的结论。$\square$

<br>

> **命题 4.1-8 复数域上的实系数多项式因式分解**
>
> 设复数域上的非常数的实系数多项式 $p\in\mathcal{P}(\mathbb{C})$，设复数 $\lambda$ 是它的根，则其共轭复数 $\overline{\lambda}$ 也是 $p$ 的根

<br>

证明：设 $p=a_0+a_1z+\cdots+a_mz^m$，设 $\lambda$ 是其根，则

$$
    a_0+a_1\lambda+\cdots+a_m\lambda^m=0
$$

根据命题 4.1-1-d（共轭复数的和与积）知

$$
    \overline{a_0+a_1\lambda+\cdots+a_m\lambda^m}=a_0+a_1\overline{\lambda}+\cdots+a_m\overline{\lambda}^m=0
$$

因此 $\overline{\lambda}$ 也是 $p$ 的根，这里的重要条件是系数均为实数，否则系数也会参与到取共轭的过程中。$\square$

<br>

> **命题 4.1-9 实数域上的实系数二次多项式的因式分解**
>
> 设 $b,c$ 是实数，则以下二次实系数多项式具有以下因式分解
>
> $$
    x^2+bx+c=(x-\lambda_1)(x-\lambda_2)
>   $$
>
> 其中 $\lambda_1,\lambda_2\in\mathbb{R}$，当且仅当 $b^2\geq 4c$

<br>

证明：注意到

$$
    x^2+bx+c=\left(x+\frac{b}{2}\right)^2-\frac{b^2}{4}+c
$$

假设 $b^2<4c$，则右式 $RHS>0$ 对所有 $x\in\mathbb{R}$ 成立，因此 $x^2+bx+c$ 没有根；假设 $b^2\geq 4c$，则存在 $d\in\mathbb{R}$ 使得 $\displaystyle d^2=\frac{b^2}{4}-c$，满足

$$
    x^2+bx+c=\left(x+\frac{b}{2}\right)^2-d^2=\left(x+\frac{b}{2}+d\right)\left(x+\frac{b}{2}-d\right)
$$

因此我们可以取 $\displaystyle\lambda_1=-\frac{b}{2}-d$，$\displaystyle\lambda_2=-\frac{b}{2}+d$。$\square$

<br>

> **命题 4.1-10 实数域上的实系数多项式因式分解**
>
> 设实系数多项式 $p\in\mathcal{P}(\mathbb{R})$ 是非常数的多项式，则 $p$ 有一个唯一的因式分解
>
> $$
    p(x)=c(x-\lambda_1)\cdots(x-\lambda_m)(x^2+b_1x+c_1)\cdots(x^2+b_Mx+c_M)
>   $$
>
> 其中 $c,\lambda_1,\cdots,\lambda_m,b_1,\cdots,b_M,c_1,\cdots.c_M$ 都是实数，并且 $b_j^2<4c_j$，其中 $1\leq j\leq M$

<br>

证明：多项式 $p\in\mathcal{P}(\mathbb{R})$ 也是向量空间 $\mathcal{P}(\mathbb{C})$ 的元素，如果所有的根都是实数（即虚部为 $0$），根据命题 4.1-7 知存在 $\lambda_1,\cdots,\lambda_m\in\mathbb{R}$ 使得

$$
    p(x)=c(x-\lambda_1)\cdots(x-\lambda_m)
$$

如果 $p$ 有一个根 $\lambda\in\mathbb{C}$ 且 $\lambda\notin\mathbb{R}$，那么根据命题 4.1-8 可知 $\overline{\lambda}$ 也是 $p$ 的根，即

$$
    p(x)=(x-\lambda)(x-\overline{\lambda})q(x)=(x^2-2(\text{Re}\;\lambda)x+\lvert\lambda\rvert^2)q(x)
$$

其中

$$
    4(\text{Re}\;\lambda)^2-4\lvert\lambda\rvert^2=4(\text{Re}\;\lambda+\lvert\lambda\rvert)(\text{Re}\;\lambda-\lvert\lambda\rvert)<0
$$

且 $q(x)$ 是一个维数为 $\deg p-2$ 的多项式，$q\in\mathcal{P}(\mathbb{C})$，我们只要证明 $q$ 是一个实系数多项式即可。将方程改写为

$$
    q(x)=\frac{p(x)}{x^2-2(\text{Re}\;\lambda)x+\lvert\lambda\rvert^2}
$$

注意到分子分母都是实数，因此对任意 $x\in\mathbb{R}$，$q(x)\in\mathbb{R}$，我们可以把 $q(x)$ 写作

$$
    q(x)=a_0+a_1x+\cdots+a_{n-2}x^{n-2},\quad n=\deg p
$$

其中 $a_0,\cdots,a_{n-2}\in\mathbb{C}$，注意到对所有 $x\in\mathbb{R}$ 都有 $q(x)\in\mathbb{R}$，则

$$
    0=\text{Im}\;q(x)=\text{Im}\;a_0+(\text{Im}\;a_1)x+\cdots+(\text{Im}\;a_{n-2})x^{n-2}
$$

对所有 $x\in\mathbb{R}$ 都成立，根据命题 4.1-2 可知 $\text{Im}\;a_0=\cdots=\text{Im}\;a_{n-2}=0$，这说明 $q(x)$ 也是一个实系数多项式。综上确实可以得出所有实数域上的实系数多项式都能因式分解为这个形式。

接下去证明这个因式分解形式是唯一的：根据命题 4.1-8 可知这个形式的因式分解又可以写作：

$$
    p(x)=(x-\lambda_1)\cdots(x-\lambda_m)(x-\tau_1)(x-\overline{\tau_1})\cdots(x-\tau_M)(x-\overline{\tau_M})
$$

其中 $\lambda_1,\cdots,\lambda_m\in\mathbb{R}$，且 $\tau_1,\cdots,\tau_M\in\mathbb{C}$。此时这是在复数域上进行因式分解，根据命题 4.1-7 知该因式分解形式是唯一的。$\square$

<br>

<br>

<br>

## 5 特征值、特征向量和不变子空间

<br>

### 5.1 不变子空间

<br>

> **定义 5.1-1 不变子空间**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，$\mathcal{V}$ 的一个子空间 $\mathcal{U}$ 称为线性算子 $\mathscr{T}$ 下的不变子空间（invariant subspace）当且仅当对所有向量 $\boldsymbol{u}\in\mathcal{U}$ 都有 $\mathscr{T}(\boldsymbol{u})\in\mathcal{U}$

<br>

使用记号 $\mathscr{T}\vert_{\mathcal{U}}$ 来表示线性算子 $\mathscr{T}$ 的定义域改为更小的子空间 $\mathcal{U}$ 时的线性映射，不变子空间的等价定义是 $\mathscr{T}\vert_{\mathcal{U}}$ 是子空间 $\mathcal{U}$ 的线性算子。

<br>

> **定义 5.1-2 特征值**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，一个标量 $\lambda\in\mathbb{F}$ 称为线性算子 $\mathscr{T}$ 的特征值（eigenvalue）当且仅当存在非零向量 $\boldsymbol{v}\in\mathcal{V}$ 使得
>
> $$
    \mathscr{T}(\boldsymbol{v})=\lambda\boldsymbol{v}
>   $$
>
> 其中向量 $\boldsymbol{v}$ 称为线性算子 $\mathscr{T}$ 的特征向量（eigenvector）

<br>

如果线性算子 $\mathscr{T}$ 具有特征值，则可以找到这样一个维数为 $1$ 的不变子空间

$$
    \mathcal{U}=\{\lambda\boldsymbol{v}:\lambda\in\mathbb{F}\}=\text{span}(\boldsymbol{v})
$$

很明显根据线性映射的齐次性以及向量空间对标量乘法的封闭可知，这样的子空间确实是不变的（事实上这一章很大一部分在研究如何寻找不变子空间）。上述定义要求 $\boldsymbol{v}$ 是非零向量，这是因为 $\mathscr{T}(\boldsymbol{0})=\lambda\boldsymbol{0}$ 是平凡成立的。

<br>

> **命题 5.1-1 特征值的等价形式**
>
> 设 $\mathcal{V}$ 是有限维向量空间，线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 以及标量 $\lambda\in\mathbb{F}$，下面的表述是等价的：
> - （a）$\lambda$ 是线性算子 $\mathscr{T}$ 的特征值；
> - （b）线性算子 $\mathscr{T}-\lambda\mathscr{I}$ 不是单射；
> - （c）线性算子 $\mathscr{T}-\lambda\mathscr{I}$ 不是满射；
> - （d）线性算子 $\mathscr{T}-\lambda\mathscr{I}$ 不是可逆的
>
> 其中 $\mathscr{I}$ 是向量空间 $\mathcal{V}$ 上的恒等线性算子，$\mathscr{I}(\boldsymbol{v})=\boldsymbol{v}$，其中 $\boldsymbol{v}\in\mathcal{V}$

<br>

证明：特征值的定义 $\mathscr{T}(\boldsymbol{v})=\lambda\boldsymbol{v}$ 等价于方程

$$
    \mathscr{T}(\boldsymbol{v})-\lambda\boldsymbol{v}=(\mathscr{T}-\lambda\mathscr{I})(\boldsymbol{v})=0
$$

存在非零向量解。因此线性算子 $\mathscr{T}-\lambda\mathscr{I}$ 的零空间不只有零向量，等价于其不是单射，（a）和（b）等价。根据命题 3.4-6（有限维向量空间上的线性算子的单射和满射等价），（b）、（c）和（d）则是等价的。特征向量 $\boldsymbol{v}\in\text{null}(\mathscr{T}-\lambda\mathscr{I})$ 且 $\boldsymbol{v}\neq\boldsymbol{0}$。$\square$

<br>

> **命题 5.1-2 特征向量是线性无关的**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，设 $\lambda_1,\cdots,\lambda_m$ 是 $\mathscr{T}$ 不同的特征值，则其对应的特征向量 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m$ 是线性无关的

<br>

证明：假设 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m$ 是线性相关的，设 $k$ 是最小的正整数使得

$$
    \boldsymbol{v}_k\in\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_{k-1})
$$

$k$ 的存在性由命题 2.1-2（线性相关的判断方法）得到，则存在 $a_1,\cdots,a_{k-1}\in\mathbb{F}$ 使得

$$
    \boldsymbol{v}_k=a_1\boldsymbol{v}_1+\cdots+a_{k-1}\boldsymbol{v}_{k-1}
$$

让 $\mathscr{T}$ 作用于等式的两边可以得到

$$
    \lambda_k\boldsymbol{v}_k=a_1\lambda_1\boldsymbol{v}_1+\cdots+a_{k-1}\lambda_{k-1}\boldsymbol{v}_{k-1}
$$

对比

$$
    \lambda_k\boldsymbol{v}_k=\lambda_ka_1\boldsymbol{v}_1+\cdots+\lambda_ka_{k-1}\boldsymbol{v}_{k-1}
$$

就能得到

$$
    a_1(\lambda_k-\lambda_1)\boldsymbol{v}_1+\cdots+a_{k-1}(\lambda_k-\lambda_{k-1})\boldsymbol{v}_{k-1}=\boldsymbol{0}
$$

因为 $k$ 是最小的满足预设条件

$$
    \boldsymbol{v}_k\in\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_{k-1})
$$ 

的正整数，因此 $$ \boldsymbol{v}_1,\cdots,\boldsymbol{v}_{k-1} $$ 是线性无关的，由于我们知道 $\lambda_1,\cdots,\lambda_k$ 两两不同，因此上述方程可以得到 $a_1=\cdots=a_{k-1}=0$，故 $\boldsymbol{v}_k=\boldsymbol{0}$，不满足条件。假设不成立，于是可以得到特征向量是线性无关的。$\square$

上面的重要命题可以直接推导出下面这个关于特征值数量最大值的命题（只需要看到特征向量 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_k$ 是线性无关的，则 $k\leq\dim\mathcal{V}$）。

<br>

> **命题 5.1-3 特征值的数量**
>
> 设 $\mathcal{V}$ 是有限维向量空间，则对于其上的每一个线性算子，线性算子的特征值数量不超过 $\dim\mathcal{V}$

<br>

> **定义 5.1-3 限制算子和商算子**
>
> 设 $\mathcal{V}$ 是有限维向量空间，线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，$\mathcal{U}$ 是线性算子 $\mathscr{T}$ 下的 $\mathcal{V}$ 的不变子空间。
>
> - 限制算子（restriction operator）$\mathscr{T}\vert_{\mathcal{U}}\in\mathcal{L}(\mathcal{U})$ 定义为（对于 $\boldsymbol{u}\in\mathcal{U})$
>
> $$
    \mathscr{T}\vert_{\mathcal{U}}(\boldsymbol{u})=\mathscr{T}(\boldsymbol{u})
>   $$
>
> - 商算子（quotient operator）$\mathscr{T}/\mathcal{U}\in\mathcal{L}(\mathcal{V}/\mathcal{U})$ 定义为（对于 $\boldsymbol{v}\in\mathcal{V}$）
>
> $$
    (\mathscr{T}/\mathcal{U})(\boldsymbol{v}+\mathcal{U})=\mathscr{T}(\boldsymbol{v})+\mathcal{U}
>   $$

<br>

### 5.2 上三角矩阵

<br>

线性算子与一般的线性映射不相同的地方在于其可以自身复合，并且可以复合任意多次。由此我们可以很自然地发展出线性算子的幂的概念：

<br>

> **定义 5.2-1 线性算子的幂**
>
> 设 $\mathcal{V}$ 是有限维向量空间，$\mathscr{T}$ 是其上的一个线性算子，$\mathscr{T}\in\mathcal{L}(\mathcal{V})$，$m$ 是一个正整数，则
> - $\mathscr{T}^m$ 定义为
>
> $$
    \mathscr{T}^m=\overbrace{\mathscr{T}\circ\cdots\circ\mathscr{T}}^{m\;\text{times}}
>   $$
>
> - $\mathscr{T}^0$ 定义为 $\mathcal{V}$ 上的恒等线性算子 $\mathscr{I}$；
> - 如果 $\mathscr{T}$ 是可逆的，则 $\mathscr{T}^{-m}$ 定义为
>
> $$
    \mathscr{T}^{-m}=(\mathscr{T}^{-1})^m
>   $$

<br>

> **定义 5.2-2 算子多项式**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，多项式 $p\in\mathcal{P}(\mathbb{F})$ 形如：
>
> $$
    p(z)=a_0+a_1z+\cdots+a_mz^m
>   $$
>
> 对于任意 $z\in\mathbb{F}$，则算子多项式 $p(\mathscr{T})$ 定义为
>
> $$
    p(\mathscr{T})=a_0\mathscr{I}+a_1\mathscr{T}+\cdots+a_m\mathscr{T}^m
>   $$

<br>

设微分线性算子 $\mathscr{D}\in\mathcal{L}(\mathcal{P}(\mathbb{R}))$，设多项式 $p(x)=x^2+x+1$，则该微分线性算子的在多项式 $p$ 作用下的算子多项式为

$$
    (p(\mathscr{D}))(q)=q''+q'+q,\quad q\in\mathcal{P}(\mathbb{R})
$$

<br>

> **定义 5.2-3 多项式的乘积**
>
> 设多项式 $p,q\in\mathcal{P}(\mathbb{F})$，则这两个多项式的乘积 $pq\in\mathcal{P}(\mathbb{F})$ 定义为
>
> $$
    (pq)(z)=p(z)q(z)
>   $$
>
> 对于任意 $z\in\mathbb{F}$

<br>

> **命题 5.2-1 算子多项式的乘法交换律**
>
> 设多项式 $p,q\in\mathcal{P}(\mathbb{F})$，线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，则
> - $(pq)(\mathscr{T})=p(\mathscr{T})q(\mathscr{T})$；
> - $p(\mathscr{T})q(\mathscr{T})=p(\mathscr{T})q(\mathscr{T})$

<br>

证明：设 $p(z)=\sum_{j=0}^ma_jz^j$，$q(z)=\sum_{k=0}^nb_kz^k$，对任意 $z\in\mathbb{F}$，则

$$
    (pq)(z)=\sum_{j=0}^m\sum_{k=0}^na_jb_kz^{j+k}
$$

因此算子的多项式乘积为

$$
    \begin{aligned}
        (pq)(\mathscr{T})&=\sum_{j=0}^m\sum_{k=0}^na_jb_k\mathscr{T}^{j+k}\\
        &=\left(\sum_{j=0}^ma_j\mathscr{T}^j\right)\left(\sum_{k=0}^nb_k\mathscr{T}^k\right)\\
        &=p(\mathscr{T})q(\mathscr{T})
    \end{aligned}
$$

第二个等号明显可以交换两个和的顺序，因此算子多项式的乘法交换律成立。$\square$

接下来将给出一个线性代数里重要的命题

<br>

> **命题 5.2-2 非零复向量空间上的线性算子有特征值**
>
> 一个有限维的、非零的复向量空间上的每一个线性算子都有一个特征值

<br>

证明：设 $\mathcal{V}$ 是复向量空间，维数 $n>0$，设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，选择一个非零向量 $\boldsymbol{v}\in\mathcal{V}$，则

$$
    \boldsymbol{v},\mathscr{T}(\boldsymbol{v}),\mathscr{T}^2(\boldsymbol{v}),\cdots,\mathscr{T}^n(\boldsymbol{v})
$$

是线性相关的，因为 $\mathcal{V}$ 的维数是 $n$ 并且我们有 $n+1$ 个 $\mathcal{V}$ 中的元素。因此存在不全为零的复数 $a_0,\cdots,a_n$ 使得

$$
    \boldsymbol{0}=a_0\boldsymbol{v}+a_1\mathscr{T}(\boldsymbol{v})+\cdots+a_n\mathscr{T}^n(\boldsymbol{v})
$$

注意到 $a_1,\cdots,a_n$ 不能全为 $0$，否则这将推导出 $a_0=0$。考虑复系数多项式 $p(z)=a_0+a_1z+\cdots+a_nz^n$，根据命题 4.1-7 可知存在标量 $\lambda_1,\cdots,\lambda_m$ 使得

$$
    a_0+a_1z+\cdots+a_nz^n=c(z-\lambda_1)\cdots(z-\lambda_m)
$$

注意其中 $m=n$ 不是必须成立的，因为 $a_n$ 可能为零，因此

$$
    \begin{aligned}
        \boldsymbol{0}&=a_0\boldsymbol{v}+a_1\mathscr{T}(\boldsymbol{v})+\cdots+a_n\mathscr{T}^n(\boldsymbol{v})\\
        &=(a_0\mathscr{I}+a_1\mathscr{T}+\cdots+a_n\mathscr{T}^n)(\boldsymbol{v})\\
        &=c(\mathscr{T}-\lambda_1\mathscr{I})\cdots(\mathscr{T}-\lambda_m\mathscr{I})(\boldsymbol{v})
    \end{aligned}
$$

因此存在某个 $1\leq j\leq m\leq n$ 使得 $\mathscr{T}-\lambda_j\mathscr{I}$ 不是单射，故 $\mathscr{T}$ 存在特征值。$\square$

我们研究过线性映射的矩阵表示，由于线性算子是特殊的线性映射，我们自然也关心线性算子的矩阵表示：

<br>

> **定义 5.2-4 线性算子的矩阵表示**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，并且 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 是向量空间 $\mathcal{V}$ 的基，线性算子 $\mathscr{T}$ 的矩阵表示是一个 $n\times n$ 矩阵：
>
> $$
    \mathcal{M}(\mathscr{T})=\begin{pmatrix}
        A_{1,1}&\cdots&A_{1,n}\\
        \vdots&&\vdots\\
        A_{n,1}&\cdots&A_{n,n}
    \end{pmatrix}
>   $$
>
> 其中元素 $A_{j,k}$ 定义为
>
> $$
    \mathscr{T}(\boldsymbol{v}_k)=A_{1,k}\boldsymbol{v}_1+\cdots+A_{n,k}\boldsymbol{v}_n
>   $$
>
> 如果上下文中该向量空间的基的书写不明确的话，一般使用记号 $\mathcal{M}(\mathscr{T},(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n))$ 表示这个基

<br>

线性代数的一个核心是研究有限维向量空间上的线性算子的矩阵简化，我们需要尽可能得到一个含有更多 $0$ 的矩阵。

<br>

> **定义 5.2-5 方阵的对角线**
>
> 我们称 $n\times n$ 的矩阵为方阵（square matrix），其对角线（diagonal）包含了矩阵左上角到右下角直线上的元素，换言之，可以记作
>
> $$
    \text{diagonal}\;\mathbf{A}=(A_{1,1},\cdots,A_{j,j},\cdots,A_{n,n})
>   $$
>
> 其中 $1\leq j\leq n$

<br>

> **定义 5.2-6 上三角矩阵**
>
> 一个矩阵被称为上三角矩阵（upper-triangular matrix）当且仅当对角线下的元素都为 $0$，即一个矩阵 $\mathbf{A}$ 是上三角矩阵时，$A_{i,j}=0$，其中 $i< j$，这样的矩阵可以记作
>
> $$
    \begin{pmatrix}
        \lambda_1&&*\\
        &\ddots&\\
        0&&\lambda_n
    \end{pmatrix}
>   $$

<br>

> **命题 5.2-3 线性算子的矩阵是上三角矩阵的等价命题**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，且 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 是向量空间 $\mathcal{V}$ 的基，则下列命题等价：
> - （a）由基 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 组成的线性算子 $\mathscr{T}$ 的矩阵是上三角矩阵；
> - （b）$\mathscr{T}(\boldsymbol{v}_j)\in\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)$ 对于任意 $1\leq j\leq n$ 都成立；
> - （c）$\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)$ 是线性算子 $\mathscr{T}$ 下的不变子空间

<br>

证明：
- （a）与（b）等价：根据线性算子以及上三角矩阵的定义，我们可以知道

    $$
        \begin{aligned}
            \mathscr{T}(\boldsymbol{v}_j)&=A_{j,1}\boldsymbol{v}_1+\cdots+A_{j,n}\boldsymbol{v}_n\\
            &=A_{j,1}\boldsymbol{v}_1+\cdots+A_{j,j}\boldsymbol{v}_j\\
            &\in\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)
        \end{aligned}
    $$

- （c）推出（b）：这是不变子空间定义的结果；
- （b）推出（c）：设 $1\leq j\leq n$，我们知道

    $$
        \begin{aligned}
            \mathscr{T}(\boldsymbol{v}_1)\in\text{span}(\boldsymbol{v}_1)&\subset\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)\\
            \mathscr{T}(\boldsymbol{v}_2)\in\text{span}(\boldsymbol{v}_1,\boldsymbol{v}_2)&\subset\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)\\
            &\vdots\\
            \mathscr{T}(\boldsymbol{v}_j)&\in\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)
        \end{aligned}
    $$

    设 $\boldsymbol{v}\in\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)$，则 $\mathscr{T}(\boldsymbol{v})=a_1\mathscr{T}(\boldsymbol{v}_1)+\cdots+a_j\mathscr{T}(\boldsymbol{v}_j)\in\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)$，因此 $\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)$ 是 $\mathscr{T}$ 下的不变子空间。

证毕。$\square$

<br>

> **命题 5.2-4 复向量空间上的线性算子的矩阵可以是上三角矩阵**
>
> 设向量空间 $\mathcal{V}$ 是有限维复向量空间，且线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，则可以选取 $\mathcal{V}$ 中的某组基使得 $\mathscr{T}$ 的矩阵表示为上三角矩阵

<br>

证法1：对向量空间 $\mathcal{V}$ 的维数进行归纳。当 $\dim\mathcal{V}=1$ 时，命题是显然的（此时矩阵只有一个元素，命题是平凡的）。

设 $\dim\mathcal{V}>1$，假设对于所有维数小于 $\dim\mathcal{V}$ 的复向量空间命题成立，根据命题 5.2-2 可知线性算子 $\mathscr{T}$ 有特征值，设特征值为 $\lambda$，令

$$
    \mathcal{U}=\text{range}(\mathscr{T}-\lambda\mathscr{I})
$$

由于 $(\mathscr{T}-\lambda\mathscr{I})(\boldsymbol{v})=\boldsymbol{0}$ 有非零解，因此 $\mathscr{T}-\lambda\mathscr{I}$ 不是单射，根据命题 3.4-6（有限维向量空间上的线性算子单射和满射等价）可知 $\mathscr{T}-\lambda\mathscr{I}$ 不是满射，因此 $\dim\mathcal{U}<\dim\mathcal{V}$。我们可以证明 $\mathcal{U}$ 是 $\mathscr{T}$ 下的不变子空间：

$$
    \mathscr{T}(\boldsymbol{u})=(\mathscr{T}-\lambda\mathscr{I})(\boldsymbol{u})+\lambda\boldsymbol{u}
$$

其中 $\boldsymbol{u}\in\mathcal{U}$，注意到 $(\mathscr{T}-\lambda\mathscr{I})(\boldsymbol{u})\in\mathcal{U}$，$\lambda\boldsymbol{u}\in\mathcal{U}$，那么 $\mathscr{T}(\boldsymbol{u})\in\mathcal{U}$，于是 $\mathcal{U}$ 是 $\mathscr{T}$ 下的不变子空间。因此限制算子 $\mathscr{T}\vert_{\mathcal{U}}$ 是 $\mathcal{U}$ 上的线性算子，根据归纳假设，可以选取一组 $\mathcal{U}$ 的基 $$ \boldsymbol{u}_1,\cdots,\boldsymbol{u}_m $$ 使得 $\mathcal{M}(\mathscr{T}\vert_{\mathcal{U}})$ 是上三角矩阵。因此我们有

$$
    \mathscr{T}(\boldsymbol{u}_j)=(\mathscr{T}\vert_{\mathcal{U}})(\boldsymbol{u}_j)\in\text{span}(\boldsymbol{u}_1,\cdots,\boldsymbol{u}_j)
$$

其中 $1\leq j\leq m$。根据命题 2.2-4（线性无关向量组扩充为基），我们将基 $\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m$ 扩充为 $\mathcal{V}$ 的基 $\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m,\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 使得 $m+n=\dim\mathcal{V}$，对于任意的 $1\leq k\leq n$，我们有

$$
    \mathscr{T}(\boldsymbol{v}_k)=(\mathscr{T}-\lambda\mathscr{I})(\boldsymbol{v}_k)+\lambda\boldsymbol{v}_k
$$

根据 $\mathcal{U}$ 的定义可知

$$
    (\mathscr{T}-\lambda\mathscr{I})(\boldsymbol{v}_k)\in\mathcal{U}=\text{span}(\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m)
$$

因此 $\mathscr{T}(\boldsymbol{v}_k)$ 是 $\text{span}(\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m,\boldsymbol{v}_1,\cdots,\boldsymbol{v}_k)$ 中的元素，于是我们只要选择基 $\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m,\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 就可以使得 $\mathscr{T}$ 的矩阵表示是上三角矩阵。$\square$

证法2：依旧是对向量空间 $\mathcal{V}$ 的维数进行归纳。当 $\dim\mathcal{V}=1$ 时命题是平凡成立的；假设 $\dim\mathcal{V}=n>1$ 并且命题对 $n-1$ 成立。根据命题 5.2-2（有限维非零复向量空间的线性算子有特征值）可知 $\mathcal{V}$ 存在特征向量 $\boldsymbol{v}_1$，令子空间 $\mathcal{U}=\text{span}(\boldsymbol{v}_1)$，则根据命题 3.5-7（商空间的维数）可知

$$
    \dim\mathcal{V}/\mathcal{U}=\dim\mathcal{V}-\dim\mathcal{U}=n-1
$$

明显商空间依旧是一个复向量空间，满足归纳假设，因此在商空间 $\mathcal{V}/\mathcal{U}$ 上存在商算子 $\mathscr{T}/\mathcal{U}$，且该在商空间中存在一组基 $\boldsymbol{v}_2+\mathcal{U},\cdots,\boldsymbol{v}_n+\mathcal{U}$ 使得商算子的矩阵表示是上三角矩阵。对于任意的 $2\leq j\leq n$ 都有

$$
    (\mathscr{T}/\mathcal{U})(\boldsymbol{v}_j+\mathcal{U})=\text{span}(\boldsymbol{v}_2+\mathcal{U},\cdots,\boldsymbol{v}_n+\mathcal{U})
$$

根据商算子的定义以及商空间上标量乘法、加法的定义可知

$$
    \mathscr{T}(\boldsymbol{v}_j)\in\text{span}(\boldsymbol{v}_2,\cdots,\boldsymbol{v}_j)
$$

结合 $\mathscr{T}(\boldsymbol{v}_1)\in\text{span}(\boldsymbol{v}_1)$ 可知我们只要选取基 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 就可以使 $\mathscr{T}$ 的矩阵表示是上三角矩阵。$\square$

对于任意的线性映射我们都会想研究其可逆性，对于线性算子也不例外。接下去的一个命题揭示了如何通过线性算子的上三角矩阵表示看出其可逆性：

<br>

> **命题 5.2-5 线性算子的上三角矩阵与可逆性的关系**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 的矩阵表示为上三角矩阵 $\mathbf{A}$，线性算子 $\mathscr{T}$ 是可逆的当且仅当 $\mathbf{A}$ 的对角线上都是非零元素，即对任意 $1\leq j\leq\dim\mathcal{V}$ 都有
>
> $$
    A_{j,j}\neq 0
>   $$

<br>

证明：
- 必要性：设线性算子 $\mathscr{T}$ 的矩阵表示 $\mathbf{A}$ 是上三角矩阵，且对角线上的元素不为零：

    $$
        \mathbf{A}=\begin{pmatrix}
            \lambda_1&&*\\
            &\ddots&\\
            &&\lambda_n
        \end{pmatrix}
    $$

    由已知 $\mathscr{T}(\boldsymbol{v}_1)=\lambda_1\boldsymbol{v}_1$，因为 $\lambda_1\neq 0$，故我们可以得到 $\mathscr{T}(\boldsymbol{v}_1/\lambda_1)=\boldsymbol{v}_1$，因此我们得到 $\boldsymbol{v}_1\in\text{range}\mathscr{T}$；同理 $\mathscr{T}(\boldsymbol{v}_2/\lambda_2)=a\boldsymbol{v}_1+\boldsymbol{v}_2$，注意到 $a\boldsymbol{v}_1\in\text{range}\mathscr{T}$，因此 $\boldsymbol{v}_2\in\text{range}\mathscr{T}$。以此类推可以得到

    $$
        \boldsymbol{v}_1,\cdots,\boldsymbol{v}_n\in\text{range}\mathscr{T}
    $$

    因为 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 是向量空间 $\mathcal{V}$ 的基，故 $\text{range}\mathscr{T}=\mathcal{V}$，因此 $\mathscr{T}$ 是满射，因此根据命题 3.4-6 可知 $\mathscr{T}$ 是可逆的；
- 充分性：设线性算子 $\mathscr{T}$ 是可逆的，则 $\mathscr{T}$ 是单射，因此我们可以得到 $\lambda_1\neq 0$。假设存在 $1<j\leq n$ 使得 $\lambda_j=0$，根据我们假设的矩阵 $\mathbf{A}$ 可知线性映射 $\mathscr{T}$ ：

    $$
        \mathscr{T}:\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_j)\mapsto\text{span}(\boldsymbol{v}_1,\cdots,\boldsymbol{v}_{j-1})
    $$

    很明显 $\mathscr{T}$ 的定义域和值域维数不相等，因此 $\mathscr{T}$ 不可逆。假设不成立，即不存在 $1<j\leq n$ 使得 $\lambda_j=0$，因此对角线上的元素均非零。

证毕。$\square$

对于一般的矩阵，求它所表示的线性映射对应的特征值是困难的，但是对于特殊的上三角矩阵而言，求特征值就是很简单的事情：

<br>

> **命题 5.2-6 上三角矩阵特征值的确定**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 的矩阵表示是上三角矩阵，则 $\mathscr{T}$ 的特征值就是 $\mathcal{M}(\mathscr{T})$ 对角线上的元素

<br>

证明：设当选取 $\mathcal{V}$ 的基为 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 时，其矩阵表示为上三角矩阵：

$$
    \mathcal{M}(\mathscr{T})=\begin{pmatrix}
        \lambda_1& & & *\\
         & \lambda_2 & &\\
         & & \ddots & \\
         0 & & & \lambda_n
    \end{pmatrix}
$$

令 $\lambda\in\mathbb{F}$，则

$$
    \mathcal{M}(\mathscr{T}-\lambda\mathscr{I})=\begin{pmatrix}
        \lambda_1-\lambda & & & *\\
        & \lambda_2-\lambda & &\\
        & & \ddots &\\
        0 & & & \lambda_n-\lambda
    \end{pmatrix}
$$

因为 $\mathscr{T}$ 有特征值意味着 $\mathscr{T}-\lambda\mathscr{I}$ 不是单射，故其不可逆。根据命题 5.2-5 可知 $\lambda_1-\lambda,\cdots,\lambda_n-\lambda$ 中至少有一个为零，因此特征值至少是 $\lambda_1,\cdots,\lambda_n$ 的其中一个。$\square$

<br>

### 5.3 特征空间和对角矩阵

<br>

> **定义 5.3-1 对角矩阵**
>
> 对角矩阵（diagonal matrix）是除了对角线上的元素外其余元素均为 $0$ 的方阵，即对于 $n\times n$ 矩阵 $\mathbf{A}$，对任意满足 $1\leq i,j\leq n$ 且 $i\neq j$ 的 $i,j$ 都有
>
> $$
    A_{i,j}=0
>   $$

<br>

> **定义 5.3-2 特征空间**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 与 $\lambda\in\mathbb{F}$，由 $\lambda$ 决定的 $\mathscr{T}$ 的特征空间（eigenspace）记作 $\mathcal{E}(\lambda,\mathscr{T})$，定义为
>
> $$
    \mathcal{E}(\lambda,\mathscr{T})=\text{null}(\mathscr{T}-\lambda\mathscr{I})
>   $$
>
> $\lambda$ 决定的特征空间就是 $\mathscr{T}$ 的特征值 $\lambda$ 对应的特征向量构成的新的向量空间

<br>

> **命题 5.3-1 特征空间的和是直和**
>
> 设 $\mathcal{V}$ 是有限维向量空间，线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$，设 $\lambda_1,\cdots,\lambda_m$ 是 $\mathscr{T}$ 不同的特征值，则
>
> $$
    \mathcal{E}(\lambda_1,\mathscr{T})+\cdots+\mathcal{E}(\lambda_m,\mathscr{T})
>   $$
>
> 是直和，并且
>
> $$
    \dim\mathcal{E}(\lambda_1,\mathscr{T})+\cdots+\dim\mathcal{E}(\lambda_m,\mathscr{T})\leq\dim\mathcal{V}
>   $$

<br>

证明：为证明 $\mathcal{E}(\lambda_1,\mathscr{T})+\cdots+\mathcal{E}(\lambda_m,\mathscr{T})$ 是直和，只需说明对于所有 $\boldsymbol{u}_j\in\mathcal{E}(\lambda_j,\mathscr{T})$，其中 $1\leq j\leq m$，使得

$$
    \boldsymbol{u}_1+\cdots+\boldsymbol{u}_m=\boldsymbol{0}
$$

的解只有 $\boldsymbol{u}_1=\cdots=\boldsymbol{u}_m=\boldsymbol{0}$。因为 $\boldsymbol{u}_1,\cdots,\boldsymbol{u}_m$ 是特征向量，因此根据命题 5.1-2 可知它们是线性无关的，因此特征空间的和是直和。因此

$$
    \begin{aligned}
        \dim\mathcal{E}(\lambda_1,\mathscr{T})+\cdots+\dim\mathcal{E}(\lambda_,\mathscr{T})&=\dim\mathcal{E}(\lambda_1,\mathscr{T})\oplus\cdots\oplus\mathcal{E}(\lambda_m,\mathscr{T})\\
        &\leq\dim\mathcal{V}
    \end{aligned}
$$

证毕。$\square$

<br>

> **定义 5.3-3 可对角化**
>
> 称一个线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 为**可对角化的**（diagonalizable），当存在一组基使得该线性算子的矩阵表示是对角矩阵

<br>

> **命题 5.3-2 可对角化的等价命题**
>
> 设 $\mathcal{V}$ 是有限维向量空间，线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$。设 $\lambda_1,\cdots,\lambda_m$ 是 $\mathscr{T}$ 的不同特征值，则以下命题等价：
>
> - （a）$\mathscr{T}$ 是可对角化的；
> - （b）$\mathcal{V}$ 有一组由 $\mathscr{T}$ 的特征向量组成的基；
> - （c）$\mathcal{V}$ 存在一维的在线性算子 $\mathscr{T}$ 下的不变子空间 $\mathcal{U}_1,\cdots,\mathcal{U}_n$，使得
>
> $$
    \mathcal{V}=\mathcal{U}_1\oplus\cdots\oplus\mathcal{U}_n
>   $$
>
> - （d）$\mathcal{V}=\mathcal{E}(\lambda_1,\mathscr{T})\oplus\cdots\oplus\mathcal{E}(\lambda_m,\mathscr{T})$
> - （e）$\dim\mathcal{V}=\dim\mathcal{E}(\lambda_1,\mathscr{T})+\cdots+\dim\mathcal{E}(\lambda_m,\mathscr{T})$

<br>

证明：
- （a）推出（b）：设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 的矩阵表示可以是对角矩阵：

    $$
        \mathcal{M}(\mathscr{T})=\begin{pmatrix}
            \lambda_1&&0\\
            &\ddots&\\
            0&&\lambda_n
        \end{pmatrix}
    $$

    其对应的基为 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$，当且仅当对所有的 $j$ 都有 $\mathscr{T}(\boldsymbol{v}_j)=\lambda_j\boldsymbol{v}_j$，因此 $\boldsymbol{v}_j$ 是基中的向量又是 $\mathscr{T}$ 的特征向量，因此（b）成立，且易知（a）和（b）等价；
- （b）推出（c）：设 $\mathcal{V}$ 的基 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 中的所有向量都是 $\mathscr{T}$ 的特征向量。对任意的 $j$，设 $\mathcal{U}_j=\text{span}(\boldsymbol{v}_j)$，$\mathcal{U}_j$ 是 $\mathcal{V}$ 的一维子空间，且在 $\mathscr{T}$ 下是不变子空间。因为 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 是 $\mathcal{V}$ 的基，所以对任意的 $\boldsymbol{v}\in\mathcal{V}$ 都有

    $$
       \boldsymbol{v}=a_1\boldsymbol{v}_1+\cdots+a_n\boldsymbol{v}_n
    $$

    设 $\boldsymbol{u}_j=a_j\boldsymbol{v}_j\in\mathcal{U}_j$，其中 $1\leq j\leq n$，且 $\boldsymbol{u}_1,\cdots,\boldsymbol{u}_n$ 是线性无关的，因此 $\boldsymbol{v}$ 的线性表示只有一个，因此 $\mathcal{V}=\mathcal{U}_1\oplus\cdots\oplus\mathcal{U}_n$；
- （c）推出（d）：由于 $\mathcal{V}$ 存在一组一维的在线性算子 $\mathscr{T}$ 下的不变子空间 $\mathcal{U}_1,\cdots,\mathcal{U}_n$ 使得 $\mathcal{V}=\mathcal{U}_1\oplus\cdots\oplus\mathcal{U}_n$，对于每个一维不变子空间 $\mathcal{U}_j$，设其基为 $\boldsymbol{u}_j$，则 $\mathscr{T}(\boldsymbol{u}_j)\in\mathcal{U}_j$，因此存在 $\lambda_j\in\mathbb{F}$ 使得 $\mathscr{T}(\boldsymbol{u}_j)=\lambda_j\boldsymbol{u}_j$，因此 $\lambda_j$ 是 $\mathscr{T}$ 的特征值，$\mathcal{U}_j$ 是由 $\lambda_j$ 决定的 $\mathscr{T}$ 的特征空间，因此：

    $$
        \mathcal{V}=\mathcal{E}(\lambda_1,\mathscr{T})\oplus\cdots\oplus\mathcal{E}(\lambda_n,\mathscr{T})
    $$

- （d）推出（e）：由命题 5.3-1 可知成立；
- （e）推出（b）：取特征空间 $\mathcal{E}(\lambda_j,\mathscr{T})$ 中的基，重新排列为 $\mathscr{T}$ 的特征向量组 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$，其中 $n=\dim\mathcal{V}$，我们要说明 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 是线性无关的，考虑

    $$
        a_1\boldsymbol{v}_1+\cdots+a_n\boldsymbol{v}_n=\boldsymbol{0}
    $$

    其中 $a_1,\cdots,a_n\in\mathbb{F}$，对于任意 $j=1,\cdots,m$，令 $\boldsymbol{u}_j$ 代表如下的式子（注意其中 $m\leq n$，这主要是因为我们不知道特征空间的维数）：

    $$
        \boldsymbol{u}_j=\sum_{k=1}^na_k\boldsymbol{v}_k,\quad\boldsymbol{v}_k\in\mathcal{E}(\lambda_j,\mathscr{T})
    $$

    易知 $\boldsymbol{u}_j\in\mathcal{E}(\lambda_j,\mathscr{T})$，则很明显

    $$
        \boldsymbol{u}_1+\cdots+\boldsymbol{u}_m=\boldsymbol{0}
    $$

    根据命题 5.1-2（特征向量都是线性无关的）可知 $\boldsymbol{u}_1=\cdots=\boldsymbol{u}_m=\boldsymbol{0}$，这可以推得 $a_1=\cdots=a_n=0$，因此 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_n$ 线性无关，是 $\mathcal{V}$ 的一组基。

证毕。$\square$

<br>

> **命题 5.3-3 足够多的特征值可推出可对角化**
>
> 设线性算子 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 有 $\dim\mathcal{V}$ 个不同的特征值，则 $\mathscr{T}$ 是可对角化的

<br>

证明：设 $\mathscr{T}\in\mathcal{L}(\mathcal{V})$ 有 $\dim\mathcal{V}$ 个不同的特征值 $\lambda_1,\cdots,\lambda_{\dim\mathcal{V}}$。对于任意 $1\leq j\leq\dim\mathcal{V}$，令 $\boldsymbol{v}_j$ 是特征值 $\lambda_j$ 对应的特征向量，根据命题 5.1-2 可知 $$ \boldsymbol{v}_1,\cdots,\boldsymbol{v}_{\dim\mathcal{V}} $$ 是线性无关的，很明显这个向量组是 $\mathcal{V}$ 的基，根据命题 5.3-2 可知 $\mathscr{T}$ 的矩阵表示是可对角化的。$\square$